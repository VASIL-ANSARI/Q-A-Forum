<p>You're running out of memory because you're trying to store <code>2**23</code> elements in a dictionary.  That uses a lot of memory, apparently more than you have! You say you have enough RAM, how did you determine how much you'd need?  </p>

<p>You'll need to come up with a different algorithm.</p>

<p>Also, you don't seem to ever access CACHE, so why are you using it at all?</p>
