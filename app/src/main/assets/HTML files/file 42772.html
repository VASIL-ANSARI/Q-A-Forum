<blockquote>
  <p>1.could threadpool decrease the run time or i made a mistake?</p>
</blockquote>

<p>Afraid you made a mistake.  <code>QueueUserWorkItem</code> returns immediately allowing the current thread to continue while the work is being done on a different thread.  Therefore <code>w.Stop();</code> is called immediately after the work begins.  It doesn't wait for the work item to complete.  So you effectively measured how long it takes just to add an item to the queue, not how long it actually takes to complete the work.</p>

<blockquote>
  <p>2.could stopwatch measure the run time of functions that run simultaneously?</p>
</blockquote>

<p>You could start/stop the watch inside the function, or have a delegate function that is a proxy to the actual function.  This delegate could wrap the actual function/work with the start/stop calls and send the resulting time to where it needs to be logged to.</p>
