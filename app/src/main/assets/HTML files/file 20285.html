<p>I would run a single query - select all where customer is bob and order by ordernumber.</p>

<p>Then I would simply iterate through the results and print the skus.</p>

<p>Whenever I see a new ordernumber in my iterations, I would print the formatting to start a new order (and echo all of its metadata like date, ordernumber, etc)</p>

<p>Here is pseudo code:</p>

<pre><code>rows = run_sql(select * where customer = bob order by ordernumber asc)

curr_order_id = 0

foreach (row in rows)
{
  if (row[order_id] != curr_order_id)
  {
    curr_order_id = row[order_id]
    print(-----------------------)
    print(customer : row[customer])
    print(order : row[order_id])
    print(order date: row[order_date])
    print(details: *qty* *sku* *product*)
  }
  print(     row[qty] row[sku] row[product])
}
</code></pre>
