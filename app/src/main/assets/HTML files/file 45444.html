<p>The best practice consists in doing your SQL queries in the <code>do</code> block, and passing an object to your template.</p>

<p>It is considered a bad idea to write too much code in the templates, and it can be useful to isolate the fetching logic from the displaying logic if you ever want to use the same template from different routes.</p>

<p>By using Ruby's duck typing, you can make your template very flexible. For instance with Haml:</p>

<pre><code>%ul
  - @dataset.each do |row|
    %li= row['name']
</code></pre>

<p>All you need to do is to provide the template with an <code>Enumerable</code> of objects which all respond to <code>[]</code>. It can be the result of a database query (most gems return something compatible, I think), or it can be an hard-coded <code>Array</code> of <code>Hash</code>es for instance.</p>
