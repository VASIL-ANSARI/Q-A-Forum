<p>Even the authors are relying on some mocking/stubbing in the integrations tests, so that might be the correct way.</p>

<pre><code>class MyCommand
  include Wisper::Publisher

  def execute(be_successful)
    if be_successful
      broadcast('success', 'hello')
    else
      broadcast('failure', 'world')
    end
  end
end

describe Wisper do

  it 'subscribes object to all published events' do
    listener = double('listener')
    expect(listener).to receive(:success).with('hello')

    command = MyCommand.new

    command.subscribe(listener)

    command.execute(true)
  end
</code></pre>

<p><a href="https://github.com/krisleech/wisper/blob/master/spec/lib/integration_spec.rb" rel="nofollow">https://github.com/krisleech/wisper/blob/master/spec/lib/integration_spec.rb</a></p>
