<p>Here are several points you can check for troubleshooting:</p>

<p>1, In your AD application panel, click USERS tab to check whether the user is in your Azure AD.</p>

<p>2, Please check whether the procedure of syncing up users is successfully  from on-promise AD or Office 365 to Azure AD. You can login Azure portal using office 365 account, it will automatically be added in Azure AD by its first time login on Azure portal. Additionally, if you get something wrong or UPN has conflicts, you may encounter this error. </p>

<p>And you can try the following script in Powershell add your Application Service Principal and set the Role for your application:</p>

<pre><code>#-----------------------------------------------------------
# This will add your Application Service Prinicpal to 
# the Company Administrator role
#-----------------------------------------------------------
$msolcred=get-credential
connect-msolservice -credential $msolcred

$ClientIdWebApp = 'Your application client id'
$webApp = Get-MsolServicePrincipal âAppPrincipalId $ClientIdWebApp

#use Add-MsolRoleMember to add it to âCompany Administratorâ role).
Add-MsolRoleMember -RoleName "Company Administrator" -RoleMemberType ServicePrincipal -RoleMemberObjectId $webApp.ObjectId 
</code></pre>

<p>You can refer to <a href="https://msdn.microsoft.com/en-us/library/azure/81cc7f03-75d3-4343-aec4-57116017683a#BKMK_ManageService" rel="nofollow">Manage Azure AD service principals</a> for more information about how to user Azure AD Powershell.</p>

<p>Furthermore, you can refer to <a href="http://dev.office.com/hands-on-labs/4585" rel="nofollow">Deep Dive into the Office 365 Unified API</a> for integrating office 365, and check the prerequisites as it mentioned at first section.</p>
