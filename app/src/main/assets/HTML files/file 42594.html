<p>1.</p>

<pre><code>select ClientID from
(
select 
  ClientID,
  Action,
  Result,
  row_number() over (partition by ClientID order by ActionDate desc) as num
from ClientActions
) T -- the latest 5 action/result
where rnum &lt;= 5
group by ClientID
having MAX(case when Action='Call' and Result = 'NoAnswer' then 0 else 1 end) = 0
</code></pre>

<p>2.</p>

<pre><code>select ClientID
from ClientActions
where DATEDIFF(DAY, ActionDate, GETDATE()) &lt;= 30
group by ClientID
having MAX(case when Action='Call' and Result = 'NoAnswer' then 0 else 1 end) = 0
</code></pre>
