<p>Well, you can tell just by looking at it that it is correct...  Assuming that the <code>t[]</code> array is correct, which you can verify with just 12 spot checks (one for each month using any day/year).</p>

<p>The <code>y -= m &lt; 3</code> is a nice trick.  It creates a "virtual year" that starts on March 1 and ends on February 28 (or 29), putting the extra day (if any) at the <em>end</em> of the year; or rather, at the end of the <em>previous</em> year.  So for example, virtual year 2011 began on Mar 1 and will end on February 29, while virtual year 2012 will begin on March 1 and end on the following February 28.</p>

<p>By putting the added day for leap years at the end of the virtual year, the rest of the expression is massively simplified.  </p>

<p>Let's look at the sum:</p>

<pre><code>(y + y/4 - y/100 + y/400 + t[m-1] + d) % 7
</code></pre>

<p>There are 365 days in a normal year.  That is 52 weeks plus 1 day.  So the day of the week shifts by one day per year, in general.  That is what the <code>y</code> term is contributing; it adds one to the day for each year.</p>

<p>But every four years is a leap year.  Those contribute an extra day every four years.  Thanks to the use of virtual years, we can just add <code>y/4</code> to the sum to count how many leap days happen in <code>y</code> years.  (Note that this formula assumes integer division rounds <em>down</em>.)</p>

<p>But that is not quite right, because every 100 years is not a leap year.  So we have to subtract off <code>y/100</code>.</p>

<p>Except that every 400 years is a leap year again.  So we have to add <code>y/400</code>.</p>

<p>Finally we just add the day of the month <code>d</code> and an offset from a table that depends on the month (because the month boundaries within the year are fairly arbitrary).</p>

<p>Then take the whole thing mod 7 since that is how long a week is.</p>

<p>(If weeks were eight days, for example, what would change in this formula?  Well, it would be mod 8, obviously.  Also the <code>y</code> would need to be <code>5*y</code>, because 365 % 8 == 5.  Also the month table <code>t[]</code> would need adjusting.  That's it.)</p>

<p>Incidentally, Wikipedia's statement that the calendar is "good until 9999" is totally arbitrary.  This formula is good for however long we stick with the <a href="http://en.wikipedia.org/wiki/Gregorian_calendar#Accuracy">Gregorian calendar</a>, whether that is 10 years, 100 years, 1000 years, or 1 million years.</p>

<p>[edit]</p>

<p>The above argument is essentially a proof by induction.  That is, <em>assuming</em> that the formula works for a particular (y,m,d), you <em>prove</em> that it works for (y+1,m,d) and (y,m,d+1).  (Where y is a "virtual year" starting March 1.)  So the key question is, does the sum change by the correct amount as you move from one year to the next?  With knowledge of the leap year rules, and with the "virtual year" having the extra day at year end, it trivially does.</p>
