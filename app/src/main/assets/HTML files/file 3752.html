<p>You can set the relevant registry entries and then do a SendMessage to refresh the today screen.</p>

<hr>

<ul>
<li>HKEY_CURRENT_USER\Software\Microsoft\Today\Skin</li>
<li>HKEY_CURRENT_USER\Software\Microsoft\Today\UseStartImage</li>
<li>All values under HKEY_CURRENT_USER\Software\Microsoft\Today\(ThemeFileName)</li>
<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Color\SHColor</li>
<li>HKEY_LOCAL_MACHINE\Software\Microsoft\Color\BaseHue</li>
<li>All values under HKEY_LOCAL_MACHINE\Software\Microsoft\Color\(ColorNumber)</li>
<li>HKEY_LOCAL_MACHINE\System\GWE\SysColor</li>
</ul>

<hr>

<p>C# code example:</p>

<pre><code>using System.Runtime.InteropServices;
using Microsoft.Win32;
...
[DllImport("coredll.dll")]
private static extern int SendMessage(IntPtr hWnd, uint msg, int wParam, int lParam);
...
public const int HWND_BROADCAST = 0xffff;
public const int WM_WININICHANGE = 0x001A;

// Copy wallpaper file to windows directory
File.Copy(@"\My Documents\My Pictures\ImageFileName.jpg", @"\Windows\stwater_240_240.jpg", true);                

// Update registry
Registry.SetValue(@"HKEY_CURRENT_USER\Software\Microsoft\Today", "Wall", "ImageFileName");

// Send message to refresh today screen
SendMessage((IntPtr)HWND_BROADCAST, WM_WININICHANGE, 0xF2, 0);
</code></pre>

<hr>

<p>See more details at:</p>

<p><a href="http://windowsmobiledn.com/qa-how-to-install-a-today-theme-file/" rel="nofollow">http://windowsmobiledn.com/qa-how-to-install-a-today-theme-file/</a></p>

<p><a href="http://windowsmobiledn.com/forum/viewtopic.php?t=335" rel="nofollow">http://windowsmobiledn.com/forum/viewtopic.php?t=335</a> </p>

<p><a href="http://windowsmobiledn.com/forum/viewtopic.php?t=335" rel="nofollow">http://social.msdn.microsoft.com/Forums/en-US/vssmartdevicesnative/thread/83a0420b-1c8f-4201-b910-693b3b9a3b12</a></p>
