<p>The time taken to integrate your function sounds very long if the function is not a nasty one.</p>

<p>First thing I suggest you do is to profile where the time is spent. Is it spent in <code>dblquad</code> or elsewhere? How many calls are made to <code>w_B</code> during the integration? If the time is spent in <code>dblquad</code> and the number of calls is very high, could you use looser tolerances in the integration?</p>

<p>It seems that the multiplication by the gaussians actually enables you to limit the integration limits a great deal, as most of the energy of the gaussian is within a very small area. You might want to try and calculate reasonable tighter bounds. You have already limited the area into -10..10; is there any significant performance change between -100..100, -10..10, and -1..1?</p>

<hr>

<p>If you know your functions are relatively smooth, then there is a Mickey-Mouse version of the integration:</p>

<ul>
<li>determine reasonable upper and lower limits in both axes (by the gaussians)</li>
<li>calculate a reasonable grid density (e.g. 100 points in each direction)</li>
<li>calculate the w_B for each of these points (and this will be much faster, if it is possible to require a vectorized version of w_B)</li>
<li>sum it all together</li>
</ul>

<p>This is very low-tech but also very fast. Whether or not it gives you results which are good enough for the outer iteration is an interesting question. It just might.</p>
