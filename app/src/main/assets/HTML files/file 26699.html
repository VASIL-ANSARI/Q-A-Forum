<p>This stack implementation is intrusive - it expects that there's a pointer available for the stack template to use.  In this case, the second template argument is intended to have the offset to that pointer - not the size of the object being stored.</p>

<p>So you might make the following modifications:</p>

<pre><code>struct product {
    int weight;
    float price;
    struct product* next;   // &lt;-- link pointer field
} ;


// the stack declaration:

idStackTemplate&lt;product, offsetof(struct product, next)&gt; stack;
//                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</code></pre>

<p>It should go without saying that this kind of container is not generally considered good practice.</p>
