<p>You have a <code>Uint8Array</code> array to hold the results, but the most common RGB values are occurring more than 255 times. This causes an overflow and you end up seeing a histogram of the values modulo 256, which is effectively random for high values. That's why the left and middle parts of the graph (where values are less than 255) are correct, but the higher-valued areas are all over the place.</p>

<p>Use a larger data type to store the results, and normalize to the size of your output canvas before drawing.</p>
