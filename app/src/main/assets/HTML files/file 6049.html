<p>Rather than writing the whole thing yourself, why don't you get your app to run a tool like <a href="http://technet.microsoft.com/en-gb/sysinternals/bb664922.aspx" rel="nofollow">AccessChk</a> (use the <code>-l</code> parameter), and then apply permissions to the target folder based on the info you parse from the output of AccessChk. </p>
