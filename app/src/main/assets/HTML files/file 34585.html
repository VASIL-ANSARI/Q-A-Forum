<pre><code>level-&gt;name
</code></pre>

<p>is a pointer. So </p>

<pre><code>sizeof(level-&gt;name)
</code></pre>

<p>returns the size of a pointer on your platform. That's known at compile time. In fact that's something to bear in mind. The <code>sizeof</code> operator is evaluated at compile time. So a priori it cannot be used to size the allocation of dynamically sized memory. </p>

<p>Instead you need to allocate enough memory to hold the length of string you require, including the null terminator. </p>

<p>You'll need to walk over <code>line</code> first to find the length of the string. Just as you presently do, looking for semi-colon separators. Then you can allocate the string's memory and finally copy it. </p>

<p>Do beware that your current code assumes that the string in <code>line</code> is well formed. If it does not have sufficient number of semi-colons you will read off the end of the buffer. It would be prudent to check for that eventuality. </p>

<p>The <code>malloc</code> function returns <code>void*</code> which is assignable to any pointer type. So casting is not necessary and it is generally best that you avoid casting.</p>
