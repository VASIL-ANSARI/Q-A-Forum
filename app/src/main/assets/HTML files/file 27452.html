<p>You can find groups faster when you sort the items into a bucket. You can use a spatial index for example a kd-tree.</p>
