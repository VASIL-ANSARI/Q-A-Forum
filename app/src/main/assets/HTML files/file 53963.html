<p>This can be easily achieved using window functions:</p>

<pre><code>SELECT a, b, c, s
FROM (
  SELECT a, b, c, 
         ROW_NUMBER() OVER (PARTITION BY a ORDER BY b DESC) AS rn,
         SUM(b) OVER (PARTITION BY a) AS s
  FROM example) AS t
WHERE t.rn = 1 
</code></pre>

<ul>
<li><code>ROW_NUMBER</code> enumerates records within each <code>a</code> partition: the record having the highest <code>b</code> value is assigned a value of 1, next record a value of 2, etc.</li>
<li><code>SUM(b) OVER (PARTITION BY a)</code> returns the sum of all <code>b</code> within each <code>a</code> partition. </li>
</ul>
