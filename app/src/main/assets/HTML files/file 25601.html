<p>Well, you would want to use <strong>prepared statements</strong> here, because you're not executing a <em>static</em> SQL query - that's what <code>mysqli_query()</code> is to be used for.</p>

<p>So, here's what you would need to do:</p>

<ol>
<li>Don't bother with the <code>// cleanup POST variables</code> section.</li>
<li>Change the <code>//Load and run query</code> section to use a prepared statement.</li>
<li><p>First, we want to prepare it: <a href="http://php.net/manual/en/mysqli.prepare.php" rel="nofollow">http://php.net/manual/en/mysqli.prepare.php</a></p>

<p><code>$query = mysqli_prepare($mysqli, "SELECT * FROM auth WHERE username=? AND password=?");</code></p></li>
<li><p>Then we want to give Mysqli what the ? marks are: <a href="http://www.php.net/manual/en/mysqli-stmt.bind-param.php" rel="nofollow">http://www.php.net/manual/en/mysqli-stmt.bind-param.php</a></p>

<p><code>$query-&gt;bind_param('ss', $username, $password);</code></p></li>
</ol>

<p>Then, use <code>bind_result</code> and <code>fetch</code> (see index at <a href="http://www.php.net/manual/en/class.mysqli-stmt.php" rel="nofollow">http://www.php.net/manual/en/class.mysqli-stmt.php</a>) to get the result and store into the session variables.</p>
