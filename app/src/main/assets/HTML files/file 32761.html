<blockquote>
  <ol>
  <li>reply a verification code to the user via SMS 3. ask user provide verification code, username, password, confirmpassword ...</li>
  </ol>
</blockquote>

<p>I think you're on the right track there, but only if you can somehow be 100% certain that every phone number in the database can receive SMS.  What about email?  Can you ask for their email address, something like <strong>_______</strong>@yourcompany.com where they only fill in the first part?  Then send a verification code via email.</p>

<blockquote>
  <p>I also think maybe I can just use a user's phone number and don't need
  his username at all. Is this appropriate?</p>
</blockquote>

<p>Depends on your app.  There's no technical reason why a phone number can't be used as an identifier, but there may be other reasons.  Users may not like it aesthetically.  It may make it harder to recognize the identity of other users.  It may be less convenient than some other identifier.</p>
