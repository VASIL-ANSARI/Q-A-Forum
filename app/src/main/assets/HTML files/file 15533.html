<p>I think <code>is_leaf</code> is incorrect. The condition should be <code>(2*i+1 &gt;= many_items)</code>.</p>
