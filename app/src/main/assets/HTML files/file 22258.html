<p>Why not just use the template for each row ? Use a <code>StringBuilder</code> to concatenate the header and then iterate throught the rows, generate a string via the template and append to the <code>StringBuilder</code>.</p>

<p>e.g. in pseudo-ish code:</p>

<pre><code>StringBuilder sb = new StringBuilder();
sb.append("START\n");
sb.append(....)
foreach(Row r : rows) {
   sb.append(template);
}
sb.append("END\n");
</code></pre>

<p>Failing that, check out templating libraries such as <a href="http://velocity.apache.org/" rel="nofollow">Velocity</a> or <a href="http://freemarker.sourceforge.net/" rel="nofollow">Freemarker</a>.</p>
