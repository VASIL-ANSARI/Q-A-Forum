<p>You can not use a column defined in a select clause in that same select clause. Logically a select clause is evaluated all at once. A simplified example:</p>

<pre><code>select 1 as test, 2 * test from dual

ORA-00904: "TEST": invalid identifier
</code></pre>

<p>As kashi points out in a comment, <code>DISTANCE_IN_METRES</code> is referenced in the case expression following the definition of <code>DISTANCE_IN_METRES</code> in the same select clause, and this is where the error is coming from.</p>
