<p>You are calling <code>GridView.RenderControl(htmlTextWriter)</code>, hence the page raises an exception that a Server-Control was rendered outside of a Form. </p>

<p>You could avoid this execption by overriding <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.page.verifyrenderinginserverform.aspx">VerifyRenderingInServerForm</a></p>

<pre><code>public override void VerifyRenderingInServerForm(Control control)
{
  /* Confirms that an HtmlForm control is rendered for the specified ASP.NET
     server control at run time. */
}
</code></pre>

<p>See <a href="http://forums.asp.net/t/1016960.aspx/1?Problem%20with%20GridView%20s%20RenderControl">here</a> and <a href="http://aspalliance.com/771_CodeSnip_Exporting_GridView_to_Excel">here</a>.</p>
