<p>you can construct your dictionary, that might be saved as the JSON file like this:</p>

<pre><code>In [129]: %paste
(df.groupby(['mac_address','City'])
   .size()
   .reset_index()
   .rename(columns={'City':'name',0:'count'})
   .groupby('mac_address')
   .apply(lambda x: {'mac_address':x.name, 'cities': x[['name','count']].to_dict('r')})
   .to_dict()
)
## -- End pasted text --
Out[129]:
{'00:03:7f:05:c0:06': {'cities': [{'count': 1, 'name': 'Kolkata'}],
  'mac_address': '00:03:7f:05:c0:06'},
 '00:08:22:1c:50:07': {'cities': [{'count': 1, 'name': 'Bhubaneswar'},
   {'count': 1, 'name': 'Kolkata'},
   {'count': 2, 'name': 'Mumbai'}],
  'mac_address': '00:08:22:1c:50:07'},
 '00:08:22:24:cc:fb': {'cities': [{'count': 1, 'name': 'Bhubaneswar'}],
  'mac_address': '00:08:22:24:cc:fb'},
 '00:08:22:24:f8:02': {'cities': [{'count': 1, 'name': 'Bhubaneswar'},
   {'count': 1, 'name': 'Kolkata'},
   {'count': 2, 'name': 'Mumbai'}],
  'mac_address': '00:08:22:24:f8:02'}}
</code></pre>

<p>In regards to updating nested fields in Mongo DB, see this question and answers: <a href="http://stackoverflow.com/questions/10522347/mongodb-update-objects-in-a-documents-array-nested-updating">MongoDB - Update objects in a document&#39;s array (nested updating)</a></p>
