<p>You can try something like this:</p>

<pre><code>results = weekly_attendance.group_by { |week, value| (week + 3) / 4 }.map do |month, groups|
  values = groups.map(&amp;:last)
  average = values.inject(0) { |sum, val| sum + val } / values.length
  [month, average]
end.to_h

p results # {8=&gt;70.0, 9=&gt;39.7675, 10=&gt;61.0}
</code></pre>

<p>But the logic of converting weeks to months is flawed here, it's better to use some calendar function instead of just division by 4. </p>

<p>You can get the real month numbers using:</p>

<pre><code>require 'date'
weekly_attendance.group_by { |week, value| Date.commercial(Time.now.year, week, 1).month }
</code></pre>

<p>But the result will not match the result you expect, because for example week 31 is in July, while week 32 is in August (this year), instead of being the same month like you expect.</p>
