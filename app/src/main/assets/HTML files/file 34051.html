<p>try this...</p>

<pre><code>SELECT DISTINCT projectId, 
SUBSTRING((SELECT ', ' + value 
FROM dbo.#temp g2 
WHERE g2.recordTypeID=10 
and g1.value=g2.value 
and g2.projectId = g1.projectId 
and g2.auditDate &gt; '01-01-2014' FOR XML PATH('')), 3, 8000) 
FROM dbo.ProjectDetail g1 WHERE projectId IN 
(SELECT projectId FROM ProjectDetail a GROUP BY projectId HAVING COUNT(projectId) &gt; 1)
</code></pre>
