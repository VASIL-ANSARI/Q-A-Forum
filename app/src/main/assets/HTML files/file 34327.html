<p>It sounds like you have a good grasp on the logistics and have been able to build a solution that works but that you're a bit dissatisfied with its overall architecture.</p>

<p>One approach that many PHP projects use when incorporating real-time features is to use an external <strong>realtime network</strong> to pass data between clients and the server as peers. For example, PubNub provides a <a href="http://www.pubnub.com/docs/javascript/javascript-sdk.html" rel="nofollow">JavaScript SDK</a> that allows you to publish and subscribe to chat events on different channels. On your client, you could use this code:</p>

<pre><code>&lt;script src=http://cdn.pubnub.com/pubnub.min.js &gt;&lt;/script&gt;
&lt;script&gt;(function(){

  var pubnub = PUBNUB.init({
    publish_key   : 'demo',
    subscribe_key : 'demo'
  })

  pubnub.publish({
    channel : "chat",
    message : "Hi."
  })

})();&lt;/script&gt;
</code></pre>

<p>One benefit of this model in your case would be that the clients would not be forced to make server calls, or wait on the server's response, in order to proceed. Speaking of the server, here's how you would subscribe to your <code>chat</code> channel (assuming you are using 5.3):</p>

<pre><code>$pubnub = new Pubnub(
  "demo",  ## PUBLISH_KEY
  "demo",  ## SUBSCRIBE_KEY
  "",      ## SECRET_KEY
  false    ## SSL_ON?
);

$pubnub-&gt;subscribe(array(
  'channel'  =&gt; 'chat',        ## REQUIRED Channel to Listen
  'callback' =&gt; function($message) {  ## REQUIRED Callback With Response
    var_dump($message);  ## Print Message
    return true;         ## Keep listening (return false to stop)
  }
));
</code></pre>

<p>PubNub also has an <a href="http://www.pubnub.com/blog/html5-websockets-beautiful-real-time-chat-on-mobile-using-pubnubs-channel-presence/" rel="nofollow">HTML5 chat example using Presence</a> (<a href="https://www.pubnub.com/how-it-works/presence/" rel="nofollow">non-technical overview</a>), which allows you to determine users' connectivity status.</p>

<p>By moving all this activity away from your server and onto a globally-distributed realtime network, you can simplify your architecture, while maintaining your PHP server.</p>

<p>Good luck!</p>
