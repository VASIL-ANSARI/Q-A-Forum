<p>You should first open port, than configure. And your code does it in opposite direction. That's why your configure code does not work and port just opens with default settings.</p>

<p>Just look your code:  </p>

<pre><code>BOOL CSerialPort::Config( SConfig sConfig ) {
    if( !m_hFile ) return FALSE;
 ....
</code></pre>

<p>And <code>m_hFile</code> is set in <code>CSerialPort::Open</code></p>

<pre><code>BOOL CSerialPort::Open( LPCSTR cszCOM ) {
    CHAR sPortName[256] = "\\\\.\\";
    strcat_s( sPortName, cszCOM );
    m_strPortName = sPortName;
    if( m_hFile )
        return FALSE;
    m_hFile = ::CreateFile( m_strPortName.c_str(), GENERIC_READ|GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, NULL);
 .....
</code></pre>

<p>It seems your <code>hyper terminal</code> program adjust default settings and that's why when you open port after using <code>`hyper terminal</code> it opens with correct settings.</p>
