<pre><code>function getLevelByExp($exp) {
    $aLevels = getExperienceByLevel(99);

   for ($i = 99; $i &gt;= 1; $i--)
    {
       if ($exp &gt; $aLevels[$i-1])
        {
        return $i;
        }
    }  
}
</code></pre>

<p>You are returning as soon as $exp > $aLevels[$i-1]. On the first runthrough of your original loop, $aLevels[$i-1] = $aLevels[0] = 0, so it will always return right away for any non-negative $exp value. </p>
