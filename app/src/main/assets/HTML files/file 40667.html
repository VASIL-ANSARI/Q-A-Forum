<p>You are missing the case where <code>a</code> is an ancestor of <code>b</code>.</p>

<p>Look at the simple counter example:</p>

<pre><code>    a
  b  None
</code></pre>

<p><code>a</code> is also given as <code>root</code>, and when invoking the function, you invoke <code>check_subtree(root)</code>, which is <code>a</code>, you then find out that this is what you are looking for (in the stop clause that returns 1), and return <code>1</code> immidiately without setting <code>lca</code> as it should have been.</p>
