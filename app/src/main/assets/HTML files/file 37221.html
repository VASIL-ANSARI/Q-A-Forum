<p>If you set this up properly you can do the whole operation in a few lines of PHP and just two SQL commands. Your question is short on detail, so this is necessarily going to be a little sketchy:</p>

<pre><code>Upload file to server with PHP.
Use SQL 'LOAD DATA INFILE' to load the CSV file into a table.
Use 'SELECT... INTO OUTFILE...' to export the data to a CSV file, filtering with a suitable WHERE clause.
Download the resulting CSV file with PHP, or by providing a link, or whatever
</code></pre>

<p>I am assuming that you trust the data you're uploading. If not, you may need to do some validation as part of the LOAD DATA INFILE... process, or by some other method.</p>

<p>Inserting data with <code>LOAD DATA INFILE</code> and using SQL to handle the filtering will be orders of magnitude faster that doing record-by-record look-ups with PHP.</p>
