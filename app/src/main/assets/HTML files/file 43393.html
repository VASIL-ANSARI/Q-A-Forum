<p>You should fix your query to have proper <code>join</code> syntax -- simple rule:  never use commas in the <code>from</code> clause.</p>

<p>For your query, you can replace the <code>select</code> with with:</p>

<pre><code>select distinct on (cmsdw_document.document_id) . . .
</code></pre>

<p>The ". . ." is the rest of your query.  Then add:</p>

<pre><code>order by cmsdw_document.document_id, cmsdw_document.modification_ts desc
</code></pre>

<p>This should give you the latest document, using a Postgres extension.</p>
