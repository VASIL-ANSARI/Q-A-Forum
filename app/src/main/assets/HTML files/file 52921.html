<p>The <code>dwMilliseconds</code> parameter in <code>WaitForSingleObject</code> cannot be relied upon for accurate timing. The only contract is that after that much time has elapsed, the thread will <em>eventually</em> wake up and return the <code>TIMEOUT</code> value. The thread may not wake up until its next scheduled quanta, which can be as high as 60 milliseconds (or even higher on Windows Server). This is more than enough time for the second thread to complete. Try increasing the iteration count such that the worker thread takes at least one second to run - that should be plenty of time for the primary thread to be scheduled and run at least one more iteration of the <code>TIMEOUT</code> loop.</p>
