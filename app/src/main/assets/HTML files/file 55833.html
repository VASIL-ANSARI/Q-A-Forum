<p>Rather than iterating over the 4.5MM rows in your data, use pandas' built-in indexing features. I've re-written the loop at the end of your code as below:</p>

<pre><code>data.loc[data.Close/data.Close.shift(1) &lt;= Cut_Pct,'Cut_Off'] = 1
</code></pre>

<p>.loc locates rows that meet the criteria in the first argument. .shift shifts the rows up or down depending on the argument passed.</p>
