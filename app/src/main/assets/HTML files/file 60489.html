<p>The problem was here <code>url = String(url).replace(m[0], decoded[m[1]])</code></p>

<p>You modify <code>url</code> during the <code>exec()</code>, so matche's index change ...</p>

<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>var url = 'https://api.fitbit.com/1/user/:ownerId/:collectionType/date/:date.json';

var data = { collectionType: 'activities',
   date: '2016-10-12',
   ownerId: 'xxxxx',
   ownerType: 'user',
   subscriptionId: 'xxx' }

var reg = /\:([\w]+)/gi;

function regexifyUrlTemplate(url, regex, decoded) {
  console.log('Regexify URL: ', url)
  console.log('Regexify Data: ', decoded)
  
  var m, originUrl = url;
  while (( m = regex.exec(originUrl)) !== null) {
    //if (m.index === regex.lastIndex) {
    //  regex.lastIndex++
    //}
    console.log('Matches: ', m)
    url = String(url).replace(m[0], decoded[m[1]])
    console.log('Replaced ' + m[0] + ' with ' + decoded[m[1]])
  }
  console.log('Regexify :', url)
  return url
}

regexifyUrlTemplate(url, reg, data)</code></pre>
</div>
</div>
</p>
