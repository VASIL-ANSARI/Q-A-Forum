<p>Try CreateFile and WriteFile.</p>

<pre><code>string s = "file.dat";

HANDLE hFile = CreateFile(s.c_str(),       // name of the write
                   GENERIC_WRITE,          // open for writing
                   0,                      // do not share
                   NULL,                   // default security
                   CREATE_ALWAYS,          // Creates a new file, always
                   FILE_ATTRIBUTE_NORMAL,  // normal file
                   NULL);                  // no attr. template
DWORD writesBytes;
bool writeok = WriteFile(hFile, &amp;Current_Doc, sizeof(Current_Doc), &amp;writesBytes, NULL);

CloseHandle(hFile);
</code></pre>

<p>Similar problem, and my answer is here: </p>

<p><a href="http://stackoverflow.com/questions/16791953/openfilename-open-dialog/16792858#16792858">OPENFILENAME open dialog</a></p>
