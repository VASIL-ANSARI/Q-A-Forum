<p>Change the last select to:</p>

<pre><code>SELECT  Item,
        [Year],
        CASE WHEN SUM(NoOfDays) &lt; 0 THEN SUM(NoOfMonth)-1 
            WHEN SUM(NoOfDays) &gt; 30 THEN SUM(NoOfMonth)+1 
            ELSE SUM(NoOfMonth) END as NoOfMonth,
        CASE WHEN SUM(NoOfDays) &gt;= 30 THEN SUM(NoOfDays)-30 
            WHEN SUM(NoOfDays) &lt; 0 THEN SUM(NoOfDays)+30
            ELSE SUM(NoOfDays) END as NoOfDays
FROM cte
GROUP BY Item,[Year]
ORDER BY Item
OPTION (MAXRECURSION 0)
</code></pre>

<p>The main problem of such report - it is hard to define what is <strong>1 month</strong>, DATEDIFF just takes number from 2 dates and subtract one from another.</p>

<p>I have choose 30 as a days count in month, and now I compare values of days with 30 so we can add <code>+1</code> to month if the day count goes under zero or below 30</p>
