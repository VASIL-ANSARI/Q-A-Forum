<p>You can join together <code>table1</code> and <code>table2</code> and then compare the length of the email addresses for each <code>id</code>.  Since you want to conditionally replace the <code>@xy</code> format with the <code>@xyz</code> format, you can simply choose the <em>longer</em> email address to retain in the query.</p>

<pre><code>SELECT t2.id, t2.name,
    CASE WHEN CHAR_LENGTH(t2.email_id) &gt; CHAR_LENGTH(COALESCE(t1.email_id, ''))
        THEN t2.email_id ELSE t1.email_id END AS email_id
FROM table2 t2 LEFT JOIN table1 t1 ON t2.id = t1.id
</code></pre>
