<p>I think the problem is in "<code>session_start()</code>": every session locks a file in the server, so no other script can start using the same session (they all hang on their "<code>session_start()</code>" call) until the the first script ends and/or releases the lock. Your script should read the $user outside the loop and then call <code>session_commit()</code>, so other script can run. Remember that session locking always prevents parallel execution of scripts: always call <code>session_commit()</code> in your script if you've finished reading or modifying your session variables, so other script can run while the first finishes his elaboration (google around for other more elaborate solutions). This is very important, for example, if your browser does a lot of asynchronous ajax calls to your <code>php</code> code using sessions: without "<code>session_commit()</code>" you'll see your server respond to the requests one at the time without any parallelism</p>
