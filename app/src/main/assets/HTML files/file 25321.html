<p>Because you only check if the token exists, it doesn't matter which token is entered. 
I suppose in your <code>LinkToken</code> model the post is kept as a foreign key, overwise you won't be able to fix it.</p>

<p>When yes, try something like this <del>(find_by_x helpers are deprecated as of Rails 4)</del> <em>they return a single resource</em>:</p>

<p><code>link_token = LinkToken.where(post_id: params[:id], token: params[:token]).first</code></p>
