<p>I've implemented that in one of my applications.</p>

<p>I used a <a href="http://en.wikipedia.org/wiki/Command_pattern" rel="nofollow">command pattern</a> in my architecture. The record button in the application sets a RecordingFlag.
While the RecordingFlag is true, store all the executed commands (read Command pattern first to understand this) until RecordingFlag is false (user push record button again).</p>

<p>Running the recorded macro is just iterate the stored commands and execute them in order.</p>
