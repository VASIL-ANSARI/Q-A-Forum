<p>Derive <a href="http://msdn.microsoft.com/en-us/library/z0c68dy1%28v=vs.110%29.aspx" rel="nofollow">CDatabase</a> and override <a href="http://msdn.microsoft.com/en-us/library/c689y99f.aspx" rel="nofollow">OpenEx</a>. In your derived class <code>CMyDatabase</code>, replace the call to <code>AllocConnect</code> to <code>MyAllocConnect</code>. Obviously, your <code>MyAllocConnect</code> function should call <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms713564%28v=vs.85%29.aspx" rel="nofollow">SQLSetConnectOption</a> with the desired parameter:</p>

<pre><code>// Turn on cursor lib support
if (dwOptions &amp; useCursorLib)
{
    AFX_SQL_SYNC(::SQLSetConnectOption(m_hdbc, SQL_ODBC_CURSORS, SQL_CUR_USE_ODBC));
    // With cursor library added records immediately in result set
    m_bIncRecordCountOnAdd = TRUE;
}
</code></pre>

<p>Then use your <code>CMyDatabase</code> class instead of <code>CDatabase</code> for all your queries.</p>
