<p>because your u_datetime column contains date &amp; time</p>

<p>one way is to handle in the WHERE clause</p>

<pre><code>and a.U_datetime &gt;= @As_ONDATE
AND a.U_datetime &lt;  DATEADD(DAY, 1, @As_ONDATE)
</code></pre>

<p>Also you might want to consider converting your query not to use Cursor</p>
