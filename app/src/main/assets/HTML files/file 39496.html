<p>If I understood it right, you want this:</p>

<pre><code>select least(trunc(70+count(*)/5), 100), ref_number
from xxtable
group by ref_number
</code></pre>

<p>Edit:
So, I think that should work</p>

<pre><code>select least(trunc(70+(row_number() over (partition by ref_number order by ref_number)-1)/5), 100), ref_number
from xxtable
</code></pre>

<p>Edit:
This should work:</p>

<pre><code>select type, LISTAGG(ref_number, '') WITHIN GROUP (ORDER BY ref_number) 
from(
select least(trunc(70+(row_number() over (partition by ref_number order by ref_number)-1)/5), 100) type, ref_number
from xxtable)
group by type, ref_number
</code></pre>

<p>Note: I can't try it out, so I might have put another bug in there.</p>
