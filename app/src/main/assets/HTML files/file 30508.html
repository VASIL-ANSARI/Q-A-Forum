<p>You can try this:   </p>

<pre><code>$text = preg_replace('~(?:&lt;br\b[^&gt;]*&gt;|\R){2,}~i', "\n", $text);
</code></pre>

<p>where <code>\R</code> matches any type of newlines and <code>[^&gt;]</code>, all characters except <code>&gt;</code>.</p>
