<blockquote>
  <p>I need to know that if there is any problem if i put update then insert inside a loop, or insert then update inside a loop.</p>
</blockquote>

<p>Sure this is a problem.</p>

<p>You should get rid of the loop and make your operations set-based:</p>

<pre><code>INSERT
INTO    messages_tbl (message_id, message_text, user_id, status)
SELECT  NULL, '{$message_text}', user_id, '0'
FROM    users_tbl
WHERE   status = 'sub' 
        AND expire_timestamp &lt; '{$now_timestamp}'

UPDATE  users_tbl
SET     status = 'pending'
WHERE   status = 'sub' and expire_timestamp &lt; '{$now_timestamp}'
</code></pre>
