<p>I think your query can be like this:</p>

<pre><code> insert into MemberGroup (MemberId, MemberGroupId, MemberJoinDate, MemberExpiryDate)
 (SELECT TransMemberId , 404, MAX(transaction_time), dateadd(yy,1,MAX(transaction_time))

 FROM DataTrans 
      INNER JOIN DataTransItem ON DataTransId = DataTransItemId
      LEFT JOIN MemberGroup ON MemberId = DataTransItemId
      INNER JOIN MemberMembership ON MemberId = MembershipId
      INNER JOIN LinkedMember ON MembershipId = LinkedMemberId

 WHERE membership_clubid = 1 
      AND TransMemberId IN (select LinkedMemberId from LinkedMember where MemberGroupId NOT IN (1, 2, 3, 4, 5))
      AND TransMemberId IN (select MemberLinkedId from LinkedMember where DataTransItemId = 2414)

 GROUP BY TransMemberId)
</code></pre>

<p>As you can check; the result of this clue:</p>

<pre><code>WHERE TransMemberId IN (select LinkedMemberId from LinkedMember)
    AND TransMemberId IN (select LinkedMemberId from LinkedMember where MemberGroupId NOT IN (1, 2, 3, 4, 5))
</code></pre>

<p>is as same as this clue:</p>

<pre><code>WHERE TransMemberId IN (select LinkedMemberId from LinkedMember where MemberGroupId NOT IN (1, 2, 3, 4, 5))
</code></pre>
