<p>The <code>Function</code> you are creating for the transformation is, in fact, an (anonymous) inner class of <code>SparkPrunedSet</code>. Therefore every instance of that function has an implicit reference to the <code>SparkPrunedSet</code> object that created it.</p>

<p>Therefore, serialization of it will require serialization of <code>SparkPrunedSet</code>.</p>
