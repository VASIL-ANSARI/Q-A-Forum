<p>Your function <code>getTestCase</code> creates new array with one element and put it into variable <code>$cellValue</code> at each iteration. So, the array returned by this function contains only one element. You should fix it in this way:</p>

<pre><code>function getTestCase($row, $highestColIndex, $PHPobjWorksheet) {
  $cellValue = array();
  for($col = 0; $col &lt;= $highestColIndex; ++$col) {
    $v = $PHPobjWorksheet-&gt;getCellByColumnAndRow($col,$row)-&gt;getValue();
    $cellValue[] = $v; //append element to the array
  }
  return $cellValue;
}
</code></pre>
