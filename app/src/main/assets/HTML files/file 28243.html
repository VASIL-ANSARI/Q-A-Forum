<p>You have to have an <code>auth-constraint</code> in your <code>security-constraint</code> element (instead of <code>user-data-constraint</code>). Using <code>auth-constraint</code> you can specify a user or role in your application (named <em>Principal</em> in <em>JAAS</em> vocabulary and <em>Role</em> in web.xml vocabulary) which can access specified <code>web-resource-collection</code>. This User or Role has to be defined in web.xml inside <code>security-role tag</code>.</p>

<p>The final web.xml content should be something like this:</p>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app id="WebApp_ID"
         version="2.4"
         xmlns="http://java.sun.com/xml/ns/j2ee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"&gt;
    &lt;display-name&gt;FormBasedAuthentication&lt;/display-name&gt;
    &lt;login-config&gt;
        &lt;auth-method&gt;FORM&lt;/auth-method&gt;
        &lt;form-login-config&gt;
            &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;
            &lt;form-error-page&gt;/error.html&lt;/form-error-page&gt;
        &lt;/form-login-config&gt;
    &lt;/login-config&gt;
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;SecurePages&lt;/web-resource-name&gt;
            &lt;description&gt;Security constraint for resources in the secure directory&lt;/description&gt;
            &lt;url-pattern&gt;/secure/*&lt;/url-pattern&gt;
            &lt;http-method&gt;POST&lt;/http-method&gt;
            &lt;http-method&gt;GET&lt;/http-method&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;role-name&gt;admin&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
    &lt;security-role&gt;
        &lt;role-name&gt;admin&lt;/role-name&gt;
    &lt;/security-role&gt;
&lt;/web-app&gt;
</code></pre>
