<blockquote>
  <p>The first thing which isn't working is that I can have nulls in both Reference and CustomerNumber and I'll still get data returned based on the date range,</p>
</blockquote>

<p>Please clarify this - do you want this behaviour, or is this behaviour occurring and not desirable?</p>

<blockquote>
  <p>The second thing which isn't working is when I enter a CustomerNumber range it returns CustomerNumers outside of the range specified.</p>
</blockquote>

<p>Your AND / OR precedence isn't correct. Bracket the OR's before the AND:</p>

<pre><code>(Table3.Number &gt;= @CustomerNumFrom OR @CustomerNumFrom IS NULL)
AND
(Table3.Number &lt;= @CustomerNumTo OR @CustomerNumTo IS NULL)   
</code></pre>

<p>Note however that the comparison will only work with a fixed number of digits on the Customer Number, e.g. comparing <code>F51</code> to <code>F51111</code> won't end well.</p>

<p>One other point - doing <code>CONVERT</code> in the where clause like this will hurt performance (SARGability). It seems strange that the Date and Time have been separated in the data model - if you combine Date and Time into one column, you can do a direct date time comparison?</p>
