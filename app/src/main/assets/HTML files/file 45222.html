<p>You're calling <code>reopen</code> on <code>STDOUT</code> since <code>$stdout</code> is just a global  variable that points to the same object. This permanently changes <code>STDOUT</code>.</p>

<p>What about this:</p>

<pre><code>$stdout = File.open(@filename, 'w:UTF-8')

# ...

$stdout = prev_std
</code></pre>
