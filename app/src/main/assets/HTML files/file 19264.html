<p>You need to use the full path to save the file to the desktop.  You can get the path using the <code>Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory</code>, like this:</p>

<pre><code>string targetFolder =  Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);
string targetPath = Path.Combine(targetFolder, "Data.csv");
</code></pre>

<p>Then use FileStream with the full path:</p>

<pre><code>fs = new FileStream(targetPath, FileMode.Create);
</code></pre>

<p><strong>Edited Per Comments Below</strong></p>

<p>The key to this is specifying the path to where you want to save the file.  Just giving a file name will put it in the directory the application is excuting from.  An easy way to do this would be to use the <code>GetDirectoryName</code> method of the <code>Path</code> class.  Assuming the file was passed in, read from a config file, hard coded, etc:</p>

<p>string path = Path.GetDirectoryName(sourceFile);
   string target = path + @"\" + "Data.csv";</p>

<p>If the sourceFile was C:\Data\Input.xml, then path would equal "C:\Data", and target would be C:\Data\Data.csv.</p>

<p>The advantage here is that you can pass a filename with the path, and it will always place the targetfile in the same location.  This lends itself nicely to parameterization of the method, or maybe even having the user select the file through an OpenFileDialog box or similar mechanism.</p>

<p><strong>Additional Edit Per John's Comment</strong></p>

<p>Based on the code you posted, the Data.xsl file is in the executing application's folder.  In that case, you'd simply need to do the following:</p>

<pre><code>fs = new FileStream("data.csv", FileMode.Create);
</code></pre>

<p>No need to mess with paths, as the filestream will also go to the executing application's directory.</p>

<p>In the end, it's all about using the information available from the sourcefile (i.e., it's location/path data) and applying it to the target file's full path and name.</p>
