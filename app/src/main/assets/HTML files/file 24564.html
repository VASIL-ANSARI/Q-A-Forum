<p>Is there a reason why you don't just join the tables and use a <code>row_number</code> to return the first row for each <code>billcode</code>:</p>

<pre><code>select billcode, flagset
from
(
  select b.*, -- replace this with your columns
    i.checkflag flagSet,
    row_number() over(partition by b.billcode order by i.CheckFlag desc) rn
  from Bill_items b
  left join Linked_items l
    on l.Bill_Code = b.BillCode
  left join inventoryitems i
    on l.Item_code = i.ItemCode
) d
where rn = 1;
</code></pre>

<p>See <a href="http://sqlfiddle.com/#!3/89f6d/3" rel="nofollow">SQL Fiddle with Demo</a></p>

<p>The <code>CheckFlag</code> is a bit so the result will be zero or one, there shouldn't be a need for the CASE.</p>
