<p>You could use a CASE statement</p>

<pre><code>select min(id) as id, label, active
from (
     select id, label, active,
           case
             when active = 1 then 'active'
             else convert(varchar,newid()) as discriminator
           end
     from table) t
group by label, active, discriminator
</code></pre>

<p>this will give a common value to all rows that meet the condition (active = 1) and a unique value to all other rows so that they remain ungrouped.</p>

<p>I don't have access to SQL server at the moment so this is completely untested.</p>
