<p>No matter what this is going to be a complex algorithm, a simple <code>array_walk</code> wont do. Unless someone is feeling particularly generous and will write one for you, I suggest you <strong>hire</strong> a programmer.</p>

<hr>

<blockquote>
  <p>Am I storing wrong? If you have the better solution to store it I will be happy to hear it.</p>
</blockquote>

<p>It totally depends on your algorithm. You can probably write one that uses your current data format. You can also probably write a simpler one if you change your data format. But what your data format should look like then, well, that's a job for a programmer.</p>
