<p>You could use a shared blocking queue, which is filled with the records you need to process (which means that you select those 30000 records somewhere outside of your <code>ExecutorService</code> threads).</p>

<p>Then, in your <code>Thread</code> code each thread gets top 1000 (<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html#drainTo-java.util.Collection-int-" rel="nofollow">using this method</a>) records from the queue and does it's processing. Here is the important part: the records rejected by a web-service are put back to the queue - so when another executor thread is available it will pick the undelivered.</p>

<p>You would need to add delivery counter to your records and check if a message is redelivered limited number of times (so they aren't redelivered forever if they are somehow malformed).</p>
