<p>It is difficult to see what is wrong from the given code alone. Some general pointers:</p>

<ol>
<li><p>The object is initialized and processed in different binary modules with incompatible linking (such as C-run times)</p></li>
<li><p>If the class/structure is shared it is not exported/imported correctly.</p></li>
<li><p>The class(s) are defined in more than one place, and you are not including the correct definitions.</p></li>
</ol>

<p>The above three are the most likely causes, especially, if all fields are reset to their default initialized values.</p>

<p>if this is only happening with only one or two fields, the structure may be poorly aligned and you may need to rearrange the fields to correct these (check that in release too).</p>

<p>In general, I am tempted to hypothesize that the object you have intialized is not the one <code>RefreshCommProperties()</code> sees, for some reason, may be one of the three above.</p>
