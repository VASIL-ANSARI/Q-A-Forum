<p>You can use a group by and a dinamic temp table for total</p>

<pre><code>  select 
    a.name, a.status
 ,  count(a.countKey) as CountKEy
 , c2 as CountKeyTotal
 , (a.count(*) / b.c1) *100 as percentage 
 from my_table as a 
 inner join( select name, count(*) as c1 , count(countKey)  c2 from  my_table
             group by name) b  on a.name = b.name
 group by a.name
</code></pre>
