<p>My further workaround results:
Expect do not work on widows because windows do not support pseudo terminals(PTY) so I can't use ruby_expect like libraries for windows!</p>

<p>I tried IO.select in combination with IO.read_nonblock which encounters "bad file pointer". Some people said that <a href="https://www.ruby-forum.com/topic/3554151" rel="nofollow">non-blocking IO is not supported in windows as well</a></p>

<p>So I used some special strings to synchronize the read-write sequences myself and the task is done.</p>
