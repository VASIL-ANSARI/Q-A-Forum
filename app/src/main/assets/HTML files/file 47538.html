<p>The element is not removed until after 1000 milliseconds pass and the animation completes. Wait until then to count the elements.</p>

<p>edit: here's the more complicated way to delay till all animates complete:</p>

<pre><code>$list = $(".elements_list");
var n = 0;
$list.each(function(){
  if ( $(this).data("quantity") == 0) {
    n = n + 1; // one more callback to wait for
    $(this).slideUp(1000,function(){
      $(this).remove();
      n = n-1;
      checkIfAllDone();
    });
  }
});
function checkIfAllDone(){
  if(n===0){ // be sure that n was declared in the same scope as this function
    change_background_colors();
  }
}
</code></pre>
