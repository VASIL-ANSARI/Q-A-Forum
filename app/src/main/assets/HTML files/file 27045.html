<p>Your extern function is wrongly defined. Let's take your C call example.</p>

<pre><code>// Search configuration information 
CLIENT_API BOOL  CALL_METHOD CLIENT_GetDevConfig(LLONG lLoginID, DWORD dwCommand, LONG lChannel, LPVOID lpOutBuffer, DWORD dwOutBufferSize, LPDWORD lpBytesReturned,int waittime=500);
</code></pre>

<p>As stated in comment of your post, the length of <code>LONG</code> is 32-bit in Win32, so you have to use an <code>int</code>. You can also use the keyword <code>out</code> to get your structure without manually use the Mashaller. I would define your function as that.</p>

<pre><code>[DllImport("dhnetsdk.dll", CallingConvention = CallingConvention.Cdecl)]
[return: MarshalAs(UnmanagedType.Bool)]
public static extern bool CLIENT_GetDevConfig(int loginId, uint command, int channel, out NET_TIME buffer, out uint bufferSize, IntPtr lpBytesReturned, int waittime = 500);
</code></pre>

<p>Note the presence of the additional attribute <code>MarshalAs</code>. It indicates how the managed code should consider the return value of the pinvoke'd function.</p>
