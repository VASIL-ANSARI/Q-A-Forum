<p>The second query is wrong because the first query is wrong; I don't think it's valid SQL, and I'm not sure why it's working for you.</p>

<p>The inner query (which I'll call Q1) of the first query is ok: SELECT id, COUNT(id) AS total FROM ... GROUP BY id;</p>

<p>But the outer query of the first query is broken: SELECT id, MAX(total) FROM ...; without a GROUP BY.  This is wrong because the MAX forces an aggregation over the entire table (which is what you want), but the 'id' is not aggregated.</p>

<p>If you remove 'id, ' from the query, you should correctly get the maximum: SELECT MAX(total) AS maximum FROM ...; which I'll call Q2.</p>

<p>Then it gets ugly, because SQLite doesn't support CTEs.  Basically it is:</p>

<pre><code>SELECT id FROM (Q1) WHERE total = (Q2);
</code></pre>

<p>but you have to write out Q1 and Q2, and there's a lot of repetition because Q2 includes Q1.</p>
