<p>Looks like the connection is being disposed of (or possible not even opened at all!)</p>

<p>Ideally I'd change that to use a unit-of-work approach, and also wrap your instances in using blocks to ensure they are correctly disposed of:</p>

<pre><code>using (var connection = new MySqlConnection("connection-string"))
{
  using (var command = new MySqlCommand(query, connection))
  {
    connection.Open();

    command.Parameters.AddWithValue("?name", name);

    using (var reader = command.ExecuteReader())
    {
      while (reader.Read())
      {
        Console.WriteLine(reader[0]);
      }
    }
  }
}
</code></pre>

<p>Also, what's the purpose of calling <code>cmd.ExecuteNonQuery();</code> after you've already used <code>ExecuteReader()</code>?</p>
