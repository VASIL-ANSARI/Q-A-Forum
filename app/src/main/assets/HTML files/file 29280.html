<p>Although this is messy, but for some reason it worked. I had to call animate twice in order to scroll to the right place.</p>

<pre><code>$('html, body').stop()
  .animate({scrollTop: $($anchor.attr('href')).offset().top - $headerSize},function(){
      $('html, body').stop()
        .animate({scrollTop: $($anchor.attr('href')).offset().top - $headerSize});
    });
</code></pre>
