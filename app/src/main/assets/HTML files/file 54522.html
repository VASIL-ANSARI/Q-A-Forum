<p>As for your question's title</p>

<blockquote>
  <h2>Is copy paste programming sometimes allowed?</h2>
</blockquote>

<p>No. It's error prone<sup>1</sup> from the bone (hey that rhymes).</p>

<blockquote>
  <p>How can I avoid it?</p>
</blockquote>

<p>The usual way to avoid copy/paste implementations is to provide template functions or classes that factor out the type unspecific code.</p>

<p>The type specific code can be refactored to type specialized function calls.</p>

<hr>

<p><sub>1) There are even made extensive efforts from static code analysis tools to detect copied/copy modified code, and warn about potential errors copied along.<br>
The really good tools to detect this with least false positives are pretty expensive, so just don't do it.</sub> </p>
