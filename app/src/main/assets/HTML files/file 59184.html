<p>I read your post multiple times and I think I finally get what you are trying to achieve.</p>

<p>try this:</p>

<pre><code>df['weekday'] = df.index.weekday
df['hour_of_day'] = df.index.hour
weekly_model = df.groupby(['weekday', 'hour_of_day']).mean()
dates = pd.date_range('2015/1/1', '2015/12/31 23:59', freq='H')
</code></pre>

<p>then use merge like this:</p>

<pre><code>annual_series = pd.merge(df.reset_index(), weekly_model.reset_index(), on=['weekday', 'hour_of_day']).set_index('date')
</code></pre>

<p>now you can use asof since you have dates as index</p>

<pre><code>annual_series.asof(dates)
</code></pre>

<p>is that what you were looking for?</p>
