<p>Scapy uses what is called layer binding to indicate when specific packet dissector shall be applied. You can see in scapy source code examples in each layer module.</p>

<p>E.g. If you use your protocol over TCP port 2222, you can add following line to your module:</p>

<pre><code>bind_layers( TCP, MyProtocol, dport=2222)
</code></pre>

<p>Scapy will attempt to use MyProtocol to dissect the TCP payload as MyProtocol. </p>
