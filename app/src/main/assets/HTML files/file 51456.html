<p>Your problem is here :</p>

<pre><code>textBox1.Text = textBox1.Text.Replace(textBox1.Text.Substring(textBox1.SelectionStart, textBox1.SelectionLength),"A");
</code></pre>

<p>The Substring function returns string. In your example (666777222333 select any 7 then the result = 666AAA222333 (not working)), it returns "7". But Text.Replace will replace all occurrences of 7. That is not what you want. What you can do is, instead of using <code>string.Replace</code> function, use <code>string.Remove</code> and <code>string.Insert</code></p>

<pre><code>textBox1.Text = textBox1.Text.Remove(textBox1.SelectionStart, textBox1.SelectionLength).Insert(textBox1.SelectionStart, "A");
</code></pre>

<p>But this might not be very efficient for large strings. A <code>StringBuilder</code> would be better.</p>
