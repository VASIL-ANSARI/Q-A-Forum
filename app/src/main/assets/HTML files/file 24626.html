<p>You should create all your UI objects in the same thread:</p>

<pre><code>private void addstackrows()
{

    Dispatcher stackpaneldispatcher = stackPanel1.Dispatcher;
    stackPanel1.Dispatcher.Invoke(new Action(() =&gt;
    {
        stackPanel1.Children.Clear();
        stackPanel1.Orientation = Orientation.Vertical;
    }));

    foreach (var randomelement in elementcollection)
    {
        stackPanel1.Dispatcher.Invoke(new Action(() =&gt;
        {
            StackPanel stackrow = new StackPanel();
            stackrow.Orientation = Orientation.Horizontal;
            stackPanel1.Children.Add(stackrow);
        }));
    }
}
</code></pre>

<p>Also, I would group all your <code>Dispatcher</code> calls. Each time you call <code>Invoke</code> there is a performance overhead. So, unless you do a time consuming operation inside your loop, it would be probably better to put the whole function inside a <code>Invoke</code>.</p>
