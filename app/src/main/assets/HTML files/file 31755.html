<p>see <a href="http://stackoverflow.com/questions/9980568/row-number-over-partition-by-xxx-in-linq">Row_number over (Partition by xxx) in Linq?</a> 
for doing the partition.</p>

<p>The rest is fairly basic linq syntax.</p>

<p>I haven't tested this or tried to compile it, so it may need a little modification. I split up the query similar to the question just for clarity, but these can easily be combined into one line.</p>

<pre><code>var messages = smsParseds
   .OrderBy(o =&gt; o.sentTime).GroupBy(g =&gt; g.originator)
   .Select(s =&gt; new {s, rk = s.Count()})
   .SelectMany(sm =&gt; sm.s.Select(b =&gt; b)
      .Zip(Enumerable.Range(1,sm.rk), (j,i) =&gt; new {j.siteId, j.originator, j.sentTime, j.mode, j.mainsFrequency, j.gensetFrequency, j.dgBattery, j.runHours, j.fuel, j.messageID, j.messageText, rk = i}));

var result = messages
   .Where(w =&gt; w.rk = 1)
   .OrderByDescending(o =&gt; o.sentTime)
</code></pre>
