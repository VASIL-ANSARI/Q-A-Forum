<p>There is a massive VB script called <a href="http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d3df4bc9-0954-459a-b5e6-7a8bc462960c.mspx?mfr=true" rel="nofollow">ADSUtil.vbs</a> that lives in IIS's admin directory that can be used to configure IIS in a scripted, if not programmatic, way.  You could either call out to it, or read it and rip off its internals.</p>
