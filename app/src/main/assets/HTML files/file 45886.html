<p><strong>Edit:</strong> Prior version used apply/lambda which is not really necessary.  This is a simpler version.</p>

<p>Here's a smaller dataframe based on just your first 10 rows.</p>

<pre><code>df

         v1          v2          v3
0  0.012200    0.012000    0.000002
1  0.012244    0.014200    0.000002
2  0.010400    0.010100    0.000001
3  0.013658    0.018562    5.011580
4  0.011322    0.022145    0.078593
5  0.506949    0.010000    0.000001
6  1.165670    0.014103  168.078000
7  0.010000    0.010006    0.000001
8  0.035100  153.682000  163.082000
9  0.012982    0.016500    0.056087
</code></pre>

<p>And here's mask that selects only values between the 25th and 75th percentiles.  Note that the syntax for this is somewhat precise so be careful with the parentheses and such.</p>

<pre><code> ( df &gt; df.quantile(.25) ) &amp; ( df &lt; df.quantile(.75) )

      v1     v2     v3
0   True   True   True
1   True   True   True
2  False  False  False
3   True  False  False
4  False  False   True
5  False  False  False
6  False   True  False
7  False  False  False
8  False  False  False
9   True   True   True
</code></pre>

<p>This is column-based, btw.  I just glanced quickly at your code and couldn't easily tell if the percentile measures were intended per-column of for the combination of the 3 columns.  For the whole dataframe you can do:</p>

<pre><code>( df &gt; df.stack().quantile(.25) ) &amp; ( df &lt; df.stack().quantile(.75) )
</code></pre>
