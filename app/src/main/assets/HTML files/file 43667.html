<p>Ruby has the <code>retry</code> method, that can be used in the <code>rescue</code> clause.</p>

<p>It just runs the current method again, so you can use a counter to limit the number of retries:</p>

<pre><code>def self.encrypt_password(password)
  retries = 2
  uri = URI
  params = Base64.encode64(password)
  uri.query = URI.encode("Source=#{params}")
  retries.times.each do
    res = Net::HTTP.get_response(uri)
    if res.is_a?(Net::HTTPSuccess)
      obj = JSON.parse(res.body)
      pw = Base64.decode64(obj["Data"])
      ps = Base64.decode64(obj["Key"])

      pws = Iconv.iconv('ascii', 'utf-16', pws)
      return pwe,pws[0]
    end 
  end
rescue SomeExceptionType
  if retries &gt; 0
    retries -= 1
    retry
  else
    raise "Error generating pws: #{$!}"
  end
end
</code></pre>

<p>end</p>
