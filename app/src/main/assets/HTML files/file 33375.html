<p>You mention that it's code size you want to optimize, and that you're doing this on an Arduino clone (based on the ATmega32U4).</p>

<p>Those controllers don't have hardware support for floating-point, so it's all going to be emulated in software which takes up a lot of code.</p>

<p>Try re-writing it to do fixed-point arithmetic, you will save a lot of code space that way.</p>

<p>You might see minor gains by optimizing the other data types, i.e. <code>uint16_t</code> instead of <code>long</code> might suffice for some of the values, and marking functions as <code>inline</code> can save the instructions needed to do the jump. The compiler might already be inlining, of course.</p>
