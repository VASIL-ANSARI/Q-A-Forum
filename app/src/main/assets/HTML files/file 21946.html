<p>1) The GetDetails method must return a DataTable, so I changed <code>string</code> to <code>DataTable</code> and return <code>dt;</code></p>

<pre><code>public partial class ThisAddIn
{
public DataTable GetDetails()
  {
  // Some Codes here
    DataTable dt = new DataTable();
    dt.Columns.Add("id");
    dt.Columns.Add("uid");
    dt.Columns.Add("email");
    DataRow row = dt.NewRow();    
     row["id"] = sid;
     sid++;    
     row["uid"] = uid;
     row["email"] = e;
     dt.Rows.Add(row);
     return dt;
  }
}
</code></pre>

<p>2) Notice how I instantiate the ThisAddIn class, then I call the GetDetails method - returning the results into a DataTable who's scope is in context. </p>

<pre><code>private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
    ThisAddIn th = new ThisAddIn();
    //Declare a DataTable and call to GetDetails
    DataTable dt =  th.GetDetails();
    this.dataGridView1.Visible = true;
    dataGridView1.AutoGenerateColumns = false;
    dataGridView1.DataSource = dt;
}
</code></pre>

<p>3) When you instantiate <code>ThisAddIn th = new ThisAddIn();</code> you get the error:</p>

<blockquote>
  <p>This AddIn does not contain a constructor that takes 0 arguments</p>
</blockquote>

<p>To resolve this you need to supply some values (arguments in the parameter) when instantiating the class:</p>

<pre><code>ThisAddIn th = new ThisAddIn(value1, value2, etc)
</code></pre>
