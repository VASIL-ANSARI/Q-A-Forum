<p>If I get it right, you (should) have 2 models. A Route model, and a Stop model.</p>

<p>Here's how I would define these models:</p>

<pre><code>class Route &lt; ActiveRecord::Base
  has_and_belongs_to_many :stops
  belongs_to :stop, :foreign_key =&gt; 'destination_id'
end

class Stop &lt; ActiveRecorde::Base
  has_and_belongs_to_many :routes
end
</code></pre>

<p>And here's how I would set up my tables:</p>

<pre><code>create_table :routes do |t|
  t.integer :destination_id
  # Any other information you want to store about routes
end

create_table :stops do |t|
  # Any other information you want to store about stops
end

create_table :routes_stops, :primary_key =&gt; [:route_id, :stop_id] do |t|
  t.integer :route_id
  t.integer :stop_id
end
</code></pre>

<p>Finally, here's the code I'd use:</p>

<pre><code># First, find all the relevant routes, just for caching.
Route.find(numbers)

r = Route.find(number)
r.destination_id = destination
r.stops &lt;&lt; stop
</code></pre>

<p>This should use only a few SQL queries.</p>
