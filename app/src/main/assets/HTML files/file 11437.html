<p>There is no correlation between the index in a particular serialization of the XML Document and an element. The closest you could do:</p>

<p>Recursively, at each level of the DOM, serialize the element and see if its length (added to what you have so far) has reached your index.</p>

<p>Unfortunately this is not guaranteed to work, since:</p>

<ol>
<li><p>Many different (non-canonical) serializations are possible that describe the same XML document (e.g. <code>foo="You said, &amp;quot;Hi!&amp;quot;"</code> vs. <code>foo='You said, "Hi!"'</code>).</p></li>
<li><p>Depending on whether you consider blank whitespace nodes as significant, two different XML documents might be treated the same (e.g. <code>&lt;foo&gt;&lt;bar&gt;</code> vs. <code>&lt;foo&gt;\n\t&lt;bar&gt;</code>)</p></li>
<li><p>In HTML, additional non-significant whitespace might be stripped (e.g. <code>&lt;p&gt;a  b&lt;/p&gt;</code> vs. <code>&lt;p&gt;a b&lt;/p&gt;</code>).</p></li>
</ol>
