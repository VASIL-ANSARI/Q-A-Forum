<p>The problem is likely in the <code>cleanup</code> code where you have no <strong>finally</strong> block.</p>

<p>If any of the <code>ResultSet</code> or <code>Statement</code> cleanup throws an exception, the <code>con.close()</code> will not happen.</p>

<p>Try something like (not tested):</p>

<pre><code>public static void cleanUp(Connection con, Statement stmt, ResultSet rs) {
    try {
        if (rs != null) {
            while (rs.next()) // Drain the resultset.
                ;
            rs.close();
        }

        if (stmt != null)
            stmt.close();

    } catch (SQLException e) {
        log.error("Failed to close statement", e);
    }
    finally {
        if (con != null)
           try {
               con.close();
           } catch (SQLException e) {
               log.error("Failed to close connection", e);
           } 
    }
}
</code></pre>

<p>Similar issues might occur elsewhere.</p>

<p>It's also likely that you don't actually need some of the other code here.  I don't think there's anything gained by "draining" the resultset before closing it, and closing the statement will also close the resultset.</p>
