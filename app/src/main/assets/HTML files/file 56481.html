<p>$headers is simply not an arary. make sure it's an array, and throw an InvalidArgumentException if its not. like this:</p>

<pre><code>private function useCurl(&amp;$model, $url, $headers, $fields = null) {
if(!is_array($headers)){throw new InvalidArgumentException('headers MUST be an array!');}
...
</code></pre>

<p>or, as of PHP7, </p>

<pre><code>private function useCurl(&amp;$model, $url, array $headers, $fields = null) {
...
</code></pre>

<p>and note that while you declare a variable called $headers right above, its outside the function definition, and thus outside of the function's scope. the function's $headers is input argument #3</p>
