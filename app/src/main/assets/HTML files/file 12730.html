<p>I feel your pain.  I fought with this for a long time myself...</p>

<p>When you get the "is not a function" message, basically what's happening is that either:
a) your javascript can't find your movie instance.
or
b) your actionscript is not properly exposing the loadMedia() method.</p>

<p>It's always a good idea to have check() methods in your js and your as.  They are used to ensure each element has fully loaded and is ready for manipulation/use.  There are a number of posts regarding this.</p>

<p>Have you noticed a difference between IE and Firefox?  Does one work, but the other not?</p>

<p>In the following block:</p>

<pre><code>var videoObj = swfobject.getObjectById('vp');
  if(typeOf videoObj == 'undefined')
  {
       //check if useragent string is IE
       var isIE = navigator.userAgent.match(/MSIE/i);
       videoObj = isIE ? window['vp'] : document['vp'];
  }
  return videoObj;
</code></pre>

<p>...you seem to be using swfObject's method to retrieve the movie, but then you are checking the browser and - AGAIN - looking in the DOM for the movie.  Have you tried commenting out the following block:</p>

<pre><code>if(typeOf videoObj == 'undefined')
      {
           //check if useragent string is IE
           var isIE = navigator.userAgent.match(/MSIE/i);
           videoObj = isIE ? window['vp'] : document['vp'];
      }   
</code></pre>

<p>...and just return the swfobject returned value?</p>

<p>As I understand it, swfObject will handle the browser detection for you.</p>

<p>Also, check that swfobject is actually giving the html object an id ('vp').</p>
