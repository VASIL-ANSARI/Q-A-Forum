<p>First, thank you for providing a self-contained sample (not many newbies do that)! If you want to improve your question, you should remove all debugging code from the sample, as now it clutters the code. The code is quite long and not very self-explanatory. (At least to me - the problem may be between my ears, as well.)</p>

<hr>

<p>Let us unroll the problem from the end. The proximal reason why you get an empty plot is that you have empty <code>xk</code>and <code>yk</code> (empty arrays).</p>

<p>Why is that? That is because you have 19 points, and thus your for loop is essentially:</p>

<pre><code>for i in range(12, 19-1-12):
    ...
</code></pre>

<p>There is nothing to iterate from 12..6! So actually your loop is run through exactly zero times and nothing is ever appended to <code>xk</code> and <code>yk</code>.</p>

<p>The same explanation explains the problem with <code>offset</code>. If the loop is never run through, there is no  <code>offset</code> defined in yout plot command (<code>xk+offset</code>), hence the <code>NameError</code>.</p>

<hr>

<p>This was the simple part. However, I do not quite understand your code. Especially the loops where you loop <code>order</code> form 0..19 look strange, as only the result form the last cycle will be used. Maybe there is something to fix?</p>

<p>(If you still have problems with the code after this analysis, please fix the things you can, simplify the code as much as possible, and edit your question. Then we can have another look into this!)</p>
