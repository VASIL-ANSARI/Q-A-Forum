<p>You can control this with a cmake variable. </p>

<pre><code>option(BUILD_TESTS "builds test cpp files" ON)
</code></pre>

<p>This adds an option for your cmake file. It defaults in this case to ON you can change that though. Now lets get on:</p>

<pre><code>if(BUILD_TESTS)
    set(TEST_CPP_FILES test1.cpp test2.cpp)
endif(BUILD_TESTS)

add_executabe(foo bar.cpp bar1.cpp $(TEST_CPP_FILES))
</code></pre>

<p>Here you define a variable with the source file of your tests (or whatever source files you want to build when the <code>BUILD_TESTS</code> is <code>ON</code>. These then get added to the target. If <code>BUILD_TESTS</code> is off this variable will be empty. </p>

<p>now to change the Value you can run </p>

<pre><code>cmake &lt;...&gt;  -DBUILD_TESTS=OFF
</code></pre>

<p>Or with <code>ON</code> if you want to turn them back on again. You also can keep the change in version control because it will default to <code>ON</code> and you need to explicitly disable it. </p>

<p>You can also exclude whole subdirectories or targets with this in the if statement if you not just only want to exclude source files.</p>

<p><strong>EDIT:</strong></p>

<p>For your example it could look like this:</p>

<pre class="lang-none prettyprint-override"><code>if(BUILD_TESTS)
    file(GLOB_RECURSE SRC_FILES_2
    ${SOURCE_BASE_DIR}/src_2/*.cpp
    ${SOURCE_BASE_DIR}/src_2/*.h
    )
endif(BUILD_TESTS)
</code></pre>

<p><code>SRC_FILES_2</code> should be empty afterwards. </p>
