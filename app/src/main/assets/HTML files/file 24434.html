<p>Here you have to keep a check upon the arguments in textbox- 
first remove the where condition from main query, append this where condition depending upon the arguments mentioned</p>

<pre><code>SelectCommand=SELECT SerialNum, SiteId, Location, ContainerId, Misplaced, Frozen,    Scratched, Destroyed, ScratchpoolId, Vendor, Exported, Erased, Bad, Encrypted,  Virtual, ReturnDate, ReturnSiteId FROM Media
                FULL JOIN MediaInfo
                ON Media.MediaID= MediaInfo.MediaID
                FULL JOIN MediaStatus
                ON MediaInfo.MediaID= MediaStatus.MediaID
                FULL JOIN MediaReturn
                ON MediaStatus.MediaID= MediaReturn.MediaID
                FULL JOIN MediaGenT
                ON Media.NoteID= MediaGenT.NoteID"

if(SerialNumber!=null &amp;&amp; SiteID!=null)
{

SelectCommand+="WHERE (([SerialNum] like '%' + @SerialNum + '%') AND ([SiteId] = @SiteId))"
}
elseif(SerialNumber.isnull() &amp;&amp; !SiteId.isnull())
{
 SelectCommand+="WHERE  [SiteId] = @SiteId"
}
elseif(!SerialNumber.isnull() &amp;&amp; SiteId.isnull())
{
SelectCommand+="where [SerialNum] like '%' + @SerialNum + '%'"
}
</code></pre>

<p>P.S Please use syntax of your respective language.</p>
