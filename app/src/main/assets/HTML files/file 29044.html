<p>IMHO:</p>

<ol>
<li>Change your <code>GetFile</code> to be an <code>ActionResult</code>.</li>
<li>If the file can be written<br>
a. Writing to a memory stream (instead of response)<br>
b. <code>return File(memoryStream, "text/plain");</code></li>
<li>If it can't be written<br>
a. <code>return Redirect("~/Main/Page");</code></li>
</ol>

<p>Pseudo code:</p>

<pre><code>public ActionResult GetFile(Int32 CategoryId)
{
  if (/*can be written*/)
  {
    using (MemoryStream stream = new MemoryStream())
    {
      using (StreamWriter writer new StreamWriter(stream))
      {
        /* writer.Write(...); */
      }
      return File(stream, "text/plain");
    }
  }
  return Redirect("~/main/Page"); // or redirectToRoute/RedirectToAction
}
</code></pre>

<p>And for reference: <a href="http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.file%28v=vs.108%29.aspx" rel="nofollow"><code>File()</code> response methods</a></p>

<p><em>FWIW: You can continue to use the <code>StringBuilder</code> and pass that to one of the <code>File()</code> overloads, I guess I just prefer streams. :shrug:</em></p>
