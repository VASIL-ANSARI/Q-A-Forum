<p>In JavaScript there's no block scope for your <code>for</code> loop, the <code>domain</code> variable is shared for all loops, it's scoped to the parent function, not strictly inside the loop (for example you could access it after the closing  <code>}</code> for the <code>for()</code> and it'd be the value it had in the last loop).</p>

<p>To resolve this, you need to create an additional scope with it's own variable; using <a href="http://api.jquery.com/jQuery.each/" rel="nofollow"><code>$.each()</code></a> is easiest in this case:</p>

<pre><code>$.each(data.sites, function(i, site){
  var domain = site.domain;
  $('#site-logout').append('&lt;div class="processing" id="' + domain.replace(".","-") + '"&gt;&lt;strong&gt;' + domain + '&lt;/strong&gt; is logging out.');
  $.getJSON(url, function(data){
    if(data.success == true)
        $("#" + domain.replace(".","-")).removeClass("processing").addClass("processed").html('&lt;strong&gt;' + domain + '&lt;/strong&gt; has logged out.');
    else
        $("#" + domain.replace(".","-")).removeClass("processing").addClass("error").text('&lt;strong&gt;&lt;a href="http://' + domain + '"&gt;' + domain + '&lt;/a&gt;&lt;/strong&gt; has failed to log out. Follow the link to try manually.');
  });
});
</code></pre>

<hr>

<p>The <code>for</code> loop way would be like this:</p>

<pre><code>for(var site in data.sites){
  (function(domain) {
    $('#site-logout').append('&lt;div class="processing" id="' + domain.replace(".","-") + '"&gt;&lt;strong&gt;' + domain + '&lt;/strong&gt; is logging out.');
    $.getJSON(url, function(data){
        if(data.success == true)
            $("#" +  domain.replace(".","-")).removeClass("processing").addClass("processed").html('&lt;strong&gt;' + domain + '&lt;/strong&gt; has logged out.');
        else
            $("#" + domain.replace(".","-")).removeClass("processing").addClass("error").text('&lt;strong&gt;&lt;a href="http://' + domain + '"&gt;' + domain + '&lt;/a&gt;&lt;/strong&gt; has failed to log out. Follow the link to try manually.');
    });
  })(data.sites[site].domain);
}
</code></pre>
