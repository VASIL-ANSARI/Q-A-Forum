<p>My following code are assuming all tables are in one database, this is more for demo convenience purpose. In real world, when you have tables in different databases, then you need to use 3-part naming convention, i.e. </p>

<pre><code>[DB].[Schema].[Table]
</code></pre>

<p>Also I am testing in sql server environment.</p>

<pre><code>use tempdb 
drop table dbo.merge_tbl, dbo.t1, dbo.t2;
create table dbo.merge_tbl (username varchar(30), email varchar(30));

create table dbo.t1 (username varchar(30), email varchar(30), lastlogin datetime)
create table dbo.t2 (username varchar(30), email varchar(30), lastlogin datetime)
go
-- insert a few records to tables
insert into dbo.t1 (username, email, lastlogin)
values ('james1', 'j@a.com', '20161001'), ('jenny1', 'j2@b.com', '20161002'), ('jeffrey1', 'j3@c.com', '20150101')

insert into dbo.t2(username, email, lastlogin)
values ('james2', 'j@a.com', '20161006'), ('jenny2', 'j2@b.com', '20151002'), ('jeffrey2', 'j4@c.com', '20170101')
go

-- this is the insert statement
insert into dbo.merge_tbl (username, email)
select case when t1.lastlogin &gt;= t2.lastlogin then t1.username else t2.username end
,   case when t1.lastlogin &gt;= t2.lastlogin then t1.email else t2.email end 
from dbo.t1 
inner join dbo.t2
on t1.email = t2.email;
go

-- check result
select * from dbo.merge_tbl
</code></pre>

<p>Here is the result</p>

<p><a href="http://i.stack.imgur.com/18QID.jpg" rel="nofollow"><img src="http://i.stack.imgur.com/18QID.jpg" alt="enter image description here"></a></p>
