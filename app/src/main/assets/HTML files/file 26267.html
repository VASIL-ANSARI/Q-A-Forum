<p>Try this:</p>

<pre><code>SELECT *
FROM
(
SELECT 
  id, 
  dt, 
  value, 
  titles.title, 
  group.rank MAX(rank) OVER(PARTITION BY cust.id) AS MAX_RANK
FROM
  tbl_customer AS cust
INNER JOIN tbl_title AS titles
  ON titles.id = cust.id
  AND dt BETWEEN titles.dt_active AND titles.dt_inactive
INNER JOIN tbl_group AS group
  ON group.group = cust.group
WHERE
  titles.title = group.title
) AS RESULTS
WHERE rank = MAX_RANK
</code></pre>

<p>The windowing function <code>MAX(rank) OVER(PARTITION BY cust.id)</code> will get the max rank per id.  Then we filter the rows to only return the row whose rank is that customer's maximum rank.</p>
