<p>You do know that you call <code>allocate_matrix</code> <em>twice</em>? Once in the <code>main</code> function, and again in the <code>parse_into</code> function. The problem with that is that the allocation done in <code>parse_into</code> is only made to the local copy the <code>matrix</code> argument, this change will not be passed out to the calling function.</p>

<p>This will of course lead to a memory leak, as well as the data you read will not be in the matrix you allocated from the <code>main</code> function.</p>

<p>To solve this you either need to pass <code>matrix</code> <em>by reference</em> (or at least emulate it) to <code>parse_into</code>, or come up with another way of passing this new matrix back to <code>main</code>.</p>
