<p>I might be unrelated but, you may need to replace message variable inside the replaced text. Since you declared message variable locally, it will not be available outside.</p>

<p>EDIT:<br>
For your question, you can do that with RegEx but it will be quite hard. If I got time I might work on it a bit.</p>

<p>EDIT 2:<br>
Try this one, it makes sure the Old is not in a tag.</p>

<pre><code>&gt;[^&gt;&lt;]*(Old)[^&lt;&gt;]*&lt;
</code></pre>

<p>EDIT 3:<br>
This works file too, starting > is not necassary</p>

<pre><code>[^&gt;&lt;]*(Old)[^&lt;&gt;]*&lt;
</code></pre>

<p>EDIT 4:  </p>

<pre><code>&lt;html&gt;&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;div id="div1"&gt;&lt;a href="#" title="This is Old"&gt;This is Old&lt;/a&gt;&lt;/div&gt;
  &lt;script&gt; 
    var message = "Hi";
    var str = document.getElementById("div1").innerHTML;
    var newstr = str.replace(/([^&gt;&lt;]*)Old([^&lt;&gt;]*&lt;)/g, "$1&lt;div onclick='say(\""+message+"\");'&gt;New&lt;/div&gt;$2");
    document.getElementById("div1").innerHTML = newstr;
    function say(message)
    {
      alert(message);
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
