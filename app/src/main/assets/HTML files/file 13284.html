<p>First of all bind a command to your undo button.
Write a <a href="http://msdn.microsoft.com/en-us/library/ms752308.aspx" rel="nofollow">CommandBinding</a> similar to this:
<code>&lt;CommandBinding Command="Undo" Executed="ExecuteUndo" CanExecute="CanExecuteUndo"/&gt;</code></p>

<p>Then set the <code>Content</code> of the RichTextBox to something like this</p>

<p><code>{Binding myUndoManager.CurrentContent, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}</code></p>

<p><code>myUndoManager</code> is a DependencyProperty with type of <code>UndoManager</code> class. You need to implement this class and inherit it from <code>DependencyObject</code> and <code>INotifyPropertyChanged</code>. within this class, <code>CurrentContent</code> is a <code>DependencyProperty</code> which keeps the proper content to show and <code>PropertyChanged</code> event handles every changes to the <code>Content</code> of the RichTextBox. <em>(you can add a collection to the class and with each call to this event, add a new item to the collection. the type of the items for this collection might have some properties like TextDifferences, ActionType, ...)</em></p>

<p>Then all that is left is to implement the body of <code>CanExecuteUndo</code> and <code>ExecuteUndo</code> inside your code. <em>(<code>e.CanExecute</code> could be set to true inside the <code>CanExecuteUndo</code>, if and only if the collection is not empty. And <code>ExecuteUndo</code> pops out the last item from the collection and according to its <code>ActionType</code> does the necessary actions)</em></p>

<p>And don't forget to set the <code>DataContext</code> of the window(or RichTextBox) to <code>{Binding RelativeSource={RelativeSource Self}}</code> if <code>myUndoManager</code> object is in the same class as the window.</p>
