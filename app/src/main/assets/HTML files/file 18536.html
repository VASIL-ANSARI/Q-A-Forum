<p>It's because the rename update is looking for a property named <code>'myMetric'</code> to rename and not one named <code>myMetric</code>'s value.  You need to build up your rename object programmatically:</p>

<pre><code>var rename = { 
  'DateTime'    : 'datetime',
  'Port Name'        : 'port_name',
  'Port Number'      : 'port_number',
  'Adaptor ID'       : 'adaptor_id',
  'Processor ID'     : 'processor_id',
  'Processor Type'   : 'processor_type'
};
rename[myMetric] = 'metric';
db[collection].update( { }, { $rename : rename }, false, true );
</code></pre>
