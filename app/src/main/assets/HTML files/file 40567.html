<p>I think you won't get around of introducing some kind of condition to the formula. Something like this:</p>

<pre><code>int getIndex(int x, int y, int z) {
    //First get the amount of points in all layers before this z layer.
    int beforeZ = (z) ? WIDTH*HEIGHT + (z - 1)*2*(WIDTH + HEIGHT - 2) : 0;

    //Then get the amount of points within this layer before this line.
    int beforeY = (y) ? WIDTH + 2*(y - 1) : 0;
    if(z == 0 || z == DEPTH - 1) beforeY = y*WIDTH;

    //And finally the amount of points within this line before this point.
    int beforeX = (x) ? 1 : 0;
    if(z == 0 || z == DEPTH - 1 || y == 0 || y == HEIGHT - 1) beforeX = x;

    //Return the amount of points before this one.
    return beforeZ + beforeY + beforeX;
}
</code></pre>

<p>I admit that this is a bit ugly, but I think it's quite close to the best you can get. At least if you don't want to create some kind of lookup table that matches coordinates to indices and vice versa. Such lookup tables would, of course, be the really big gun that can handle any case, with the drawback of quite significant memory usage and likely slower operation.</p>
