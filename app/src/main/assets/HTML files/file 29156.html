<p>After you extract the substring, you can call <code>strtol()</code> (or <code>std::stoi()</code> if you have C++.11) to convert the string into an integer. Once you have both the year and the line of data, you can store them into some table, perhaps a <code>std::multimap&lt;&gt;</code>.</p>

<p>Without C++.11:</p>

<pre><code>void process (std::istream &amp;in, std::ostream &amp;out) {
    typedef std::multimap&lt;int, std::string&gt; table_type;
    table_type data_by_year;
    std::string str;
    while (std::getline(in,str)) {
        int year = strtol(str.substr(54, 4).c_str(), 0, 10);
        data_by_year.insert(std::make_pair(year, str));
    }
    for (table_type::iterator i = data_by_year.begin();
         i != data_by_year.end();
         ++i) {
        out &lt;&lt; i-&gt;second &lt;&lt; "\n";
    }
}
</code></pre>

<p>In C++.11:</p>

<pre><code>void process (std::istream &amp;in, std::ostream &amp;out) {
    std::multimap&lt;int, std::string&gt; data_by_year;
    std::string str;
    while (std::getline(in,str)) {
        int year = std::stoi(str.substr(54, 4));
        data_by_year.insert(std::make_pair(year, str));
    }
    for (auto v : data_by_year) {
        out &lt;&lt; v.second &lt;&lt; "\n";
    }
}
</code></pre>
