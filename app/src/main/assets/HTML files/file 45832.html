<p>Simple solution? Just <a href="http://en.cppreference.com/w/cpp/thread/thread/detach" rel="nofollow"><code>detach()</code></a> after you start the thread. This will mean that once the thread terminates the resources will be cleaned up and you don't need to keep the <code>std::map&lt;SOCKET, std::thread&gt; threads</code>.</p>

<pre><code>std::thread(clientHandler, client_socket).detach();
</code></pre>

<p>Otherwise create a thread-safe LIFO queue where during cleanup you push the socket to it.</p>

<p>Then in the main loop you alternately check <code>accept</code> and that queue and when the queue has sockets in them you do <code>threads.erase(socket);</code> for each socket in the queue.</p>

<p>However if you do that then you may as well putt he LIFO in the other direction and use a thread pool.</p>
