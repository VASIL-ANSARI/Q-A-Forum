<pre><code>import logging
logging.basicConfig(level=logging.DEBUG, filename='logfile')
# ....
with gzip.GzipFile('/data/data/A.1/{0}_DI.gz'.format(filename), 'wb') as w:
    logging.debug('{} Opened for writing'.format(filename))
    with open(file, 'r') as f:
        logging.debug('{} opened for reading'.format(file))
        for n, line in enumerate(f):
            d = json.loads(line)
            logging.debug('{0} &lt;=== json loaded from {1}'.format(d, line))
            try:
                domain = d['rrname']
                logging.debug('domain: {}'.format(domain))
                ips = d['rdata']
                logging.debug('ips: {}'.format(ips))
                for i in ips:
                    print("%s|%s" % (i, domain), file=w)
            except:
                pass
</code></pre>

<p>Hope that helps...</p>
