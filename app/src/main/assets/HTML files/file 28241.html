<p>Joomla usually does that by default. It seems strange that it doesn't with the approach you have followed.</p>

<p>Although, reading the comments you left, I understand it's not an easy task and you have already built quite a big part of the website, to go back to structure.</p>

<p>If I were you, I would write a small custom module to change the lang=xx or /xx/ in the URL, and redirect the user to the language they want. If you need help on that, feel free to comment below.  </p>

<p>As per your question, I would personally go with simple string manipulation. Since you are really familiar with PHP (taking into consideration that you have written your own custom component), it should be a piece of cake for you, to:</p>

<ul>
<li>Get the current URL</li>
<li>Get the current language tag</li>
<li>Replace the instances of lang=en with lang=de (example languages, you get the point)</li>
<li>Replace the instances of yoursite.com/en/ with yoursite.com/de/</li>
<li>Print the custom links, flags or whatever you are going to use.</li>
</ul>

<p>It's not the suggested scenario, but you can really make a usable module if you also add:</p>

<ul>
<li>An option for the administrator to write the language codes to use (to allow for later additions)</li>
</ul>

<p>And make sure that you get the site name dynamically, and then you may also have a module that could be published in the JED to help others in the same situation like you!</p>
