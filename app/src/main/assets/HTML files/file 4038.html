<p>If you need dynamic filtering, views arguments is your friend.</p>

<p>After you add fields and filters, add an argument Content: node reference (the name would be whatever you chose to name it, but make sure it's node reference). </p>

<p>In the argument setting, for "Action to take if argument is not present" click on provide default argument and choose Node ID from URL, do validation.</p>

<p>Add a block view and enable it on the block settings page. It's only going to show on the appropriate nodes.</p>

<p>Check <a href="http://drupalsn.com/learn-drupal/drupal-tutorials/creating-dynamic-blocks-using-cck-node-reference-and-views-drupal" rel="nofollow">this tutorial</a> for more detail.</p>

<p>To do calculations, take a look at <a href="http://drupal.org/project/views_calc" rel="nofollow">Views Calc</a> module.</p>
