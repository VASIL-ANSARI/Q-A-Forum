<p>It's not at all clear what you expect to get back.  Do you expect the IF to work on a row-by-row basis, or once for the whole query?</p>

<p>In any event, you can <em>probably</em> get what you want with the OUTER JOIN, and then filtering the results with a WHERE clause.</p>
