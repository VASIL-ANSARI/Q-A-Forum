<p>Your observation that <code>gettimeofday</code> switches to kernel mode is incorrect for Linux on a few popular architectures due to the use of vsyscalls. Clearly using <code>gettimeofday</code> here is not a bad option. You should however consider using a monotonic clock, see <code>man 3 clock_gettime</code>. Note that <code>clock_gettime</code> is not yet converted to vsyscall for as many architectures as <code>gettimeofday</code>.</p>

<p>Beyond this option you may be able to set the <code>SO_TIMESTAMP</code> socket option and obtain precise timestamps via <code>recvmsg</code>.</p>
