<p>You're comparing strings because that's what you stored in <code>$product["price"]</code> and <code>$product["a_price"]</code> (the function <code>number_format()</code> returns a string value). For numbers <code>&gt;= 1000</code>, those strings include commas, which breaks the comparison.</p>

<p>Compare the numeric values and don't call <code>number_format()</code> until you need to display the values.</p>
