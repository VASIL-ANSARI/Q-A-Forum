<pre><code>#define NTDDI_VERSION 0x06000000 
</code></pre>

<p>That is Vista.</p>

<pre><code>#define _WIN32_WINNT 0x0502 
</code></pre>

<p>That is Server 2003.</p>

<p>And so these versions are indeed conflicting. If you want to support Vista and up you'll need:</p>

<pre><code>#define NTDDI_VERSION 0x06000000 
#define _WIN32_WINNT 0x0600 
</code></pre>

<p>If you want Server 2003 and up then you use:</p>

<pre><code>#define NTDDI_VERSION 0x05020000
#define _WIN32_WINNT 0x0502 
</code></pre>

<p>Note that the <code>NTDDI_VERSION</code> define can also specify service packs. So if you want Vista SP1 and up then you use:</p>

<pre><code>#define NTDDI_VERSION 0x06000100 
#define _WIN32_WINNT 0x0600 
</code></pre>

<p>As a general rule you want to set these defines to the value corresponding to the minimum version that you wish to support.</p>

<p>Rather than using these magic constants, you should write, for example:</p>

<pre><code>#define NTDDI_VERSION NTDDI_VISTA 
#define _WIN32_WINNT _WIN32_WINNT_VISTA 
</code></pre>

<p>For more details refer to MSDN: <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383745.aspx">Using the Windows Headers</a>.</p>
