<p><code>cd</code> should not be invoked through a child process, the shell itself should change its current directory (that's the property of an internal command: modify the process of the shell itself).</p>

<p>A (primitve) shell should looks like:</p>

<pre><code>for(;;) {
    printf("bash: ");
    parse();

    // realize internal commands (here "cd")
    if (!strcmp(line[0], "cd")) {
       if (!line[1]) (void) chdir(getenv("HOME"));
       else (void) chdir(line[1]);
       continue; // jump back to read another command
    }

    // realize external commands
    pid_t pid = fork()
    if (pid == 0) {
        execvp(line[0], line);
        exit(EXIT_FAILURE); // wrong exec
    }

    // synchro on child
    if (pid &gt; 0) {
        while (pid == wait(NULL));
        printf("%d terminated.\n", pid);
    }
}
</code></pre>
