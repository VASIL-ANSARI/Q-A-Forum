<p>You have</p>

<pre><code>typeof document.getElementById("sub_total_" + i) != "undefined"
</code></pre>

<p>and</p>

<pre><code>if (obj_sub_total != "undefined") {
</code></pre>

<p><code>getElementById</code> returns either <code>null</code> or an HTML element. Neither of these are the string <code>"undefined"</code> and the type of each of this will be <code>"object"</code>. Thus your conditions don't make sense.</p>

<p>You test for truthfulness instead. An HTML element will always be true and <code>null</code> will always be false.</p>

<pre><code>while (document.getElementById("sub_total_" + i)) {
</code></pre>

<p>and</p>

<pre><code>if (obj_sub_total) {
</code></pre>
