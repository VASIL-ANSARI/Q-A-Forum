<p>This should work</p>

<pre><code>SELECT A.LABEL, B.LABEL FROM TABLE A
 JOIN TABLE B ON
    CASE WHEN LEN(RIGHT(A.LABEL, CHARINDEX('-', reverse(A.LABEL))-1)) = 1
THEN
    STUFF(A.LABEL, LEN(A.LABEL) - CHARINDEX('-', reverse(A.LABEL))+1, 1, '-100') 
ELSE
    STUFF(A.LABEL, LEN(A.LABEL) - CHARINDEX('-', reverse(A.LABEL))+1, 1, '-10')
END = B.LABEL
</code></pre>

<p>So basically we find the last position of a <code>-</code> character in the string by reversing the string:</p>

<pre><code>CHARINDEX('-', reverse(A.LABEL)
</code></pre>

<p>Then we insert either a 10 or a 100 at that point to compare with the other labels.</p>
