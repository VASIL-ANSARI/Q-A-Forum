<p>You have following code and i think error must be in second simply remove the second line its better to remove or comment second line</p>

<pre class="lang-html prettyprint-override"><code>$headers = array ('From' =&gt; $aymail,'To' =&gt; $recipent,'Subject' =&gt; $subject);
$headers = "From: {$ayname}&lt;{$aymail}&gt;\r\n" . "MIME-Version: 1.0\r\n" ....
</code></pre>



<pre class="lang-html prettyprint-override"><code>$headers = array ('From' =&gt; $from,
  'To' =&gt; $to,
  'Subject' =&gt; $subject);

  $message = new Mail_mime($crlf);

    $message-&gt;setTXTBody($body);
    $message-&gt;setHTMLBody($body_html);
    $body = $message-&gt;get();
    $headers = $message-&gt;headers($headers);
    $smtp = Mail::factory('smtp',
    array ('host' =&gt; $host,
   'auth' =&gt; true,
   'port' =&gt; xxx,
  'username' =&gt; $username,
  'password' =&gt; $password));

    $mail = $smtp-&gt;send($to, $headers, $body);
</code></pre>



<p>Complete Working Function dont forget to include Mail file</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>function doEmail($to, $message $subject, $name){



$from = "Administrator &lt;admin@xyz.com&gt;";
$reply_email = "bounce@xyz.com";
$to = "$name &lt;$to&gt;";
$subject = $subject;

$body = strip_tags($m);
$body_html = $m;
$crlf = "\n";
$host = "localhost";
$username = "";
$password = "";
$headers = array ('From' =&gt; $from,
  'To' =&gt; $to,
  'Subject' =&gt; $subject,
  'Reply-To' =&gt; $reply_email,
  'Return-path' =&gt; $reply_email,
  'Content-Type' =&gt; "text/html; charset=utf-8");
  
  $message = new Mail_mime($crlf);

    $message-&gt;setTXTBody($body);
    $message-&gt;setHTMLBody($body_html);
    $body = $message-&gt;get();
    $headers = $message-&gt;headers($headers);  
  
$smtp = Mail::factory('smtp',
  array ('host' =&gt; $host,
    'auth' =&gt; false,
    'username' =&gt; '',
    'password' =&gt; ''));

		$mail = $smtp-&gt;send($to, $headers, $body);

		if (PEAR::isError($mail)) {
		
		} else {
		
		}

}</code></pre>
</div>
</div>
</p>
