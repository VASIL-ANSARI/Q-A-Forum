<p><code>preg_</code> is not deprecated. It is just <code>/e</code> (as of PHP 5.5):</p>

<blockquote>
  <p>The /e modifier is deprecated. Use <a href="http://www.php.net/manual/en/function.preg-replace-callback.php" rel="nofollow">preg_replace_callback()</a> instead.
  See the <a href="http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php#reference.pcre.pattern.modifiers.eval" rel="nofollow">PREG_REPLACE_EVAL</a> documentation for additional information
  about security risks.</p>
</blockquote>

<p>and as <code>preg_replace_callback()</code> is almost identical to <code>preg_replace()</code> with exception that it uses callback instead of replacement, update of your code should be quick homework.</p>
