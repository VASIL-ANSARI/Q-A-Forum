<p>Is your data stored in an mxn matrix? Where m is the dimension of the data and n are the total number of cases? If that's not the case, you should resize your data. For instance if your images are of size 28x28 and you have only one image, you should have a 1x784 vector. You could use this function:</p>

<pre><code>import numpy as np

def flatten_matrix(matrix):
    vector = matrix.flatten(1)
    vector = vector.reshape(1, len(vector))
    return vector
</code></pre>

<p>Then you apply ZCA Whitening to your training set using:</p>

<pre><code>def zca_whitening(inputs):
    sigma = np.dot(inputs, inputs.T)/inputs.shape[1] #Correlation matrix
    U,S,V = np.linalg.svd(sigma) #Singular Value Decomposition
    epsilon = 0.1                #Whitening constant, it prevents division by zero
    ZCAMatrix = np.dot(np.dot(U, np.diag(1.0/np.sqrt(np.diag(S) + epsilon))), U.T)                     #ZCA Whitening matrix
    return np.dot(ZCAMatrix, inputs)   #Data whitening
</code></pre>

<p>It is important to save the <code>ZCAMatrix</code> matrix, you should multiply your test cases if you want to predict after training the Neural Net.</p>

<p>Finally, I invite you to take the Stanford UFLDL Tutorials at <a href="http://ufldl.stanford.edu/wiki/index.php/UFLDL_Tutorial">http://ufldl.stanford.edu/wiki/index.php/UFLDL_Tutorial</a> or <a href="http://ufldl.stanford.edu/tutorial/">http://ufldl.stanford.edu/tutorial/</a> . They have pretty good explanations and also some programming exercises on MATLAB, however, almost all the functions found on MATLAB are on Numpy by the same name. I hope this may give an insight.</p>
