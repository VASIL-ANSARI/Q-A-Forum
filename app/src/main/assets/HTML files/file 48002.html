<p>Please try this query </p>

<pre><code>DECLARE @MyTable AS TABLE 
(productName varchar(13), test1  int,test2  int)


INSERT INTO @MyTable
    (productName, test1,test2)
VALUES
    ('a', 1,1),
    ('a', 2,2),
    ('a', 3,3),
    ('b', 1,4),
    ('b', 2,5),
    ('b', 3,6),
    ('a', 1,7),
    ('a', 4,8),
    ('a', 5,9)
;
SELECT productname,MAX(test1) 
from @MyTable 
where test1 = test2
group BY productname
union all
SELECT productname,MAX(test1) 
from @MyTable 
where test1 != test2
group BY productname
</code></pre>
