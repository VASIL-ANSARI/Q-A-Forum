<p>You're using <code>transf_date = datetime.datetime.strptime(opt["Expiry"][1],'%b %d, %Y')</code> instead of <code>transf_date = datetime.datetime.strptime(opt["Expiry"][i],'%b %d, %Y')</code>, meaning that even though you're iterating over the entire <code>opt["Expiry"]</code>, you're always processing the same entry.</p>
