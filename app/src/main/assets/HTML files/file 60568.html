<p><strong>*1).htaccess file</strong></p>

<p>The visitor blocking facilities offered by the Apache Web Server enable us to deny access to specific visitors, or allow access to specific visitors. This is extremely useful for blocking unwanted visitors, or to only allow the web site owner access to certain sections of the web site, such as an administration* </p>

<pre><code>ErrorDocument 403 /specific_page.html
area.*
order allow,deny
deny from 255.0.0.0
deny from 123.45.6.
allow from all
</code></pre>

<p>When using the "Order Allow,Deny" directive the requests must match either Allow or Deny, if neither is met, the request is denied.</p>

<p>doc 1)<a href="http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html#order" rel="nofollow">http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html#order</a></p>

<p>doc 2)<a href="http://www.htaccess-guide.com/deny-visitors-by-ip-address/" rel="nofollow">http://www.htaccess-guide.com/deny-visitors-by-ip-address/</a></p>

<p><strong>2) Proof of Concept (can't say this works as is....)</strong></p>

<pre><code>$current_ip = $_SERVER['REMOTE_ADDR'];

 $valid_ip = false;

 // Convert IPs to Regex
 foreach($cfg['ipallowed'] as $index=&gt;$ip);
 {
    $ip = str_replace('.', '\\.', $ip);
    $ip = str_replace('*', '[0-9]|^1?\\d\\d$|2[0-4]\\d|25[0-5]');
    if (preg_match($ip, $current_ip)
    {
      $valid_up = true;
      break;
    }
 }

 if ($valid_ip)
</code></pre>
