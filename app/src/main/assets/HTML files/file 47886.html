<p>I not sure about everything else going on but for the case statement I think this should work for you</p>

<pre><code>SUM(CASE WHEN [PC].[ProductCategoryCode] = 5780 OR [PC].[ProductCategoryCode] &lt; 5700 THEN [PL].[OriginalQuantity_Stk] ELSE 0 END) / @Credits * [ICP].[UnitCost] 
</code></pre>
