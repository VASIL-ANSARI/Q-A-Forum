<p>You can differentiate between the file and directory node by giving them specific name  using TreeNode.Name property. In the COntextMenuStrip.Opening event, you can then enable or disable the menu items based on the node name.</p>

<pre><code>TreeNode tn = treeView1.GetNodeAt( e.X, e.Y );

if( tn != null )
{
  if( tn.Name == "FileName") {

  }
}
</code></pre>
