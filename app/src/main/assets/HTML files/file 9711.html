<pre><code>Where i1.Code = Case
                    When Substring( i2.Code, 1, 1) = 'S' 
                        Then 'U' + Substring( i2.Code, 2, Len( i2.Code ) )
                    Else i2.Code
                    End
</code></pre>

<p>Another alternative:</p>

<pre><code>Where i1.Code = Case
                    When i2.Code Like 'S%'
                        Then 'U' + Substring( i2.Code, 2, Len( i2.Code ) )
                    Else i2.Code
                    End
</code></pre>

<p>As ErikE suggested, you can also replace <code>Len(i2.Code)</code>, with an arbitrarily large static value which might make a small speed improvement.</p>
