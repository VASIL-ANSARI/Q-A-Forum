<p>The problem is that the UDF you pass to <code>mapPartitions</code> has to have a return type of <code>Iterator[U]</code>. Your current code does not return anything and thus is of type <code>Unit</code>.</p>

<p>If you want to obtain an empty <code>RDD</code> after performing the <code>mapPartitions</code> then you can do the following:</p>

<pre class="lang-scala prettyprint-override"><code>def showParts(iter: Iterator[(Long, Array[String])]) = 
{ 
  while (iter.hasNext)
  {
    val cur = iter.next;
    // Do something with cur
  }

  // return Iterator[U]
  Iterator.empty 
}
</code></pre>
