<pre><code>    -(void) viewDidAppear:(BOOL)animated{
        picker = [[UIImagePickerController alloc] init];
        picker.sourceType = UIImagePickerControllerSourceTypeCamera;
        picker.delegate = self;
        picker.showsCameraControls = NO;
        picker.navigationBarHidden = YES;
        picker.toolbarHidden = YES;
        picker.wantsFullScreenLayout =YES;
        picker.cameraOverlayView = overlayView;
        [self presentModalViewController:picker animated:NO];
        [self.view bringSubviewToFront:overlayView];
        [picker release];

    }

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    UIImage *image = [info valueForKey:UIImagePickerControllerOriginalImage];
    NSData* imageData = UIImageJPEGRepresentation(image, 0.1);
    NSArray* paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString* documentsDirectory = [paths objectAtIndex:0];
    NSString* fullPathToFile = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"Image%i.jpg",i]];
    [imageData writeToFile:fullPathToFile atomically:NO];
    i++;
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker1 {
    [picker1 dismissModalViewControllerAnimated:NO];
    overlayView.hidden = YES;
}

-(void) takepicture:(id) sender{
    [self.picker takePicture];
}
</code></pre>
