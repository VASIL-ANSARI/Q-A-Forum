<blockquote>
  <p>The error reported by the proccessor is: <em>An attribute node (name)
  cannot be created after the children of the containing element</em>.</p>
</blockquote>

<p>This is not a "casting error". What it says is that you are trying to create an attribute after some children have already been created. </p>

<p>AFAICT, it happens here:</p>

<pre><code>&lt;xsl:template match="test-case"&gt;
    &lt;test-case name="{concat('test-case-', string(position()))}"&gt;

        &lt;!--here child nodes are being created!!! ~--&gt;

        &lt;xsl:apply-templates select="@*|node()"/&gt;
    &lt;/test-case&gt;
&lt;/xsl:template&gt;
</code></pre>

<p>If you change (line #35):</p>

<pre><code>&lt;xsl:apply-templates select="@*|node()"/&gt;
</code></pre>

<p>to:</p>

<pre><code>&lt;xsl:apply-templates select="node()"/&gt;
</code></pre>

<p>the error will go away, because now it will stop trying to copy the existing attributes. You would not want this to happen anyway, since it would overwrite the <code>name</code> attribute you have created yourself.</p>

<p><strong>Caveat</strong>:<br>
I have not examined your stylesheet in-depth.</p>
