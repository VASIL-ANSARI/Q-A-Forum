<p>Is there something in your code you have truncated which converts all that HTML to an MS Word file?</p>

<p>Because... er... you know saving an HTML file with a <code>.doc</code> extension doesn't actually make it a Word file, right?</p>

<p>If you've got HTML, just serve it as HTML, and the user can take care of saving images using the browser's own âSave web page with imagesâ feature. Or you could write an MHTML file if you like, including the images inside it.</p>

<p>But HTML-file-hiding-under-DOC-file-extension isn't really a valid format. It's something you shouldn't rely on if Word manages to load/import the thing at all; asking for it to drag in images as well is asking for the moon on a stick.</p>

<p>Yes, <code>meta</code> is the only way to set charset when you're supplying an HTML file that you expect people to save. The <code>Content-Type</code> header is normally a good place to put it as well, but that information will be lost as soon as the file is saved on a filesystem that doesn't support saving type metadata (which is, currently, all popular filesystems).</p>

<p>Incidentally, non-ASCII characters like <code>Ã©</code> are totally unreliable to include in a <code>filename</code> header parameter. They get treated as different encodings depending on the browser (and for IE, also the locale) and there's no standard way of escaping them. The only reliable way to put non-ASCII characters in the filename of a downloaded file is to leave them as trailing URL parts, encoded as UTF-8. eg.:</p>

<pre><code>http://www.example.com/download.php/Contrat%20d%27%C3%A9tude.doc
</code></pre>
