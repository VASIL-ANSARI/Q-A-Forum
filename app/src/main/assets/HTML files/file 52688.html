<p>The code you provide isn't very clear to tell the source of the problem, so I will provide you with a full snippet where you can take better conclusions.</p>

<p>In this case, I sent an array from JavaScript to my PHP file using a formdata under the name "documents". I also modify the name of the file so it becomes: "filename_optional_$i(int)".</p>

<pre><code>for($i=0; $i&lt;count($_FILES['documents']['name']); $i++){
    list($dump, $extention) = explode(".", (string)$_FILES['documents']['name'][$i]);
    $document_name = $file_name.'_optionnel'.$i;
    if(($_FILES['documents']['size'][$i] &lt; 500000)){
        if ($_FILES['documents']["error"][$i] &gt; 0){
            echo 'Erreur.';
        }else{
            if(file_exists( $directory_path . $document_name . "." . $extention)) {
                echo 'Le fichier existe dÃ©jÃ .';
            }else{
                $sourcePath = $_FILES['documents']['tmp_name'][$i];
                $targetPath = $directory_path . $file_name ."/". $document_name . "." . $extention;
                array_push($attachments, $targetPath);
                move_uploaded_file($sourcePath, $targetPath);
            }
        }
    }else{
        echo 'Le fichier est trop grand.';
    }
}
</code></pre>

<p>Make sure your path variables are pointing to the correct folder. Say, for instance, if you want your file to go to the foldier images, you have to do:</p>

<p><strong>path_to_folder/images/</strong> and not <strong>path_to_folder/images</strong></p>

<p>EDIT:</p>

<p>Here's how your filename and directory path variables should look like:</p>

<pre><code>/*$nom, $prenom and $user_id come from database values*/
$file_name = $nom."_".$prenom."_".$user_id;

$directory_path = dirname( __FILE__ ) . '/user_docs/';

/* Create mask */ 
$oldmask = umask(0);

/* Create the folder for user */
$directory = mkdir($directory_path.$file_name, 0777);

/* redo the mask */
umask($oldmask);
</code></pre>

<p>I'm quite new to this site, but the least I can do for you is offer you this code I've done to help you out. I've written some comments to guide you through.</p>

<p><a href="http://puu.sh/npJRH/0bc738eccf.zip" rel="nofollow">Full code source for upload</a></p>
