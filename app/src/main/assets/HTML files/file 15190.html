<p>You can use something like the following:</p>

<pre><code>List&lt;string&gt; LdapUsers = new List&lt;string&gt;();

if (String.IsNullOrWhiteSpace(domain))
{
    string username = WindowsIdentity.GetCurrent().Name;
    domain = username.Substring(0, username.IndexOf("\\"));
}

PrincipalContext context;
if (!String.IsNullOrWhiteSpace(user) &amp;&amp; !String.IsNullOrWhiteSpace(password) &amp;&amp; !String.IsNullOrWhiteSpace(domain))
    context = new PrincipalContext(ContextType.Domain, domain, user, password);
if (!String.IsNullOrWhiteSpace(domain))
    context = new PrincipalContext(ContextType.Domain, domain);
else
    context = new PrincipalContext(ContextType.Domain);
UserPrincipal userP = new UserPrincipal(context);
userP.Enabled = true;
PrincipalSearcher pS = new PrincipalSearcher();
pS.QueryFilter = userP;

PrincipalSearchResult&lt;Principal&gt; result = pS.FindAll();
foreach (Principal p in result)
    LdapUsers.Add(domain + "\\" + p.SamAccountName);
</code></pre>
