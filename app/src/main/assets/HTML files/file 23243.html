<p>I never did something exactly like <em>this</em>, but I was intrigued enough to look. Your friends are the <code>SymXxx</code> functions, within <em>dbghelp.dll</em>.</p>

<p>Start with <code>SymSetOptions</code> followed by <code>SymInitialize</code>.
Then, the function that does the heavy lifting of the work is <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms680726%28v=vs.85%29.aspx" rel="nofollow">SymFindFileInPath</a>. The second arguments (SearchPath) is a semicolon-separated search path, that may include <code>SRV*</code>.</p>

<p>The utility that does exactly what you want (pretty much, with nothing less and nothing more) is symchk.exe. Take a look at its imports table, notice it uses no more than 9 functions from dbghelp (and no 'networking' DLL such as winhttp or the like) - so that should give you a good clue how to proceed, and which methods you should use.</p>
