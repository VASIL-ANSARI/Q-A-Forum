<p>I don't think Ruby has a built-in elegant way of doing this. You can treat your hash as a bunch of bins, where the number of occurrences of each number is the bin size. Then you can calculate the total bin width, get a random sample, and iterate to find out which bin the sample lands in.</p>

<pre><code>def weighted_sample h
  weight = h.values.reduce(:+)
  sample = rand weight
  h.each do |n, w|
    return n if sample &lt; w
    sample -= w
  end
end

Array.new(10) { weighted_sample({1 =&gt; 8, 2 =&gt; 4, 3 =&gt; 2}) }
# [2, 2, 1, 1, 1, 3, 1, 1, 1, 1]
</code></pre>

<p><strong>Tip:</strong> there's a much nicer way to build that hash</p>

<pre><code>h = Hash.new 0
# ...
h[w] += 1
</code></pre>
