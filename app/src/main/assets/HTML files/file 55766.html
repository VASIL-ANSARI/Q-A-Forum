<p>What is happening here?</p>

<pre><code>public Connection getConnection() throws SQLException {
    logger.info("Creating connection to DB!");
    return this.cpds.getConnection();
}
</code></pre>

<p>Namely, what does cpds.getConnection() do?  When you call:</p>

<pre><code>connection = DataBaseManager.getInstance().getConnection();
</code></pre>

<p>Your connection object is a member of what's supposed to be a singleton class here but every call to writeData() overwrites it it with a new getConnection() call.  Is the getConnection() call thread unsafe as well?  </p>

<p>Also, why is the connection object declared as a class member and then overwritten each time writeData() is called?  In a multi-threaded environment, the code as it exists allows for the connection object to be overwritten by another getConnection() call immediately before prepareStatement() is called, since access to writeData() is not locked.  Same for preparedStatement.  Move those into the writeData() method.</p>
