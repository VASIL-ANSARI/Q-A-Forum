<p>First of all it is a wrong approach to take something way too powerful and limiting it in order to secure it. Famously Java is failing on that many years on their browser plugin. Instead, if you want to have really secure solution I would suggest writing your own tiny templating engine that only will have functionality you need to provide to your users. In that case there will be no way for exploitation for bad guys.</p>
