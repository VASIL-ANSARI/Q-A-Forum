<p>A fix (<em>somewhat</em>) in .Net 4.6 is actually quite simple:</p>

<pre class="lang-c# prettyprint-override"><code>var rsa = (RSACng)clientCertificate.GetRSAPrivateKey();
rsa.Key.ParentWindowHandle = MyForm.Handle;

rsa.SignHash(new byte[20], HashAlgorithmName.SHA1, RSASignaturePadding.Pkcs1);
</code></pre>

<p>(I've actually been looking at this problem since .Net 4.0 and who knew .Net 4.6 would make it so easy!)</p>

<p>Note, this is only <em>somewhat</em> of a fix because it doesn't directly solve the problem for UIs shown by <code>SslStream.AuthenticateAsClient()</code>.  However, by performing the above <em>before</em> <code>SslStream.AuthenticateAsClient()</code>, CNG caches the user's grant and the dialog is not shown during the TLS/SSL handshake.</p>

<p>(This is why the solution needs to be CNG based instead of the older CAPI.)</p>

<p>The retention of this cache is configured via group policy, so this may not work in every environment.</p>

<p>Unfortunately, I still need to support .Net 4.5, so a solution there would be greatly appreciated</p>
