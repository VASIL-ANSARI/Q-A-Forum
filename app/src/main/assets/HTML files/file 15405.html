<p>Well, you don't need to reinvent the wheel. Most of the features mentioned above, are supported in most ESBs. 
Here is a complete use cases where pub-sub is implemented using WSO2 ESB[1]. </p>

<p>FYI : WSO2 ESB is a 100% Open Source ESB with Apache 2.0 license. </p>

<p>[1] <a href="http://wso2.org/library/articles/2011/12/wso2-esb-example-pubsub-soa" rel="nofollow">http://wso2.org/library/articles/2011/12/wso2-esb-example-pubsub-soa</a></p>
