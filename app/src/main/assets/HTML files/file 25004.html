<p>I've tried your code on my local env and worked fine. I've tried insert this query first:</p>

<pre><code>INSERT INTO `test`.`reset`
    (`id`,`identity_id`,`hash`,`timestamp`,`upn`,`returnurl`,`processed`,`referer`)
VALUES
    (
    null, 1, '4d9acbacc6ed7dc2733025e4b8af7be4940fe5b70338789b34caea27695860fa2b497f6cd34851657c9d3e8e8e88713d80da1a22d8654cf98622e9af3f29481t',
    null, 'a', null, null, null
    );
</code></pre>

<p>Which worked fine. Then I've tried insert the same query and got the same error as you:</p>

<pre><code>Error Code: 1062. Duplicate entry '4d9acbacc6ed7dc2733025e4b8af7be4940fe5b70338789b34caea27695860fa' for key 'hash_UNIQUE'
</code></pre>

<p>Ok, here I've changed just the last character on the hash (b instead t) and then it worked fine:</p>

<pre><code>INSERT INTO `test`.`reset`
    (`id`,`identity_id`,`hash`,`timestamp`,`upn`,`returnurl`,`processed`,`referer`)
VALUES
    (
    null, 1, '4d9acbacc6ed7dc2733025e4b8af7be4940fe5b70338789b34caea27695860fa2b497f6cd34851657c9d3e8e8e88713d80da1a22d8654cf98622e9af3f29481b',
    null, 'a', null, null, null
    );
</code></pre>

<p>Which means MySQL is using the full value for the UNIQUE index, even if it shows to you just part of your hash on the error report. </p>

<p>I could not find the reason why mysql does not show the whole string, however I believe your issue is definitely not related with a partial index use by the parser. Let me know how you go.</p>
