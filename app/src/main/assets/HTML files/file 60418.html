<p>The progress bar initializes after the load happened. In fact, the load happens on the server before aything is sent to the browser. I would solve the problem as follows:</p>

<ol>
<li><p>I would modify my code to make sure that the slow part of the code does not execute on the server before it responds to the browser and the slow part can be reached via POST requests.</p></li>
<li><p>I would have a loaded event in the browser, where I would initialize the progress bar.</p></li>
<li><p>After the progress bar is initialized, I would send a separate AJAX code for each subtask of the slow task (yes, I would partition the slow task if possible).</p></li>
<li><p>These async AJAX requests would have a callback which would refresh the progress bar's status according to the current situation. The last callback would close the door (finish the progress bar's life-cycle).</p></li>
</ol>
