<p>I would say</p>

<pre><code>IdleTime = System.Environment.TickCount - LastInput.dwTime;
int hours = IdleTime / 3600000;
int minutes = IdleTime / 60000 - hour * 60;
int seconds = IdleTime / 1000 - min * 60;
</code></pre>

<p>I'm not sure why you substract 500 from <code>IdleTime</code>.</p>
