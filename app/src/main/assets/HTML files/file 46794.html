<p>You can use the following query:</p>

<pre><code>SELECT m.*,       
       CASE trx 
          WHEN mintrx THEN 'post'
          WHEN maxtrx THEN 'pre'
          ELSE 'pre'
       END AS type
FROM mytable AS m
LEFT JOIN (
   SELECT column1, column2, MIN(trx) AS mintrx, MAX(trx) AS maxtrx
   FROM mytable
   GROUP BY column1, column2
   HAVING MIN(trx) &lt;&gt; MAX(trx) ) AS t
ON m.column1 = t.column1 AND m.column2 = t.column2
</code></pre>

<p>This query performs a <code>LEFT JOIN</code> with a derived table containing only duplicate <code>column1</code>, <code>column2</code> rows. Minimum / maximum <code>trx</code> matches produce <code>post</code> / <code>pre</code> values respectively, whereas <code>pre</code> is the default value for non-matched table rows.</p>

<p><a href="http://sqlfiddle.com/#!9/abf72/3" rel="nofollow"><strong>Demo here</strong></a></p>
