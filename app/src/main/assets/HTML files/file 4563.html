<p>This will return a list of all movies that share at least 1 tag with the given <code>&lt;current_movie_id&gt;</code> ordered by decreasing number of tags in common</p>

<pre><code>SELECT movie.*, count(DISTINCT similar.tag) as shared_tags FROM movie INNER JOIN 
    ( tagged AS this_movie INNER JOIN tagged AS similar USING (tag) )
    ON similar.movie = movie.id
WHERE this_movie.movie=&lt;current_movie_id&gt;
AND   movie.id != this_movie.movie
GROUP BY movie.id
ORDER BY shared_tags DESC
</code></pre>

<p>hope that gives you something to work with</p>
