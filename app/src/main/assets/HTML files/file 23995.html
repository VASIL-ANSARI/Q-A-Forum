<p>it's not really that hard. your code has to perform the folloging steps:</p>

<ol>
<li>choose a preferred row-height. this seems to be around <code>500px</code> on flickr. you can set a fixed value or choose a setting based on the clients screen resolution</li>
<li>get the available total width</li>
<li>start a new row </li>
<li>put in a photo and scale it to row-height and check your row-width</li>
<li>repeat <em>4.</em> until adding a photo makes your row-width exeed the total width</li>
<li>scale down the height of this row (and the contained photos) until the width fits</li>
<li>start the next line (see <em>3.</em>)</li>
</ol>
