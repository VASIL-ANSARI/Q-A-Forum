<p>Try removing the</p>

<pre><code>dataGridView1.EndEdit();
</code></pre>

<p>this is used if a cell is being edited so the fact that it's only working when you edit a cell could be caused because of that line.</p>
