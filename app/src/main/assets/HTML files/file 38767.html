<p>To receive the data you should just be able to call <code>pDataObject-&gt;GetData()</code> with the IDs for <code>CFSTR_FILEDESCRIPTOR</code> and <code>CFSTR_FILECONTENTS</code> (you need to call <code>RegisterClipboardFormat()</code> to get the IDs).</p>

<p>That will fill out your <code>STGMEDIUM</code> structure with the values required to get the virtual data, which might be provided as an <code>IStream</code> but could just as easily be provided as an <code>HGLOBAL</code> etc.</p>

<p>After you have finished with the data, call <code>ReleaseStgMedium()</code> function to release the <code>STGMEDIUM</code> data.</p>

<p>This is documented on MSDN:</p>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb776904.aspx" rel="nofollow">Handling Shell Data Transfer Scenarios</a></p>

<p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb776904.aspx#filecontents" rel="nofollow">Using the CFSTR_FILECONTENTS Format to Extract Data from a File</a></p>
