<p>Fir of all, there're  2 types of C++ projects in VS:</p>

<ol>
<li>Native C++ project, without /clr option by default.</li>
<li>C++/CLI project, with /clr option by default. C++/CLI can access both native and managed world, so if you want use a C# DLL, just add this DLL as a reference and use it directly, you don't need COM for this case.</li>
</ol>

<p>If the native C++ project wants to use C# DLL, one way is via COM, another way is use C++CLI project as a bridge.</p>

<p>If you use COM, then you have to deal with the SAFEARRAY, which is error prone. As to your question 1, you're using SAFEARRAY as an out parameter, this is complex. I suggest you just change the definition of function fillTheArrayWithSquares to:</p>

<pre><code>public int[] fillTheArrayWithSquares( )
</code></pre>

<p>So it will return a SAFEARRAY to C++ code, and the lengh of SAFEARRAY is already contained in the SAFEARRAY.</p>
