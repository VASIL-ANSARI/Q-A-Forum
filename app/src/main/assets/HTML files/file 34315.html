<p>A few issues with this code. The reason you're only getting the last result is because of this line:</p>

<pre><code>fWriter = new FileWriter("Exports/Transfers/" + /* frmNm.replace(":", "_") */"EBW_" + GtDates.fdate + ".csv", false);
</code></pre>

<p>This line is inside your loop. The <code>false</code> as the last parameter tells <code>FileWriter</code> not to append. In other words, a <code>false</code> means overwrite the file if it exists. Since this is in your loop, each result overwrites the file that the last result created. You should create the <code>FileWriter</code> outside of your loop, probably in a try with resources. That will allow you to remove your <code>writer.close()</code> call, which should have been in a <code>finally</code> block anyway.</p>

<p>Not related to your original question but something you should be aware of: You're creating a new <code>Statement</code> with each loop iteration. This can be an expensive operation. You should use a <a href="http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html" rel="nofollow"><code>PreparedStatement</code></a> instead. Create it outside your loop and then just set the parameter and execute it inside the loop. It also implements <code>AutoCloseable</code>, so you can create it in a try with resources too, probably the same one you create your <code>FileWriter</code> in.</p>
