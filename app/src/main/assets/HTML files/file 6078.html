<p>from the MSDN article on <a href="http://msdn.microsoft.com/en-us/library/aa924825.aspx" rel="nofollow">Time and Clocks in DirectShow</a>:</p>

<blockquote>
  <p>Any object that supports the IReferenceClock interface can serve as a reference clock. A filter with access to a hardware timer can provide a clock (an example is the audio renderer), or the filter graph manager can create one that uses the system time.</p>
</blockquote>

<p>I've never attempted to use the IReferenceClock from a filter, but it would be my suspicion that it may not provide a high resolution clock that you need.</p>

<p>This <a href="http://stackoverflow.com/questions/1487695/c-cross-platform-high-resolution-timer">SO post on high resolution timers</a> might be what you need.</p>

<p>IAMStreamConfig.AvgTimePerFrame is for informational purposes, and attempting to adjust it won't have any effect.  It's just a value from which you can calculate average frame rate for your video stream.</p>

<p>e.g.</p>

<pre><code>VIDEOINFOHEADER* pVih = (VIDEOINFOHEADER*)m_MediaTypes.VideoType.pbFormat;

if( pVih )  
    int nFrameRate = (int)( (double) (10000000.0f / pVih-&gt;AvgTimePerFrame) );   
</code></pre>
