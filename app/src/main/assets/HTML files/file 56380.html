<p>The size of <code>M</code> is wrong.</p>

<p><code>Size</code> expects <code>(width, height)</code>, not <code>(rows, cols)</code>. So you need to create <code>size</code> as:</p>

<pre><code>Size size = new Size(cols,rows);
Mat M = new Mat(size, CvType.CV_32F);
</code></pre>

<p>Or you can create <code>M</code> as:</p>

<pre><code>Mat M = new Mat(rows, cols, CvType.CV_32F);
</code></pre>
