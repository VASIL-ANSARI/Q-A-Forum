<p>According to the thrown exception, new Tasks are rejected because the executor is currently in (or has been) shutdown. </p>

<p>The code doesnt seem to wait until the queued tasks finished, e.g. by waiting on the Future returned by ExecutorService#submit. Although some type of Condition signalling seems to be used (not enough code shown...), the mechanism is not clear and probably faulty.</p>
