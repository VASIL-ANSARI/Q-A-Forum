<p>You say that persisting works, probably you see your data in db. But do you see all the data, weren't there failures? Your code doesn't handle transaction rollbacks, that might be the reason you see connection in 'Idle in transaction' state.</p>

<p>If an exception is thrown by <code>throw getDbException(e)</code>, the transaction is not rolled back.</p>
