<p>You are going to have this problem any time a user types.in a period with no spaces around it. You could add in some login to test for valid TLDs, but even that would not be perfect because there are plenty of TLDs that would fool the logic, like .it.</p>

<p>If you want to try your hand at fixing the regular expression, the pattern that determines if a string is a URL is here -</p>

<pre><code>$pattern = "@\b(https?://)?(([0-9a-zA-Z_!~*'().&amp;=+$%-]+:)?[0-9a-zA-Z_!~*'().&amp;=+$%-]+\@)?(([0-9]{1,3}\.){3}[0-9]{1,3}|([0-9a-zA-Z_!~*'()-]+\.)*([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\.[a-zA-Z]{2,6})(:[0-9]{1,4})?((/[0-9a-zA-Z_!~*'().;?:\@&amp;=+$,%#-]+)*/?)@";
</code></pre>

<p>Personally, I would just disable links in comments altogether by removing or commenting out this code -</p>

<pre><code>$comments[$i]-&gt;commentText = preg_replace($pattern, '&lt;a target="_blank" rel="nofollow" href="\0"&gt;\0&lt;/a&gt;', $comments[$i]-&gt;commentText);
</code></pre>
