<p>You can refactor and specify a Handler yourself. These can often be package private, if you put your tests in the same package as your classes-under-testâeven if they're in a different source folder (e.g. src vs testsrc). <a href="https://github.com/google/guava" rel="nofollow">Guava (Google Commons)</a> has a handy <a href="http://google.github.io/guava/releases/18.0/api/docs/com/google/common/annotations/VisibleForTesting.html" rel="nofollow">@VisibleForTesting documentation annotation</a>, too, though Javadoc tends to work as well.</p>

<pre><code>public class CustomerService {
  public void handleProduct() {
    handle(ProductHandlerManager.getProductHandler("apple"));
  }

  /** Visible for testing. */
  void handleProduct(Handler handler) {
    handler.post(new Runnable() {
       @Override
       public void run() {
          //...
       }
    });
  }
}
</code></pre>

<p>At this point, you can test <code>handleProduct(Handler)</code> intensively as a unit test, then only test <code>handleProduct()</code> as an integration test to ensure the "apple" product handler interacts correctly.</p>
