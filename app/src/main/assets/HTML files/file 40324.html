<p>If you want to preserve the speed advantage of <code>strtr</code> (that is the fastest way to translate literal strings (the string is parsed only once for all key/values)), you can proceed in three passes.</p>

<p>The first pass consists to replace what you want to protect with a placeholder. Example:</p>

<pre><code>$protected = array('http://'  =&gt; '#!#0#!#',
                   'https://' =&gt; '#!#1#!#',
                   'ftp://'   =&gt; '#!#2#!#', // etc.
);
$str = strtr($str, $protected);
</code></pre>

<p>Note that the build of <code>$protected</code> can be easily automated from <code>array('http://', 'https://', 'ftp://', ...);</code></p>

<p>Second pass, you use your array:</p>

<pre><code>$str = strtr($str, $icons);
</code></pre>

<p>Third pass, you replace the placeholders:</p>

<pre><code>$str = strtr($str, array_flip($protected));
</code></pre>

<p>Even if you need three passes to do it, the result will be from far faster than using <code>preg_replace</code> that will parse the string once for <strong>each</strong> key/value.</p>
