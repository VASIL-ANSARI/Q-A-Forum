<p>Your option 3 sounds reasonable. If you want to cleanly detect when all requests have completed, one simple approach is to create a new <code>SettableFuture</code> to represent completion. </p>

<p>When your callback tries to take the next request from the queue, and finds it to be empty, you can call <code>set()</code> on the future to notify anything that's waiting for all requests to complete. Propagating exceptions from the individual request futures is left as an exercise for the reader.</p>
