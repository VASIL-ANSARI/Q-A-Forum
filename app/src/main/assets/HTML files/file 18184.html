<p>I ended up using the <code>DataContract</code> attribute and using a DataContractSerializer to Serialize and deserialize the object (It works now everywhere and with/without the protection ).</p>

<p><strong>My research:</strong></p>

<pre><code>[DataContract(Name = "TestClass")]
public class TestClass
{
    [DataMember(Name = "Name")]
    public string Name { get; set; }
    [DataMember(Name = "Age")]
    public int Age { get; set; }
}
</code></pre>

<p><strong>Serialization/Deserialization :</strong></p>

<pre><code>var serializer = new DataContractSerializer(typeof(TestClass));

using (var stream = new MemoryStream())
{
    serializer.WriteObject(stream, this);
    File.WriteAllBytes("TestClass.xml", stream.ToArray());
}

TestClass o = null;
using (var stream = new MemoryStream(File.ReadAllBytes("TestClass.xml")))
{
    o = serializer.ReadObject(stream) as TestClass;
}
</code></pre>
