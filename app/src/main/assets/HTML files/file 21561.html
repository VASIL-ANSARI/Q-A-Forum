<pre><code>SELECT  a.*, c.* -- select columns youw ant
FROM    Purchase a
        INNER JOIN
        (
            SELECT user, MAX(ID) max_ID
            FROM    Purchase
            GROUP   BY user, pur_type
        ) b ON  a.user = b.user AND
                a.ID = b.max_ID
        INNER JOIN goods c
            ON a.pur_type = c.parts
WHERE   a.USER = 408
</code></pre>

<ul>
<li><a href="http://www.sqlfiddle.com/#!2/9b487/5" rel="nofollow">SQLFiddle Demo</a></li>
</ul>

<p>for better performance, add an INDEX on column <code>parts</code> on table <code>goods</code> as well on <code>pur_type</code></p>
