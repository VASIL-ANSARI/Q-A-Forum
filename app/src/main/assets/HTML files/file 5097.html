<p>This gets you most of the way there:</p>

<pre><code>SELECT
    partner_manager_id,
    SUM(CASE WHEN active THEN 1 ELSE 0 END) AS n_active_companies,
    SUM(CASE WHEN active THEN 0 ELSE 1 END) AS n_inactive_companies
FROM COMPANY
GROUP BY partner_manager_id
</code></pre>

<p>The rest of your question is basically asking how to join this result to the remaining tables. As you point out, to do this use JOINs.</p>

<pre><code>SELECT
    PARTNER.name,
    T1.n_active_companies,
    T1.n_inactive_companies
FROM
PARTNER
LEFT JOIN PARTNER_MANAGER ON partner_id = PARTNER.id
LEFT JOIN
(
    SELECT
        partner_manager_id,
        SUM(CASE WHEN active THEN 1 ELSE 0 END) AS n_active_companies,
        SUM(CASE WHEN active THEN 0 ELSE 1 END) AS n_inactive_companies
    FROM COMPANY
    GROUP BY partner_manager_id
) T1
ON T1.partner_manager_id = PARTNER_MANAGER.id
</code></pre>
