<p>I've spent some time pondering on cute way to do your task. I don't think there is efficient way to do it as a query.<br>
So I think you should return to good old cursor and do it like this (and I believe it will be the fastest and the simplest way):</p>

<pre><code>SELECT * from table WHERE value=1 ORDER BY datetime
</code></pre>

<p>And then run through fetched records (in pseudocode):</p>

<pre><code>int count=0;
int intervalLen=0;

if (move to first) 
do {
  if(get(value)==1){
    if(intervalLen==4)
      count++;
    intervalLen++;

  } else 
    intervalLen=0;

} while (move to next)
</code></pre>

<p><strong>Note</strong> that it counts uninterrupted intervals of value=1 not less than 4 records in a row. <br>If you have to consider exact time you should change it a bit</p>
