<p>One would control the console direct rather than asking CMD. See this API call. </p>

<blockquote>
  <p><code>SetConsoleTextAttribute</code></p>
  
  <p>The SetConsoleTextAttribute function sets the attributes of characters written to the screen buffer by the WriteFile or WriteConsole function, or echoed by the ReadFile or ReadConsole function. This function affects text written after the function call. </p>
</blockquote>

<pre><code>BOOL SetConsoleTextAttribute(
  HANDLE hConsoleOutput,  // handle to screen buffer
  WORD wAttributes        // text and background colors
);
</code></pre>
