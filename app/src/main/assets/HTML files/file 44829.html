<p>The line <code>return Parse.Promise.when(merchantDuty)</code> is executing before there are any promises in the merchantDuty array (initialized as empty).
So the whole function is terminating before your query find success function.</p>

<p>I think if you create and add query promises to the merchantDuty array you will fix your bug.</p>

<p>I also suggest you to use promise callbacks for the query methods. Like:</p>

<pre><code>query.find().then(function(){
  //success
}, function(error){
  //error
});
</code></pre>

<p>You can then chain them by returning another promise and make the code better structured.</p>
