<p>From the error message, the points and the fundamental matrix have to be <code>CV_64F</code> (double type).</p>

<p>For the points, it should be:</p>

<pre><code>Point3d point1 = Point3d(keypoints_1[good_matches[iP].queryIdx].pt.x, keypoints_1[good_matches[iP].queryIdx].pt.y, 1.0);
Point3d point2 = Point3d(keypoints_2[good_matches[iP].trainIdx].pt.x, keypoints_2[good_matches[iP].trainIdx].pt.y, 1.0);
</code></pre>
