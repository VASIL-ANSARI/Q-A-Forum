<p>Here is how it is done:</p>

<p>Do NOT set proguard.config=proguard.cfg in your project.properties file.</p>

<p>in your build.properties file set</p>

<pre><code> proguarded=on    # or whatever variable you chose
</code></pre>

<p>Define these Macros if you are building Android so that debugging is always off:</p>

<pre><code>  &lt;macrodef name="set-app-debuggable"&gt;
    &lt;sequential&gt;
        &lt;echo&gt;Updating AndroidManifest.xml with debuggable set to true&lt;/echo&gt;           
       &lt;replaceregexp file="./AndroidManifest.xml"
                            match='android:debuggable="(.*)"'
                            replace='android:debuggable="true"'
                            byline="false"&gt;         
        &lt;/replaceregexp&gt;
    &lt;/sequential&gt;
&lt;/macrodef&gt;
&lt;macrodef name="set-app-not-debuggable"&gt;
    &lt;sequential&gt;
        &lt;echo&gt;Updating AndroidManifest.xml with debuggable set to false&lt;/echo&gt;          
        &lt;replaceregexp file="./AndroidManifest.xml"
                            match='android:debuggable="(.*)"'
                            replace='android:debuggable="false"'
                            byline="false"&gt;         
        &lt;/replaceregexp&gt;
    &lt;/sequential&gt;
&lt;/macrodef&gt;
</code></pre>

<p>Then set these conditions or similar to these depending on if you want to preserve debugging outside proguard builds:</p>

<pre><code>&lt;target name="-set-mode-check"&gt;
    &lt;echo&gt; set mode checking properties ... &lt;/echo&gt;
    &lt;echo&gt; Proguard Property  value is '${proguard.config}' &lt;/echo&gt;
    &lt;echo&gt; Proguard Property  value is '${proguarded}' &lt;/echo&gt;
    &lt;condition property="proguard.config" value="proguard.cfg"&gt;
       &lt;isset property="proguarded"/&gt;
   &lt;/condition&gt;
    &lt;echo&gt; Proguard Property  value after condition set is '${proguard.config}' &lt;/echo&gt;
     &lt;if condition="${proguarded}"&gt;
        &lt;then&gt;
            &lt;echo&gt;****  This build is proguarded so setting debuggable off  ****&lt;/echo&gt;
            &lt;set-app-not-debuggable /&gt;
        &lt;/then&gt;
        &lt;else&gt;
            &lt;echo&gt;****  This build is not proguarded so setting debuggable on ****&lt;/echo&gt;
            &lt;set-app-debuggable /&gt;
        &lt;/else&gt;
    &lt;/if&gt;

&lt;/target&gt;
</code></pre>

<p>No need to set proguard.config in the project.properties file at all. </p>
