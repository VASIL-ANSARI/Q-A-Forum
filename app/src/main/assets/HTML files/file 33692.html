<p>Try to implement it in the next way:</p>

<pre><code>STDMETHODIMP CMain::GetObject(IParent** pVal)
{
      IParent* parent;
      HRESULT hr = CoCreatInstance(CLSID_Child, NULL, CLSCTX_INPROC_SERVER, IID_IParent, (void**)&amp;parent);

      *pVal = parent;

      return hr;
}
</code></pre>

<p>Then check, if hr is S_OK.</p>

<p>Possible you do not implement QueryInterface for IID_IParent in a Child class (CLSID_Child) implementation.</p>

<p>In case if you are using ATL it will look like this:</p>

<pre><code>BEGIN_COM_MAP(CChild)
   COM_INTERFACE_ENTRY(IChild)
   COM_INTERFACE_ENTRY(IParent)
   COM_INTERFACE_ENTRY(IDispatch)
END_COM_MAP()
</code></pre>
