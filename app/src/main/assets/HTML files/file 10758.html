<p>The reason is that the Visual Studio installer projects are fundamentally broken and their dependency resolver is a buggy mess.  I've wasted hours upon hours in trying to get the dependencies to resolve correctly, and sometimes it just doesn't work.  </p>

<p>In the end, I usually end up manually added missing DLL references (like MSHTML) into the installer project.  This will sometimes give you a warning about duplicate files (because it sort of recognizes the dependency), but it is better than the DLL not getting deployed.</p>

<p>The better long term solution is to not use the Visual Studio installer projects, and use something like Wix or InnoSetup or NSIS, but they are all very complicated to setup.</p>
