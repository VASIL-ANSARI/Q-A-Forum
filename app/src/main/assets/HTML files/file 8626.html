<p>It looks like <code>document.getElementById(tableName)</code> is not finding the table which you're expecting, and so it returns <code>null</code>. <code>null.rows</code> is not valid, and so there's an error there.</p>

<p>I'd recommend splitting that line into two and checking that the element is found before continuing:</p>

<pre><code>var table = document.getElementById(tableName),
    rows;
if (table) {
    rows = table.rows;
} else {
    alert("Couldn't find table with id: " + tableName);
}
</code></pre>
