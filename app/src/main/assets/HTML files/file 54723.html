<p>Assuming that you have an <code>id</code> property in your <code>UserDetails</code>:</p>

<pre><code>@RequestMapping(value="/messages/{userId}", method=HttpMethod.GET)
@PreAuthorize("#userId == authentication.principal.id")
public List&lt;Message&gt; getMessages(@PathVariable String userId) {
    // retrieve from DAO here
}
</code></pre>

<p>Make sure you have enabled pre/post-annotations in your security config.</p>
