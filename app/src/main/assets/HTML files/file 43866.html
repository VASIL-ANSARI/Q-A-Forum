<p>Here is a <a href="http://goo.gl/GWeOCQ" rel="nofollow">sample code</a> with <a href="https://php.net/manual/ru/function.preg-replace-callback.php" rel="nofollow"><code>preg_replace_callback</code></a> showing how you can modify submatches.</p>

<pre><code>$str = "background : background : 'url(data:image/jpg;base64,__image[css/images/logo/logo.jpg]__)'\nbackground : background : 'url(data:image/jpg;base64,__image[css/images/logo/logo.jpg]__)'"; 
$re = "/([^&lt;&gt;]*?__image\[)(.*?)(\]__\)')/i"; 
$str = preg_replace_callback($re, function ($matches) {
        return str_replace($matches[1], "background-image: url(", 
               str_replace($matches[3], ");",
               str_replace($matches[2], "&lt;&lt;base64-file&gt;&gt;", $matches[0])));
          }, $str);
print ($str);
</code></pre>

<p>Output:</p>

<pre><code>background-image: url(&lt;&lt;base64-file&gt;&gt;);background-image: url(&lt;&lt;base64-file&gt;&gt;);
</code></pre>
