<p>Looks like you want to </p>

<ol>
<li>Read the data from file say input.csv</li>
<li>Extract the name and split it into first name and last name</li>
<li>Get the sex using first name</li>
<li>And probably write the data again to a new csv or print it.</li>
</ol>

<p>You can follow the approach as below. You can get more sophisticated in splitting using regex but here is something basic using strip commands:</p>

<pre><code>inFile=open('input.csv','r')
rows=inFile.readlines()
newData=[]
if len(rows) &gt; 1:
    for row in rows[1:]:
         #Remove the new line chars at the end of line and split on ;
         data=row.rstrip('\n').split(';')

         #Remove additional spaces in your data
         name=data[0].strip()

         #Get rid of quotes
         name=name.strip('"').split(' ')
         fname=name[1]
         lname=name[0]
         city=data[1].strip()
         city=city.strip('"')

         #Now you can get the sex info from your other database save this in a list to get the sex info later
         sex='M' #replace this with your db calls
         newData.append([fname, lname, sex, city])

inFile.close()
#You can put all of this in the new csv file by something like this (it seperates the fileds using comma):

outFile=open('otput.csv','w')
for row in newData:
    outFile.write(','.join(row))
    outFile.write('\n')
outFile.close(
</code></pre>
