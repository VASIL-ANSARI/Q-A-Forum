<p>In MS-SQL I would use <code>ROW_NUMBER() OVER(ORDER BY starttime) AS Rank</code> to rank the rows on start time.</p>

<p>Then, I would write a query to join each line to the line with previous Rank and set a flag if the difference is bigger than five or NULL (first row). </p>

<p>Then, I would select all rows having this flag which are start rows, and for this subset repeat the process of numbering rows and joining to the next row to get the time spans:</p>

<pre><code>blockstarttime1 nextstarttime1 (=starttime2)
blockstarttime2 nextstarttime2 (=starttime3)
blockstarttime3 NULL
</code></pre>

<p>Finally, this dataset can be joined to the original data with a <code>WHERE starttime BETWEEN blockstarttime and nextstarttime</code> to partition the results.</p>

<p>Up to you to translate this to Oracle...</p>
