<p>Making a COM Automation Add-In is not the best way to add user-defined functions to Excel - it is slow and has various limitations. Better is to make an .xll add-in based on the native C API (<a href="http://msdn.microsoft.com/en-us/library/office/bb687883.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/office/bb687883.aspx</a>). If you are using C++ there are a number of toolkits that help a lot (using only the SDK is not so easy). You might like to have a look at:</p>

<ul>
<li><a href="http://xlw.sourceforge.net/" rel="nofollow">XLW</a> - an open source wrapper for the API that's the standard starting point</li>
<li><a href="https://xll.codeplex.com/" rel="nofollow">Keith Lewis's xll library</a> - uses modern C++ paradigms, with a nice variety of example projects.</li>
<li><a href="http://www.planatechsolutions.com/xllplus/" rel="nofollow">XLL+</a> - a highly regarded commercial toolkit, with various advanced features like async functions and ribbon integration.</li>
</ul>

<p>If you prefer to use a managed language, like VB.NET, C# or F#, you should use the open--source <a href="http://excel-dna.net" rel="nofollow">Excel-DNA</a> library which allows the integration of .NET with Excel using the C API, and also has various advanced features.</p>
