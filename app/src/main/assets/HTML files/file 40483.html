<p>I would suggest splitting the node <code>id</code> into two concepts.  One would be a <em>unique</em> id that is used for the graph properties (i.e. <code>ancestor_descendant</code> list).  The second is what you show on output.</p>

<ul><li>1<ul><li>2<ul><li>5</li></ul></li><li>3<ul><li>50</li></ul></li><li>4<ul><li>6</li></ul><ul><li>20<ul><li>51</li></ul></li></ul></li></ul></li></ul>

<p>Then create a mapping table:</p>

<pre><code>Id      Value
 1        1
 2        2
20        2
 3        3
 4        4
 5        5
50        5
51        5
 6        6
</code></pre>

<p>You can then get what you want by joining back to the mapping table and using the <code>value</code> column instead of the <code>id</code> column.</p>
