<p>Your <code>break</code> after <code>if (input == null) { }</code> is breaking the while, so your code only read one line.</p>

<blockquote>
  <p>Also is there a way to avoid the while(true) and using break to
  terminate it?</p>
</blockquote>

<p>Do it in this way:</p>

<pre><code>while ((input = bin.readLine()) != null) {
    //split input line here 
}
</code></pre>

<p>Also, consider using <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29" rel="nofollow">String#split()</a> to split the line in tokens. Example for the separator <code>,</code> :</p>

<pre><code>String attributeNames[] = input.split(",");
</code></pre>
