<p>I would highly recommend altering your table structure.  At present you have two pieces of information tied into a single field.  This is a SQL Anti-Pattern and destroys the ability of Oracle to user certain optimisations.</p>

<p>Instead, please consider splitting "PROD_KEY" into two fields (PRODUCT_TYPE = Prod_A, etc) (SUB_PRODUCT_ID = 1, 2, 3, etc).  Or, to cause less potential change across the database, simply add the PRODUCT_TYPE to your current table.</p>

<p><br/></p>

<p>That said, using your current structure...</p>

<pre><code>SELECT
  EN_NO,
  PROD_KEY,
  CASE WHEN (EN_NO &lt; 4) AND (LEFT(PROD_KEY, 6) = 'Prod_A') THEN PROD_KEY ELSE NULL END AS Prod_A,
  CASE WHEN (EN_NO &lt; 4) AND (LEFT(PROD_KEY, 6) = 'Prod_B') THEN PROD_KEY ELSE NULL END AS Prod_B,
  CASE WHEN (EN_NO &lt; 4) AND (LEFT(PROD_KEY, 6) = 'Prod_C') THEN PROD_KEY ELSE NULL END AS Prod_C,
  PROD_QTY
FROM
  yourTable
</code></pre>

<p>This works when you know specifically what columns you need as output.  If you need the code to adapt to having <code>Prod_D</code>, etc, then you need to write code that writes code (Dynamic SQL).</p>
