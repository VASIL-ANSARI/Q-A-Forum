<p>Well, you can increase the buffer size by using this command. It may solve your error. </p>

<p><a href="https://docs.oracle.com/cd/E15289_01/doc.40/e15062/optionxx.htm#BABGCFFB" rel="nofollow"><code>-XX:MaxDirectMemorySize=256M</code></a></p>

<hr />

<p>I tried to cursory read the two source code and the differences that i can found is that apache method is not trying to read all the file and store it into the memory but it write to an output first (which is their own implementation of <code>ByteArrayOutputStream</code>) which is to an <code>ArrayList</code> (so you can say that they put use the memory space that you have increased through <code>-Xmx</code>). and the other one is just store all content into a memory space which could be the reason of your error.  </p>
