<p>The easiest way I found to deal with selections with an AvalonEdit editor is as follows:</p>

<pre><code>IEnumerable&lt;SelectionSegment&gt; selectionSegments = Editor.TextArea.Selection.Segments;
TextDocument document = Editor.TextArea.Document;
foreach (SelectionSegment segment in selectionSegments)
{
    //DO WHAT YOU WANT WITH THE SELECTIONS
    int lineStart = document.GetLineByOffset(segment.StartOffset).LineNumber;
    int lineEnd = document.GetLineByOffset(segment.EndOffset).LineNumber;
    for (int i = lineStart; i &lt;= lineEnd; i++)
    {
        //Do something with each line in the selection segment
    }
}
</code></pre>

<p>In my case I needed to mark something on each line selected, so that's why I split it into lines.</p>
