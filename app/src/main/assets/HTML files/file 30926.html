<p>The return value is correct, <code>p</code> is a <em>pointer</em>, it takes 4 bytes.</p>

<p>You cannot leave it this way, there are <em>two</em> memory allocations.  The marshaller allocated the memory for the array.  It created a SAFEARRAY, a COM array type.  Pretty unlikely that your C code is going to be happy with that.  Declare it like this instead:</p>

<pre><code>[StructLayout(LayoutKind.Sequential)]
public class OUR_MEM_STR {
    public IntPtr p;
    public int len;
};
</code></pre>

<p>And use Marshal.AllocHGlobal(10) to assign <code>p</code>.  Don't forget to clean-up again.</p>

<p>Don't pass <em>true</em> to StructureToPtr(), the memory allocated by AllocHGlobal() isn't initialized.  That's going to randomly crash your program.  You must pass <em>false</em>.</p>
