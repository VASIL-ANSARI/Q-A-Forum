<pre><code>if (hWnd = hWindows[0])
</code></pre>

<p>That's assignment. Since <code>hWindows[0]</code> is non-zero, that expression always evaluates true.</p>

<p>You mean:</p>

<pre><code>if (hWnd == hWindows[0])
</code></pre>

<p>You should call <code>PostQuitMessage</code> in response to <code>WM_DESTROY</code>. And since the default window procedure calls <code>DestroyWindow</code> in response to <code>WM_CLOSE</code>, you can write it like this:</p>

<pre><code>switch (message)
{
case WM_DESTROY:
    {
        if (hWnd == hWindows[0]) {
            // close the application entirely
            PostQuitMessage(0);
        }
        return 0;
    }
    break;
}

// Handle any messages the switch statement didn't
return DefWindowProc(hWnd, message, wParam, lParam);
</code></pre>
