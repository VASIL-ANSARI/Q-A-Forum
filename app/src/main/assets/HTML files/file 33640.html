<p>why not use JPA EntityManager's merge method? </p>

<p><a href="http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#merge%28T%29" rel="nofollow">http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#merge(T)</a></p>

<p>this method will first fetch the entity to the persistent context and copy all the values from your entity (detached) to the persisted entity. when the transaction is flushed, JPA will check the version for you. if it's stale, an OptimisticLockException will be thrown. using this method, you don't need to check the version yourself</p>
