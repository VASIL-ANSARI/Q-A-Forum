<pre><code>[new_array1, new_array2].map do |a|
  a.group_by { |e| [e[:index], e[:column]] }
end.reduce do |f, l|
  f.merge(l) { |_, f, l| [f.first[:ID], l.first[:ID]] }
end
# =&gt; {
#     [ 4, 0 ] =&gt; [
#         [0] "ABC",
#         [1] "ABC"
#     ],
#     [ 4, 1 ] =&gt; [
#         [0] "XYZ",
#         [1] "IJK"
#     ],
#     [ 4, 2 ] =&gt; [
#         [0] "BCD-1547",
#         [1] "BCD-1547"
#     ]
# }
</code></pre>

<p>Put <code>do_something unless f.first[:ID] == l.first[:ID]</code> instead of <code>[f.first[:ID], l.first[:ID]]</code> in the last clause to do whatever you want.</p>
