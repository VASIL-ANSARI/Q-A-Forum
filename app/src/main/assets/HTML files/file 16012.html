<p>You want <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa366902.aspx" rel="nofollow"><code>VirtualQuery</code></a>. It fills in a <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa366775.aspx" rel="nofollow"><code>MEMORY_BASIC_INFORMATION</code></a> structure. If <code>mbi.Type == MEM_IMAGE</code>, you're looking at a mapped image. You probably also want to look at the <code>AllocationProtect</code> to check for <code>PAGE_EXECUTE</code> or one of its variants (otherwise you could be looking at something like read-only data mapped from the executable, such as a bitmap resource or something on that order).</p>
