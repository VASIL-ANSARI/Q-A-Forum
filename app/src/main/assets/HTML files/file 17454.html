<p>On the first iteration it possibly worked out well, but then once you close the handle, you cannot supply the same vector to <code>WaitForMultipleObjects</code> once again: at least one of the handles is no longer valid.</p>

<p>So <code>WaitForMultipleObjects</code> returns you an error there, and possibly another one later in <code>CloseHandle</code>. </p>

<p>This is not your real code, right? Because in this code snippet you don't really check returned values for errors. Because this code snippet has more errors to note:</p>

<ul>
<li>if(...); - empty conditional block</li>
<li>because of the one above you might be accessing vector with illegal index</li>
<li>you check <code>WAIT_OBJECT_0 + 0</code> only, and not other <code>WAIT_OBJECT_0 + N</code></li>
</ul>
