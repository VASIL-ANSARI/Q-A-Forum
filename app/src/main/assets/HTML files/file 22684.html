<p>May be it can help you:</p>

<pre><code>SELECT * FROM table ORDER BY level;
</code></pre>

<p>you will receive anything like this:</p>

<pre><code>$a = array(
    array('id' =&gt; 1, 'parent_id' =&gt; 0, 'level' =&gt; 0),
    array('id' =&gt; 2, 'parent_id' =&gt; 1, 'level' =&gt; 1),
    array('id' =&gt; 3, 'parent_id' =&gt; 1, 'level' =&gt; 1),
    array('id' =&gt; 4, 'parent_id' =&gt; 2, 'level' =&gt; 2),
    array('id' =&gt; 5, 'parent_id' =&gt; 3, 'level' =&gt; 2)
);
</code></pre>

<p>Prepare this array:</p>

<pre><code>$prepare = array();

foreach ($a as $record) {
    $prepare[$record['id']] = $record;
}
</code></pre>

<p>And recursive walking it:</p>

<pre><code>function getTree($array, $id, $level = 0)
{
    if ($array[$id]['level'] != $level) {
        return;
    }
    echo '&lt;ul&gt;' . PHP_EOL;
    echo '&lt;li&gt;' . $id;
    foreach ($array as $data) {
        if (($data['parent_id'] === $id)){
            getTree($array, $data['id'], $level + 1);
        }

    }
    echo '&lt;/li&gt;'. PHP_EOL;
    echo '&lt;/ul&gt;'. PHP_EOL;
}


getTree($prepare, 1);
</code></pre>

<p>It example do return:</p>

<pre><code>&lt;ul&gt;
&lt;li&gt;1&lt;ul&gt;
&lt;li&gt;2&lt;ul&gt;
&lt;li&gt;4&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;3&lt;ul&gt;
&lt;li&gt;5&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
