<p>So move the pop up outside of the timeout, give it a name, call close, and reload.</p>

<pre><code>function closeAndRefresh(){    
    var winPop = window.open('/{!currSubId}','_top');  //load pop up give it a name
    window.setTimeout(function(){
        winPop.close();  //close pop up
        window.location.reload(true);  //refresh current page
    },5000);
}
</code></pre>

<p>You could just use an Ajax call to the server and not have to deal with a pop up and wondering if the pop up blocker will block it or not knowing if the call completetd. When the call comes back from the call, you can just reload the page.</p>
