<p>Add scopes on <code>Ride</code> with a <code>group</code> and <code>having</code> clause. It would check the count of all future trips of a ride and return the rides with 0 count. </p>

<pre><code>Class Ride

  scope :active_state, where(state: "active")
  scope :with_nonactive_trips, -&gt; (start_date = Date.today){ joins(:trips).
                                    group("rides.id").
                                    having( ["sum(trips.date &gt; ?) = 0",start_date] ) }

end

Ride.active_state.with_nonactive_trips
# returns All the rides with state == active, alteast one trip and having no trips with date &gt; Date.today
</code></pre>

<p>Using a <code>lambda</code> since you had it on the active scope in <code>Trip</code>. I am guessing you need to use a different date than <code>Date.today</code> for some queries.</p>
