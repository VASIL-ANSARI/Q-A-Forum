<p>Here's how I think I would go about this.</p>

<ol>
<li><p>Have a module level dictionary mapping persistent_id to SpecialClass objects. Every time you initialise or unpickle a <code>SpecialClass</code> instance, make sure that it is added to the dictionary.</p></li>
<li><p>Override SpecialClass's <code>__getattr__</code> and <code>__setattr__</code> method, so that <code>specialobj.foo = anotherspecialobj</code> merely stores a persistent_id in a dictionary on specialobj (let's call it <code>specialobj.specialrefs</code>). When you retrieve <code>specialobj.foo</code>, it finds the name in specialrefs, then finds the reference in the module-level dictionary.</p></li>
<li><p>Have a module level <code>check_graph</code> function which would go through the known <code>SpecialClass</code> instances and check that all of their specialrefs were available.</p></li>
</ol>
