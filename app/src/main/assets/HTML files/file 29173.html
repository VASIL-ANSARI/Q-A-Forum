<p>I don't know how you can detect that you're in the Heroku asset pre-comp phase and avoid running some code, but you can get the Heroku environment variable to be available during pre-comp by using the 'user-env-compile' feature from Heroku Labs.</p>

<p><a href="https://devcenter.heroku.com/articles/labs-user-env-compile" rel="nofollow">https://devcenter.heroku.com/articles/labs-user-env-compile</a></p>

<pre><code> heroku labs:enable user-env-compile -a myapp
</code></pre>
