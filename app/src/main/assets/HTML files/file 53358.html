<p>When you divide by <code>2.0</code> you have an implicit conversion to double. Double accuracy is limited to about 15 decimal digits. So what happens to the 16<sup>th</sup> digit is perfectly defined, but may not be what you expect.</p>

<p>If you need accuracy, try to use <code>long long</code> or <code>unsigned long long</code> and carefully control that you have no overflow. If it is not enough, you will have to use multi-precision arithmetic (for example <a href="https://gmplib.org/">GMP</a>). Because as soon as you use double floating points, you are limited to 53 binary digits of accuracy, or about 15-16 decimal digits.</p>
