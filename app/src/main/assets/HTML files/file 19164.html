<p>You can parse your records one by one, so I don't think the memory consumption of the JSON structures exceeds a few kilobytes. Just create</p>

<pre><code>class Something {
    String action;
    int responsecode;
    // do not include the fields you don't need
}
</code></pre>

<p>and read one record in each step. Guava's <code>HashMultiset&lt;String, Integer&gt;</code> with its methods <code>put</code>, <code>count</code>, and <code>size</code> gives you everything you need. In case you run out of the memory (because of the huge Multimap), you'll probably need a database instead, but I'd try the simple solution first.</p>

<p>For the output JSON you may need GSON's <code>TypeAdapter</code> or <code>JsonSerializer</code>. Or as a hack, you can easily generate the output manually.</p>
