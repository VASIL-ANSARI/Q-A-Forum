<p>I think you need to call <code>sha.digest()</code> in place of <code>hexdigest()</code>.  You want a 20 byte binary hash to pass in to your base64 encoder; <code>digest()</code> does this while <code>hexdigest()</code> converts each of these bytes to a 2-byte hex representation.</p>

<p>See the <a href="http://docs.python.org/library/sha.html" rel="nofollow">python sha docs</a> for details.</p>
