<p>I dont have postgres here to test, but this should return all of the data you want to keep:</p>

<pre><code>SELECT ID FROM (
SELECT ID FROM (SELECT 
  id,
  datetime,
  type,
  LAG(type) OVER (ORDER BY id asc) AS prev_type,
  LAG(datetime) OVER (ORDER BY id asc) AS prev_date
FROM employees
WHERE 
  type=1 AND
  prev_type=0 AND
  EXTRACT(EPOCH FROM (datetime - prev_date)) &lt; 3601
  )

UNION  

SELECT MAX(ID) FROM employees GROUP BY TO_CHAR(datetime, 'DDMMYYYHH24'))
</code></pre>
