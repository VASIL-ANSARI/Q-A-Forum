<p><code>WEEKDAY('2015-12-31')</code> and <code>WEEKDAY('2015-01-01')</code> are computing the day of the week for the start and end of the year, with 0 = Monday and 6 = Sunday. For the year 2015, these are both 6 (Sunday). So the middle argument of <code>MID</code> is <code>7 * 6 + 6 + 1</code>, or 49.</p>

<p>The 49th character of the long string is <code>0</code>. So this means it will add zero to the rest of the expression.</p>

<p>The purpose of this expression is to adjust the weekday count according to what days of the week the first and last day of the year are. In 2015, neither one is a weekday, so it adds zero. Now consider 2016.  Jan 1 2016 is a Monday (<code>weekday=1</code>) and Dec 31 2016 is a Tuesday (<code>weekday=2</code>). <code>7*1+2+1</code> equals 10. The tenth character of the long string is <code>1</code>. So it will add one weekday ... intuitively we can see this happens because 2016 is a leap year, so there's one more day in the year.  And so on. For each possible beginning and ending day of the year, the long string encodes an adjustment of how many weekdays to add.  I imagine that the string was discovered by trial and error.</p>
