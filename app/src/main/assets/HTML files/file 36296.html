<p>Maybe something like this</p>

<pre><code>var timeDifArray = (from s in pe.Services
    join g in pe.Groups on s.GroupId equals g.GroupId
    join ud in pe.UserDetails on s.UserIdInCharge equals ud.UserId into ud1
        from ud in ud1.DefaultIfEmpty()
        where allowedGroups.Contains(g.GroupId)
        &amp;&amp; (!filterBySector || filter.selectedSectors.Contains(g.GroupId))
        &amp;&amp; (!filterByGroup || (s.UserIdInCharge.HasValue 
                               &amp;&amp; members.Contains(s.UserIdInCharge.Value)))
        &amp;&amp; (s.Status == (decimal)Data.Enums.ServiceStatus.Active 
            || s.Status == (decimal)Data.Enums.ServiceStatus.Sold)
        &amp;&amp; s.ServiceStartDate &gt;= startDate
        &amp;&amp; s.ServiceStartDate &lt;= endDate
        group s by new Guid() into services
        select new
          { 
            services.ServiceStartDate,
            services.ServiceEndDate,
          }).ToArray();

var timeDifs = timeDifArray.Select(x =&gt; x.ServiceEndDate.Subtract(x.ServiceEndDate));
var totalTimeDifs = timDifs.Sum(x =&gt; x.Hours);
</code></pre>
