<p>How about putting a delimiter in your code right after the <code>#include</code> list, so that you could get rid of the include files expansions manually, but have the macro expansion intact after running <code>gcc -E</code>?</p>

<p>Something like:</p>

<pre><code>#include &lt;one&gt;
#include &lt;two&gt;
void delete_everything_above_and_put_includes_back(); // delimeter
#define MACRO(X) ...
//rest of the code
</code></pre>

<p>I'm not aware of a tool that expands macros but doesn't expand <code>#include</code>s... </p>
