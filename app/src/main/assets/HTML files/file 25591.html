<p>There is something confusing here. You have a loop and after loop conditionals. Shouldnt your update query be inside a loop like:</p>

<pre><code>while($row = mysqli_fetch_array($checkit))
{
    $itStatus = $row["it"];


    if($itStatus == "not it")
    {
       mysqli_query("UPDATE login SET it = CASE WHEN uname = '$youruname' THEN 'not  it' ELSE 'it' END WHERE uname IN ('$youruname', '$selPlayerUname')");

       $flag = "success";
    }
    else if($itStatus == "it")
    {
       $flag = "nope";
    }
    else
    {
       $flag = "error";
    }
}
</code></pre>

<p>Your <strong>$iStatus</strong> gets the last value from the database since its in the loop and then you check in conditionals</p>

<p>If above does not help then check your <strong>$_POST</strong> values to see if any of them are <strong>blank</strong> or <strong>null</strong> and do the query on <strong>PHPMyAdmin</strong> see if it actually returns anything.</p>
