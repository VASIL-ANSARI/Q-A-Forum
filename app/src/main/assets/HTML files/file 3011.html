<p>Ok, found the answer myself after playing a little with numpy's in-place array manipulations.</p>

<p>Changed the last 3 lines in the loop to:</p>

<pre><code>    d = conditionalize(d, dim, val)
</code></pre>

<p>where conditionalize is defined as:</p>

<pre><code>    def conditionalize(arr, dim, val):
        arr = arr.swapaxes(dim, 0)
        shape = arr.shape[1:]       # shape of the sub-array when we omit the desired dimension.
        count = array(shape).prod() # count of elements omitted the desired dimension.
        arr = arr.reshape(array(arr.shape).prod()) # flatten the array in-place.
        arr = arr[val*count:(val+1)*count] # take the needed elements
        arr = arr.reshape((1,)+shape) # the desired sub-array shape.
        arr = arr. swapaxes(0, dim)   # fix dimensions

        return arr
</code></pre>

<p>That made my program's execution time reduce from 15 minutes to 6 seconds. Huge gain.</p>

<p>I hope this helps someone who comes across the same problem.</p>
