<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int main(int ac, char *av[]){
    int i, argc=0;
    char **argv=NULL, data[16];
    FILE *fstin = stdin;

    if(ac == 2){
        if(NULL==(fstin = fopen(av[1], "r"))){
            puts("Couldn't fopen...");
            return -1;
        }
    }
    while (1==fscanf(fstin, "%15s", data)){
        argv = realloc(argv, (argc+1)*sizeof(char*));
        argv[argc] = malloc(strlen(data)+1);
        strcpy(argv[argc++], data);
    }
    if(ac == 2)
        fclose(fstin);

    for (i=0; i&lt;argc; ++i) {
        printf("%s\n", argv[i]);
    }
    //deallocate
    return 0;
}
</code></pre>
