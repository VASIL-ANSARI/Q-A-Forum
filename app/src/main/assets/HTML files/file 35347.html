<p>I found the answer. Here it is for whoever runs into it as well:</p>

<p>Add this after <code>DuplicateTokenEx</code> call:</p>

<pre><code>HANDLE hToken2;
DuplicateTokenEx(hToken, MAXIMUM_ALLOWED, NULL, SecurityIdentification, TokenPrimary, &amp;hToken2);

//ONLY if requiring UIAccess!
DWORD dwUIAccess = 1;
::SetTokenInformation(hToken2, TokenUIAccess, &amp;dwUIAccess, sizeof(dwUIAccess));
</code></pre>
