<p>Here is what you need:</p>

<pre><code>select
concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',
right(@mydate,5)),right(@mydate,5))) dttm
from
(
    select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    (select substr(date(@mydate),6) my_md) AA,
    (select substr(date(now()),6) md,year(now()) yr) BB
) A;
</code></pre>

<p>Here are the three dates you chose as examples + 2 leap year dates</p>

<pre><code>set @mydate = '2012-01-01';
set @mydate = '2010-05-05';
set @mydate = '2012-10-10';
set @mydate = '2008-02-29';
set @mydate = '2012-02-29';
</code></pre>

<p>Here they are executed</p>

<p>mysql> set @mydate = '2012-01-01';
Query OK, 0 rows affected (0.00 sec)</p>

<pre><code>mysql&gt; select
    -&gt; concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -&gt; from
    -&gt; (
    -&gt;     select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    -&gt;     IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    -&gt;     (select substr(date(@mydate),6) my_md) AA,
    -&gt;     (select substr(date(now()),6) md,year(now()) yr) BB
    -&gt; ) A;
+------------+
| dttm       |
+------------+
| 2012-01-01 |
+------------+
1 row in set (0.00 sec)

mysql&gt; set @mydate = '2010-05-05';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select
    -&gt; concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -&gt; from
    -&gt; (
    -&gt;     select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    -&gt;     IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    -&gt;     (select substr(date(@mydate),6) my_md) AA,
    -&gt;     (select substr(date(now()),6) md,year(now()) yr) BB
    -&gt; ) A;
+------------+
| dttm       |
+------------+
| 2012-05-05 |
+------------+
1 row in set (0.00 sec)

mysql&gt; set @mydate = '2012-10-10';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select
    -&gt; concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -&gt; from
    -&gt; (
    -&gt;     select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    -&gt;     IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    -&gt;     (select substr(date(@mydate),6) my_md) AA,
    -&gt;     (select substr(date(now()),6) md,year(now()) yr) BB
    -&gt; ) A;
+------------+
| dttm       |
+------------+
| 2012-10-10 |
+------------+
1 row in set (0.00 sec)

mysql&gt; set @mydate = '2008-02-29';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select
    -&gt; concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -&gt; from
    -&gt; (
    -&gt;     select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    -&gt;     IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    -&gt;     (select substr(date(@mydate),6) my_md) AA,
    -&gt;     (select substr(date(now()),6) md,year(now()) yr) BB
    -&gt; ) A;
+------------+
| dttm       |
+------------+
| 2012-02-29 |
+------------+
1 row in set (0.00 sec)

mysql&gt; set @mydate = '2012-02-29';
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select
    -&gt; concat(yr,'-',if(leapyear=0,if(right(dt,5)='02-29','03-01',right(@mydate,5)),right(@mydate,5))) dttm
    -&gt; from
    -&gt; (
    -&gt;     select concat(if(my_md &gt; md,yr -1,yr),'-',my_md) dt,yr,my_md,
    -&gt;     IF(MOD(yr,4)&gt;0,0,IF(MOD(yr,100),1,(MOD(yr,400)=0))) leapyear FROM
    -&gt;     (select substr(date(@mydate),6) my_md) AA,
    -&gt;     (select substr(date(now()),6) md,year(now()) yr) BB
    -&gt; ) A;
+------------+
| dttm       |
+------------+
| 2012-02-29 |
+------------+
1 row in set (0.00 sec)

mysql&gt;
</code></pre>

<p>Give it a Try !!!</p>
