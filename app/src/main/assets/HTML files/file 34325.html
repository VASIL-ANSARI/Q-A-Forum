<p>Apparently, the problem was with line:</p>

<pre><code>unset($snames[$sname]);
</code></pre>

<p>for some entries I had names such as "70" and "111"</p>

<p>as the result command:</p>

<pre><code>unset($snames[$sname]);
</code></pre>

<p>removed elements at that position. Not the elements with such keys!! I.e. That's how program understood it:</p>

<pre><code>unset($snames[77]);
</code></pre>

<p>and that's what I was expecting:</p>

<pre><code>unset($snames['77']);
</code></pre>

<p>so the line had to be changed to following:</p>

<pre><code>if(($key = array_search($sname, $snames)) !== false)
{
    unset($snames[$key]);
}
</code></pre>
