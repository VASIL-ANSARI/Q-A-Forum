<p>You are writing single entities at a time. </p>

<p>How about modifing your code to write in batches using <code>ndb.put_multi</code>  that will reduce the round trip time for each transaction.</p>

<p>And why are you using get_or_insert as you are overwriting the record each time. You might as well just write.  Both of these will reduce the workload a lot</p>
