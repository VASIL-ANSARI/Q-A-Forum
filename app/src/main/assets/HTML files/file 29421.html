<p>Per Nacht comment I paste the answer over:</p>

<p>for anyone who interest to know the solution, the cause is simply the system does not support x64. The solution is simply in the c# project's property, make the platform target to be 'any CPU' instead of x86 or x64.</p>

<p>Also, the Get-PSSnapin won't show up the error message but will say it is working fine if you are running it from Visual Studio's command prompt; however running it on powershell command prompt will show you the failing message.</p>
