<p>Calling <code>CloseHandle</code> after <code>SetEvent</code> doesn't make sense to me. You should (if required) call <code>CloseHandle</code> after <code>WaitForSingleObject</code> only.</p>
