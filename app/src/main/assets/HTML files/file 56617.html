<p>It's a scope problem in the correlated subquery, try to use the table name</p>

<pre><code>SELECT d.*, (
    SELECT COUNT(*) FROM `alert` AS a 
    LEFT JOIN `user_to_alert` AS uta ON 
    ( uta.`alert_id` = a.`alert_id`) 
    WHERE  uta.`user_id` = d.`user_id`  AND 
            (uta.`alert_read` = 0 OR uta.`alert_read` IS NULL)) 
            AS user_badge_number 
FROM `user_device` AS d
WHERE d.`device_type` = 'iOS' AND d.`device_active` = 1 
GROUP BY d.`device_token`
</code></pre>
