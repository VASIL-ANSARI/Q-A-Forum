<p><a href="http://php.net/manual/en/function.realpath.php" rel="nofollow">http://php.net/manual/en/function.realpath.php</a></p>

<pre><code>$chroot = '/var/www/site/userdata/';
$basefolder = '/var/www/site/userdata/mine/';

$param = '../../../../etc/password';
$fullpath = realpath($basefolder . $param);

if (strpos($fullpath, $chroot) !== 0) {
  // GOTCHA
}
</code></pre>
