<p><s>You never initialize your <code>buffer</code> variable (or the contents of <code>buffers</code> for that matter), so its value is undefined when you pass it do <code>gtk_text_buffer_insert_at_cursor</code>. You need to make it point to a <code>GtkTextBuffer</code> before you pass it to the function.</s> (According to your comment you initialize your variables in the part of the code you left out, so this paragraph doesn't apply to your real code).</p>

<p>Furthermore you said that your <code>ip_protocol</code> variable is a <code>char</code>, but the second argument to <code>gtk_text_buffer_insert_at_cursor</code> should be a pointer. So it's unsurprising that this causes a segmentation fault.</p>
