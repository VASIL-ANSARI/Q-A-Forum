<p>You have to initialize GDI+, then shut it down before exit.</p>

<pre><code>int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE, PWSTR pCmdLine, int nCmdShow)
{
    Gdiplus::GdiplusStartupInput gdiplusStartupInput;
    ULONG_PTR gdiplusToken;
    Gdiplus::GdiplusStartup(&amp;gdiplusToken, &amp;gdiplusStartupInput, NULL);

    //...

    Gdiplus::GdiplusShutdown(gdiplusToken);

    return 0;
}
</code></pre>

<p><code>graphics.DrawImage(&amp;image, 10, 10);</code> is enough to paint the image. Once you paint the image, don't paint anything else over it.</p>

<p>You can use <code>Example_DrawImage9(hdc)</code> in <code>WM_PAINT</code>. Use <code>FillRect</code> before drawing the image.</p>
