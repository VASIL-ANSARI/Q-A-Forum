<p>The problem is that you need to read directly from the original stream, not a block at a time. (Even if you know every message is exactly 4096 bytes, you cannot be sure to read that much at once)  I suggest you use</p>

<pre><code>while(stream still open) {
    Msg msg = Msg.parseDelimitedFrom(ins);
}
</code></pre>

<p>Note: TCP is a streaming protocol, not  a message protocol.  You are only guaranteed to read one byte at a time, and any extra bytes you get is a bonus.</p>
