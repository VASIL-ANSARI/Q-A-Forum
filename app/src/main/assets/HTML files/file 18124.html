<p>There are a number of problems in <code>countlines()</code>:</p>

<ol>
<li><p>You open the file twice, but overwrite the first <code>FILE *</code> value with the second, so there's no way you can close it.  This is a minor problem.</p></li>
<li><p>The major problem is that the function <code>fgetc()</code> returns an <code>int</code>, not a <code>char</code>.  In particular, <code>EOF</code> is a value different from every <code>char</code>.</p></li>
<li><p>The code does not close the file before returning.  Generally, if you open a file in a function, then you should close it.  If you don't, you have to pass the file pointer back to the calling code so that it can close it.</p></li>
<li><p>The <code>do ... while</code> loop is seldom correct for an input loop (a <code>while</code> loop testing at the top is almost always much cleaner and clearer) but at least you weren't using <code>feof()</code>.</p>

<pre><code>int countlines(char *filename)
{
    FILE *fp = fopen(filename,"r");
    int ch;
    int lines = 0;
    if (fp == 0)
        return lines;

    while ((ch = fgetc(fp)) != EOF)
    {
        if (ch == '\n')
            lines++;
    }

    fclose(fp);

    return lines;
}
</code></pre></li>
</ol>

<p>When you use <code>char</code> instead, one of two things happens:</p>

<ul>
<li>If your <code>char</code> type is <code>signed</code>, then a real character (often Ã¿ â y-umlaut, U+00FF, LATIN SMALL LETTER Y WITH DIAERESIS) also matches <code>EOF</code> so you can stop reading before you reach end of file.</li>
<li>If your <code>char</code> type is <code>unsigned</code>, no value will ever match <code>EOF</code> so the loop will never stop.</li>
</ul>

<hr>

<p>In <code>stringlength()</code>, you have two variables <code>count</code> and <code>k</code> that are carefully kept at the same value; you only need one of the two.</p>

<hr>

<p>Apart from raggedy indentation (endemic in the code shown â and definitely something to be avoided), and the unnecessary and pointless <code>else;</code> which does absolutely nothing, the code for <code>countchars()</code> <s>looks OK</s> (<em>late addition</em>) ... has the condition in the <code>for</code> loop inverted; it should be <code>str[k] != '\0'</code>, of course.</p>
