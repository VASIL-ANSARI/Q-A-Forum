<pre><code>NSString* yourString = @"appname://user=jonsmith&amp;message=blah%20blah";
NSString* queryString = [yourString substringFromIndex:strlen("appname://")];
NSArray* queryArray = [queryString componentsSeparatedByString:@"&amp;"];
NSMutableDictionary* queryDict = [NSMutableDictionary dictionary];
for (NSString* query in queryArray) {
    NSUInteger indexOfEqualsSign = [query rangeOfString:@"="].location;
    if (indexOfEqualsSign != NSNotFound) {
       NSString* key = [[query substringToIndex:indexOfEqualsSign] stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
       NSString* value = [[query substringFromIndex:indexOfEqualsSign+1] stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
       [queryDict setObject:value forKey:key];
    }
}
return queryDict;
</code></pre>

<p>Use an <code>NSScanner</code> if you need to save more memory.</p>
