<p>I'm sure you know this already: in Twig you do translations using the I18n extension. That extension provides a "trans" tag: <a href="http://twig.sensiolabs.org/doc/extensions/i18n.html" rel="nofollow">see i18n docs</a></p>

<p>I see no way you can convert your translation syntax <code>[%Hello world%]</code> into the Twig way <code>{% trans %}Hello world{% endtrans %}</code> by extendling the Lexer class, because <code>{%</code> is a block element and <code>trans</code> a tag defined in the I18n extension. You could build your own translation logic, but I think it is much easier to create a preprocessor that replaces <code>[%</code> with <code>{% trans %]</code> and  <code>%}</code> with <code>{% endtrans %}</code>.</p>

<p>I imagine it could work like this (untested):</p>

<pre><code>class MYTwigEnvironment extends Twig_Environment {
   public function compileSource($source, $name = null) {
     /* 
      * code to replace '[%' with '{% trans %}' in $source 
      * comes here ...
      */
     return parent::compileSource($source, $name = null);
   }
}
</code></pre>

<p>As far as I understand, this way the template caching should stay intact.</p>

<p>regards</p>
