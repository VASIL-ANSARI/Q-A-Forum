<p>To get the column names dynamically you will want to use the following:</p>

<pre><code>SET @cols = STUFF((SELECT ',' + QUOTENAME(MEMBER_PROPERTY) 
            FROM #MEMBER_ATTRIBUTES
            group by MEMBER_PROPERTY, MEMBER_VALUE
            order by MEMBER_VALUE
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')
</code></pre>

<p>This will select the distinct <code>MEMBER_PROPERTY</code> values and convert them to a comma separated list.</p>
