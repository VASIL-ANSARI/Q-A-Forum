<p>You may want to check the small code sample at:</p>

<ul>
<li><a href="http://alexking.org/blog/2003/06/02/inserting-at-the-cursor-using-javascript" rel="nofollow">Inserting at the cursor using JavaScript</a></li>
</ul>

<p>Code from the above article:</p>

<pre><code>function insertAtCursor(myField, myValue) {

  if (document.selection) {
    myField.focus();
    sel = document.selection.createRange();
    sel.text = myValue;
  }
  else if (myField.selectionStart || myField.selectionStart == '0') {
    var startPos = myField.selectionStart;
    var endPos = myField.selectionEnd;

    myField.value = myField.value.substring(0, startPos)
                  + myValue
                  + myField.value.substring(endPos, myField.value.length);
  } else {
    myField.value += myValue;
  }
}

// calling the function
insertAtCursor(document.getElementById('textarea_id'), 'sometext');
</code></pre>
