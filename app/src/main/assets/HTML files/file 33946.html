<p>This query only sets the leading margin for the winners. If you set the DEFAULT value for leadingmargin to 0, or run another query to set those to 0, you'll be good:</p>

<pre><code>UPDATE demo_candidates t1
LEFT JOIN demo_candidates t2
  ON t2.riding = t1.riding
  AND t2.votes &gt; t1.votes
JOIN demo_candidates t3
  ON t3.riding = t1.riding
  AND t3.votes &lt; t1.votes
LEFT JOIN demo_candidates t4
  ON t4.riding = t3.riding
  AND t4.id &lt;&gt; t1.id
  AND t4.votes &gt; t3.votes
SET t1.leadingmargin = t1.votes - t3.votes
WHERE t2.id IS NULL AND t4.id IS NULL
</code></pre>

<p>If there is a tie for winner or there is only one candidate, the leadingmargin won't be set.</p>

<p><strong>UPDATE:</strong></p>

<p>This one sets the <code>0</code>'s too:</p>

<pre><code>UPDATE demo_candidates t1
LEFT JOIN demo_candidates t2
  ON t2.riding = t1.riding
  AND t2.votes &gt; t1.votes
LEFT JOIN demo_candidates t3
  ON t3.riding = t1.riding
  AND t3.votes &lt; t1.votes
LEFT JOIN demo_candidates t4
  ON t4.riding = t3.riding
  AND t4.id &lt;&gt; t1.id
  AND t4.votes &gt; t3.votes
SET t1.leadingmargin = IF(t2.id IS NULL AND t4.id IS NULL, t1.votes - t3.votes, 0)
</code></pre>
