<p>A library? Probably not. Software you wish for rarely exists.  That usually means you have to build it yourself or go without.</p>

<p>What you need is </p>

<ul>
<li>a parser of SQL queries, </li>
<li>a parser of user-capabilities (which user is allowed to update which tables/columns,</li>
<li>a SQL analyzer that can tell which user might be running a bit of SQL, and which tables/fields the SQL is modifying.</li>
</ul>

<p>Doing all of this is straightforward using classic static analysis techniques.  You may have to go learn this if you want to code your own answer.</p>
