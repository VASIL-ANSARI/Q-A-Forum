<p>If you <em>must</em> use files (as @aix has said, there may be better ways), don't try to read files as they are being written or the results will be undefined.</p>

<p>Instead, write the data to a different filename, close it, and then move it to the right place (on Linux, use <code>rename()</code>).</p>

<p>If you don't like that, try using file locks. On Linux, at least, these don't actually prevent access to the file, they just act as inter-process mutexes. You don't say what OS you have, but for Linux, see <code>man 2 flock</code>.</p>
