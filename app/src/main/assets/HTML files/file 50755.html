<p>It seems you are struggling with <em>local</em> and <em>instance</em> variables in Ruby. Please see <a href="http://strugglingwithruby.blogspot.dk/2010/03/variables.html" rel="nofollow">this blog post</a> for more information.</p>

<p>When you call <code>event["result"] = ML.Process(event["text"])</code> ruby tries to find a local variable named <code>ML</code> which doesn't exist. Therefore you get <code>undefined local variable or method ML.Process(event["text"])</code>. So, messing around with your variables might solve your problem.</p>

<p><code>@ML</code> is an instance variable and is available in all methods calling it using <code>@ML</code> or <code>self.ML</code>. Please try this:</p>

<pre><code>public
def filter(event)
   event["result"] = @ML.Process(event["text"])
   filter_matched(event)
end 
</code></pre>

<p>Things I stumbled upon:</p>

<ul>
<li>Where do <code>MLVectorPath</code> and <code>MLStopWordPath</code> come from?</li>
<li>What is <code>StringPath</code>? It is assigned but never used.</li>
<li>Do you have a field <code>text</code>? Otherwise change <code>event["text"]</code> into <code>event["message"]</code>.</li>
</ul>

<p>However, I know neither your Java code nor your logstash configuration so these things may be okay. Please let me know if this helps.</p>
