<p>You're base64-encoding the string <code>"5baa61..."</code>, not <code>"\x5b\xaa\x61..."</code></p>

<p>Change <code>hexdigest</code> to <code>digest</code>:</p>

<pre><code>sha1 = Digest::SHA1.digest('password')
base64 = Base64.strict_encode64(sha1)
</code></pre>
