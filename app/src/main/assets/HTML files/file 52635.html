<p>You can select an anonymous type and then use <code>GroupBy</code>:</p>

<pre><code>double[] dailyavgs = vals
    .Select((v, i) =&gt; new { Date = DateTime.FromOADate(dates[i]).Date, Value = v })
    .GroupBy(x =&gt; x.Date)
    .Select(g =&gt; g.Average(x =&gt; x.Value))
    .ToArray();
</code></pre>

<p>Another similar approach using <a href="https://msdn.microsoft.com/library/dd267698(v=vs.100).aspx" rel="nofollow"><code>Enumerable.Zip</code></a>:</p>

<pre><code>double[] dailyavgs = vals
    .Zip(dates, (v, d) =&gt; new { Date = DateTime.FromOADate(d).Date, Value = v })
    .GroupBy(x =&gt; x.Date)
    .Select(g =&gt; g.Average(x =&gt; x.Value))
    .ToArray();
</code></pre>

<p>The latter has one advantage: it doesn't throw an exception if both arrays don't have the same size: <em>" If the input sequences do not have the same number of elements, the method combines elements until it reaches the end of one of the sequences. For example, if one sequence has three elements and the other one has four, the result sequence has only three elements"</em></p>
