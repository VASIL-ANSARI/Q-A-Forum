<p>I'm guessing that you're falling into the second "if" statement's "else" condition without opendialog ever being defined. You'll need to make sure it's initialized somehow in every case, not just in two of the three. Otherwise that last "if" statement will fail. So make sure you add</p>

<pre><code>opendialog = wx.FileDialog(self, "Choose a file", "", "", "*.csv", wx.MULTIPLE)
</code></pre>

<p>to the end of the second "if" statement and it will work in all cases.</p>
