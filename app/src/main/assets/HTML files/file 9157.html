<p>I don't think you need to login the user and duplicate the handle. All you need to do is set the username, domain, and password in the ProcessStartInfo object. That's been available since .NET 3.0 if I recall correctly.</p>

<p>EDIT:</p>

<p>Also for more information, this is what really happens when you give username/domain/password to ProcessStartInfo: <a href="http://support.microsoft.com/kb/165194">http://support.microsoft.com/kb/165194</a>. The reason for access denied is probably that you don't have access to the user's desktop or windowstation. Just calling LoginUser is not sufficient.</p>
