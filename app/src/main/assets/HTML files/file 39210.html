<p>I ran into the same problem while testing today. From what I could see, the Handlers don't have view of the state of the Web Service. If this is something specific to Arquillian, I'm not sure.</p>

<p>However, this isn't a problem as the <code>SOAPMessageContext</code> parameter to the <code>handleMessage</code> method extends the <code>MessageContext</code> interface, so you should be able to access almost anything you need directly from the <code>SOAPMessageContext</code> without needing access to the <code>WebServiceContext</code>. The only obvious exception I could see was the user principal.</p>

<pre><code>@Override
public boolean handleMessage(SOAPMessageContext soapMessageContext) {
  String value = (String) soapMessageContext.get("myKey");
}
</code></pre>

<p>Just one additional comment, if you want to put an object into the <code>MessageContext</code> map and also want it available inside your endpoint, make sure to set the scope:</p>

<pre><code>soapMessageContext.put("myKey", "someValue");
soapMessageContext.setScope("myKey", MessageContext.Scope.APPLICATION);
</code></pre>
