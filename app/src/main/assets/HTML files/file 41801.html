<p>You are checking the <code>innerHTML</code> of the <code>a</code> element. You should be testing against the <code>outerHTML</code> instead. The <code>innerHTML</code> value will <em>never</em> contain the attributes and thus will <em>never</em> contain the <code>_blank</code> value you are testing for. (Well, unless you can have a contract named <code>_blank</code>, which does not appear likely.) Let's take an example:</p>

<pre><code>&lt;a class="" target="_blank" href="/DibsAndrew/CreditControl/AgreementDetail.aspx?contractno=254052"&gt;254052&lt;/a&gt;
</code></pre>

<p>The <code>innerHTML</code> of the above is <code>254052</code> because the <code>innerHTML</code> covers only what is inside the element. The <code>outerHTML</code> is the entire string above because the <code>outerHTML</code> covers the <em>element itself</em> plus its contents.</p>

<p>Ok, so what I suggested above would take care of the immediate problem. However, <strong>I would strongly suggest changing your test to something better than matching a string in the HTML</strong>. For instance, if the <code>a</code> element is added in its parent cell only after the contract is loaded, you should test for the presence of the <code>a</code> element in the cell.</p>
