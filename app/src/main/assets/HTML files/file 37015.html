<p>Answer rewritten in view of clarification: <code>libATA</code> is what you want. It's what <code>hdparm</code> calls and it reports the transport too. It's hard to find up to date docs on it though. See <a href="http://docs.huihoo.com/linux/kernel/2.6.26/libata/index.html" rel="nofollow">http://docs.huihoo.com/linux/kernel/2.6.26/libata/index.html</a> for example.</p>

<p>I have not used libATA (directly) myself, so I can't be more specific as to the API calls needed. Since not many people need to write something like hdparm themselves, your best bet is to consult its sources to see what exactly it calls.</p>

<p>hdparm can report stuff like:</p>

<pre><code>[root@alarmpi ~]# hdparm -I /dev/sdb

/dev/sdb:

ATA device, with non-removable media
   Model Number:       TOSHIBA DT01ACA200                      
   Serial Number:      Z36GKMKGS
   Firmware Revision:  MX4OABB0
   Transport:          Serial, ATA8-AST, SATA 1.0a, SATA II Extensions, SATA Rev 2.5, SATA Rev 2.6, SATA Rev 3.0; Revision: ATA8-AST T13 Project D1697 Revision 0b
</code></pre>

<p>If your actual problem is that only sdparm works on your system for SCSI drives (can happen) then it seems the problem is reduced to figuring out which of hdparm or sdparm to call isn't it? You could use <code>udevinfo</code> for that. See <a href="https://chromium.googlesource.com/chromiumos/third_party/laptop-mode-tools/+/775acea9e819bdee90cca8d2363827c13967a14b/laptop-mode-tools_1.52/usr/share/laptop-mode-tools/modules/hdparm" rel="nofollow">https://chromium.googlesource.com/chromiumos/third_party/laptop-mode-tools/+/775acea9e819bdee90cca8d2363827c13967a14b/laptop-mode-tools_1.52/usr/share/laptop-mode-tools/modules/hdparm</a> for example.</p>
