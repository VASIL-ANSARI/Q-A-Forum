<p>Actually, the .Net <code>RNGCryptoServiceProvider</code> class obtains random data from a "Cryptographic Service Provider" (CSP) (so says <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx" rel="nofollow">the documentation</a>). In the CryptoAPI, a CSP is a loadable DLL which provides some cryptographic services, mainly private key storage, signature computations... and also random number generation. A CSP can be used only if it has been signed (by Microsoft) and registered (by writing in some specific registry keys).</p>

<p>The <code>CryptGenRandom()</code> function uses the default CSP (the one registered as to be used by default, normally one of the CSP which come with the operating system itself) and invokes the <code>CPGenRandom()</code> function on that CSP. <code>RNGCryptoServiceProvider</code> does the same. Hence, it does <em>not</em> call <code>CryptGenRandom()</code>, but it feeds on the same cryptographically strong source.</p>
