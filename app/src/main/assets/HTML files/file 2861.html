<p>@@identity is usually wrong in sql server as well.  You should be using <code>scope_identity()</code> in most cases instead.</p>

<p>In MySql, last_insert_id() should be safe to use because the only way you can call this function after an insert error is you've already correctly caught and accounted for the insert error.  Otherwise you would still be processing commands.  In other words, last_insert_id() is not your error-handling mechanism.</p>
