<p>Seems like you got it all backwards. First of all, let's talk about the Liskov Substitution Principle. It says that any type should be replaceable by the base type. This also apply to the visitor pattern.</p>

<p>If you have a method called <code>void Accept(IVisitor visitor)</code>, it should not matter if a <code>FancyVisitor</code> or a <code>SipleVisitor</code> that is visiting.</p>

<p>The whole idea with the visitor pattern is that the <em>subject</em> (i.e. the class that is being visited) should not know anything about the visitor more than the contract (base class or interface) that it implements. And each <code>Visitor</code> class should be specific for a certain class being visited.</p>

<p>And that's the problem with your code. You are trying to make a general Visitor class that can visit all your system components. That's plain wrong.</p>

<p>As I see it, you have two options:</p>

<p><strong>You want to collect the same kind of information from all system components.</strong></p>

<p>Easy. Create a new interface which all system components implement. Then change the visitor to <code>Visit(ISystemCompoent subject)</code>.</p>

<p><strong>You want to collect different kinds of information from each system component</strong></p>

<p>Then you need to create <em>different</em> visitor base classes (or interfaces).</p>
