<p>You are not closing the last parenthesis and there is an extra comma:</p>

<pre><code>            + "order by 1,2') AS openbook_comp (team_manager text, "
            + "compliance_1 varchar,"
            + "compliance_2 varchar,"
            + "compliance_3 varchar)"
</code></pre>

<p>And you can use this:</p>

<pre><code>            + "extract(day from date_compliance) in (1, 2, 3) "
</code></pre>

<p>If <code>center</code> is numeric don't use quotes and add a space after the parameter:</p>

<pre><code>             + "and center = ? "
</code></pre>

<p>If it is not numeric try it like this:</p>

<pre><code>            + "and center = '''?''' "
</code></pre>
