<p>I haven't looked closely at your code, but I have in the past found behavior like you describe in the title when I did not link the executable with <code>-E</code>.  (Or <code>-Wl,-E</code> when linking with <code>gcc</code> rather than <code>ld</code>.)</p>

<p>Note that not all platforms let the shared libraries take symbols from the calling binary.  Linux and the *BSDs allow you to.  But if you ever want to port to, say, Windows, you will not be able to use this pattern.  I believe there are also some Unix-type OS's that won't let you do this.  (It's been a while so I don't remember...  Maybe it was Solaris?)</p>
