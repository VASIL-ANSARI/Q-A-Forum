<p>I have done that in one of my extensions, <a href="https://github.com/mohamedmansour/fb-exporter" rel="nofollow">Facebook Friend Exporter</a>,   feel free to take a look. It uses Facebook to get your friends contact information (including Email), and exports them to Gmail as a new contact. That requires permissions from Google and Facebook which is similar to yours.</p>

<p>Since you would need to inject code to Facebook or Google, you must use <a href="http://code.google.com/chrome/extensions/content_scripts.html" rel="nofollow">Content Scripts</a>. Content Scripts allow you to run JavaScript code in the context of the web page. You can use standard DOM to extract/read stuff from that webpage and make changes to them.</p>

<p>In your manifest.json, you would need to define it as follows:</p>

<pre><code>{
  "name": "My extension",
  ...
  "content_scripts": [
    {
      "matches": ["http://*.google.com/*", "http://*.facebook.com/*"],
      "css": ["injected_styles.css"],
      "js": ["injected_script.js"],
      "all_frames": true
    }
  ],
  ...
}
</code></pre>

<p>For more info regarding the patterns for the matches, you can read about it in the <a href="http://code.google.com/chrome/extensions/match_patterns.html" rel="nofollow">Match Patterns</a> documentation. Remember, the top Content Script match only allows you to inject on the ".com" domains. Just take that into account, if you want more match domains, you need to input them there one by one. (I know this is problematic, but it is for security reasons)</p>

<p>Remember, for complex websites like Google Mail (gmail), it uses iframes usually to represent its DOM. That is why I placed "all_frames: true" because I want that content script to run in all frames of the pages not just the top frame. </p>

<p>Hope that helps!</p>
