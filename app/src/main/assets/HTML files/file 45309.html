<p>The way POP3 works is that the DELE command that is sent by the <code>DeleteMessage()</code> method doesn't actually delete the message, all it does is mark it for future deletion when the POP3 client disconnects using the QUIT command.</p>

<p>I'm not sure how ActiveUp's POP3 client works, but mine (<a href="https://github.com/jstedfast/MailKit" rel="nofollow">MailKit</a>) will only send the QUIT command if you call <code>client.Disconnect (true);</code> (<code>true</code> is the quit argument).</p>

<p>Also, FWIW, the Message-Id header is not the same as a unique id. Be careful using that as your mechanism for identifying messages in any sort of unique way as Message-Ids are not necessarily unique nor is it a secure way of identifying messages. Clients that use Message-Ids in this way are open to DoS attacks where a hacker can send you an email with an identical Message-Id and force you to map it to the wrong message.</p>
