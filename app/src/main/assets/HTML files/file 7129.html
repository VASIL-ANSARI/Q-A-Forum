<p>With the following code you can do any query.. But if one errors the querys are rolledback.</p>

<pre><code>BEGIN TRANSACTION
BEGIN TRY

    //do every query you need. if one errors it everything is off.

    COMMIT TRANSACTION
END TRY
BEGIN CATCH
   SELECT 
       ERROR_NUMBER() AS ErrorNumber,
       ERROR_SEVERITY() AS ErrorSeverity,
       ERROR_STATE() AS ErrorState,
       ERROR_PROCEDURE() AS ErrorProcedure,
       ERROR_LINE() AS ErrorLine,
       ERROR_MESSAGE() AS ErrorMessage

   ROLLBACK TRANSACTION
END CATCH
</code></pre>
