<p>What is the problem?  Are you getting worse performance with OpenMP than without?  OpenMP has an overhead to use so if <code>somefunction</code> is fast and you're only running over 100 elements then OpenMP could give worse performance.</p>

<p>I don't see a problem with each thread accessing M.  As long as <code>somefucntion</code> does not write to M or N (only reads from them) there should be no problem.</p>

<p>You do, however, have a problem with false sharing in <code>result</code> but I don't know how much effect it has on your performance in your case without testing the full code.</p>
