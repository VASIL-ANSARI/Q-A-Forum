<pre><code>std::getline(iss, ch, ',');
</code></pre>

<p>will fail to read the last field. To account for that replace the line</p>

<pre><code>if (!iss.good()) break;
</code></pre>

<p>with the following:</p>

<pre><code>if (!iss.good())
{
   iss.clear();
   std::getline(iss, ch);
   if ( !iss.good() ) // This is a real problem.
      exit(EXIT_FAILURE);
}
</code></pre>
