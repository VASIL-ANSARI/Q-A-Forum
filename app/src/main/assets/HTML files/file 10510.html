<p>Application data (HTTP chat data) in ipv4 packets can be fragmented, i.e. single ipv4 packet may not contain full string "application/json" or "\"msg\":{\"text\"".</p>

<p>Better approach would be to capture higher level HTTP traffic (preparsed by pcap). Here's related information about HTTP traffic sniffing - <a href="http://serverfault.com/questions/84750/monitoring-http-traffic-using-tcpdump">http://serverfault.com/questions/84750/monitoring-http-traffic-using-tcpdump</a></p>

<p>Having HTTP traffic dump you can parse messages in more consistent fashion and be sure that fragmentation is not an issue</p>
