<p>The cleanest way to do this is to give the clients something other than a subclass of <code>InputStream</code>, even if this means slightly more refactoring. In your current design, you can't count on your clients releasing the lock, what if one of them does not? This is not good encapsulation.</p>

<p><strong>Have the archive object manage the locks, and provide an easy API for your clients to get the data</strong>. Even if this means changing some APIs.</p>

<p>The problem of different threads locking and releasing the same object is a clear sign that you got something slightly wrong in your current design. Work on the refactoring aforementioned, it will do you a great deal further on.</p>
