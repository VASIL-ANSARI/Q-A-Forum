<p>Seems like you're missing several steps.
In fact you need to calculate a world_to_view matrix, according to your camera rotation and position, then multiply your world_to_view matrix by the projection_matrix to get the transform_matrix, then you have to multiply the in_world coordinates in order to get "in view" coordinates.
Then you have to project the obtained coordinates to screen (2D) space using the following formula (that's the one I use) :</p>

<pre><code>onscreen.x = ((camera.zfar / vertex.in_view.z) * vertex.in_view.x - camera.fov) + screen.width / 2.0;
onscreen.y = ((scene.zfar / vertex.in_view.z) * vertex.in_view.y - camera.fov) + screen.height / 2.0;
</code></pre>

<p>I know my method is far from perfect (I am looking for a better way to do this) and that I threw away some matrix multiplications in the process, but I found it by myself and it's working. ;-)
And also, you don't NEED a lookat_matrix, but it can be very usefull (it can be used for backface culling for instance)</p>
