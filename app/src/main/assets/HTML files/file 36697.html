<p>I believe what you are looking for is</p>

<pre><code>SELECT t1.Product, 
    CASE 
        WHEN MAX(t1.Price) &gt;= MAX(t2.Price) THEN MAX(t1.Price)
        WHEN MAX(t2.Price) &gt; MAX(t1.Price)  THEN NULL
        ELSE COALESCE(MAX(t1.Price), MAX(t2.Price)) 
    END AS Price,
    CASE 
        WHEN MAX(t1.Price) &gt;= MAX(t2.Price) AND MAX(t1.Tax) &gt;= MAX(t2.Tax) THEN MAX(t1.Tax)
        WHEN MAX(t1.Price) &gt;= MAX(t2.Price) AND MAX(t1.Tax) &lt; MAX(t2.Tax)  THEN NULL
        ELSE COALESCE(MAX(t1.Tax), MAX(t2.Tax)) 
    END AS Tax
   FROM #Temp t1
   LEFT JOIN #Temp1 t2
   ON t1.Product = t2.Product 
   GROUP BY t1.Product, t2.Product
</code></pre>
