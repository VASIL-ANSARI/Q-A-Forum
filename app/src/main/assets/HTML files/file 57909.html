<p><strong>Use <a href="http://www.chiark.greenend.org.uk/~sgtatham/xtruss/" rel="nofollow">xtruss</a></strong> â <em>an easy-to-use X protocol tracing program</em></p>

<blockquote>
  <hr>
  
  <p><strong>Overview</strong></p>
  
  <p>Any programmer accustomed to writing programs on Linux or System V-type Unixes will have encountered the program variously known as strace or truss, which monitors another program and produces a detailed log of every system call the program makes â in other words, all the program's interactions with the OS kernel. This is often an invaluable debugging tool, and almost as good an educational one.</p>
  
  <p>When it's a GUI program (or rather, the GUI-related behaviour of a program) that you want to understand or debug, though, the level of interaction with the OS kernel is rarely the most useful one. More helpfully, one would like to log all the program's interactions with the X server in the same way.</p>
  
  <p>Programs already exist that will do this. I'm aware of Xmon and Xtrace. But they tend to require a lot of effort to set up: you have to run the program to establish a listening server, then manually arrange for the target program to contact that instead of the real server â including some fiddly work with xauth. Ideally, you'd like tracing a program's X operations to be just as easy as tracing its kernel system calls: you'd like to type a command as simple as strace program-name arguments, and have everything automatically handled for you.</p>
  
  <p>Also, the output of those programs is less easy to read than I'd have liked â by which I largely mean it's less like strace than I'd like it to be. strace has the nice property of putting each system call and its return value on the same line of output, so that you can see at a glance what each response was a response to. X protocol monitors, however, tend to follow the structure of the X protocol faithfully, meaning that each request and response is printed with a sequence number, and you have to match the two up by eye.</p>
  
  <p>So this page presents xtruss, my own contribution to the field of X protocol loggers. It has a command-line syntax similar to strace â in its default mode, you just prefix "xtruss" to the same command line you would have run anyway â and its output format is also more like strace, putting requests and responses on the same line of output where reasonably possible.</p>
  
  <p>strace also supports the feature of attaching to an already-running process and tracing it from the middle of its run â handy when something goes wrong with a long-running process that you didn't know in advance you were going to need to trace. xtruss supports this same feature, by means of the X RECORD extension (provided your X server supports it, which modern X.Org ones do); so in that mode, you can identify a window with the mouse (similarly to standard programs like xwininfo and xkill), and xtruss will attach to the X client program that owns the window you specified, and begin tracing it.</p>
  
  <hr>
  
  <p><strong>Description</strong></p>
  
  <p>xtruss is a utility which logs everything that passes between the X server and one or more X client programs. In this it is similar to xmon(1), but intended to combine xmon's basic functionality with an interface much more similar to strace(1).</p>
  
  <p>Like xmon, xtruss in its default mode works by setting up a proxy X server, waiting for connections to that, and forwarding them on to the real X server. However, unlike xmon, you don't have to deal with any of that by hand: there's no need to start the trace utility in one terminal and manually attach processes to it from another, unless you really want to (in which case the -P option will do that). The principal mode of use is just to type xtruss followed by the command line of your X program; xtruss will automatically take care of adjusting the new program's environment to point at its proxy server, and (also unlike xmon) it will also take care of X authorisation automatically.</p>
  
  <p>As an alternative mode of use, you can also attach xtruss to an already-running X application, if you didn't realise you were going to want to trace it until it had already been started. This mode requires cooperation from the X server â specifically, it can't work unless the server supports the RECORD protocol extension â but since modern X.Org servers do provide that, it's often useful.</p>
</blockquote>
