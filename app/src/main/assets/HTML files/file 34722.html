<p>It is better to define two methods in your controller.</p>

<p>First : </p>

<pre><code>function check_old_passwd($pass){
//for set custom validation message
$this-&gt;form_validation-&gt;set_message('check_old_passwd', 'your custom message');
//{check in db...}
       if(true){
       return true;
       }
return false
}
</code></pre>

<p>Second :</p>

<pre><code>function is_newpasswd_correct($newpass){
//for set custom validation message
$this-&gt;form_validation-&gt;set_message('is_newpasswd_correct', 'your custom message');
//check if new password is in your site terms
//not smaller than 4 digits etc.
if(true){
return true;
}
return false;
}
</code></pre>

<p>Then use callback in your validation rules :</p>

<pre><code>$this-&gt;form_validation-&gt;set_rules('oldpass', 'Old Password', 'required|trim|callback_check_old_passwd');

$this-&gt;form_validation-&gt;set_rules('newpass', 'New Password', 'required|trim|callback_is_newpasswd_correct');
</code></pre>

<p>Hope it will helps you</p>
