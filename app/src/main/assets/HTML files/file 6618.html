<p>After several days of torture and the many hours I gave up one thing, and it is that links will be as I want.</p>

<p>I never managed to do that links for languages, other than the default link, looks like:</p>

<p>nopcommerce.com / country / category / name-of-category</p>

<p>The closest I've managed to achieve is to link me look</p>

<p>nopcommerce.com / category / country / name-of-category.</p>

<p>I also managed to make the links that we are not classic ImageButton than regular hyperlink and links that I stumbled on an interesting problem.</p>

<p>NopCommerce use  cookie to change the language.</p>

<p>I found the name of the cookie, and as he writes it into NopContext.Current.WorkingLanguage.</p>

<p>In a similar way, I also created a javascript function setCookie ()</p>

<pre><code>function setCookie(c_name, value, expiredays) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + expiredays);
    document.cookie = c_name + "=" + escape(value) +
        ((expiredays == null) ? "" : ";expires=" + exdate.toUTCString());
}
</code></pre>

<p>which creates a log value of the selected language in the cookie and which activates when a user clicks on the flag of the selected language.</p>

<p>eg</p>

<pre><code>string coockie = String.Format("javascript:setCookie('{0}','{1}','{2}');", "Nop.CustomerLanguage", language.LanguageId.ToString(), new TimeSpan(365, 0, 0, 0, 0));
hpLanguage.Attributes.Add("onclick", coockie);
</code></pre>

<p>And now we come to the interesting part where the problem occurs and it is not clear to me why it happens.</p>

<p>Suppose we have German and English</p>

<p>When I first click on the flag of the German language, in the address bar shows me a link to the German language, but the content is still in English. Only when the second time, (again) I click the flag in the German language the content of the page is switch to German language.</p>

<p>I do not understand why this is happening now to me? </p>
