<p>You should check the results of fopen and fprintf.  This works for me:</p>

<pre><code>#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;

int
main(int argc, char *argv[])
{
  FILE *outFilePtr;

  outFilePtr = fopen("asdf.mc", "w");
  if(!outFilePtr) {
    perror("Couldn't open it");
    fprintf(stderr, "errno:  %d\n", errno);
    exit(-1);
  }
  if(fprintf(outFilePtr, "%s\n", "1001") &lt; 0)
  {
    fclose(outFilePtr);
    perror("Couldn't write to it");
    fprintf(stderr, "errno:  %d\n", errno);
    exit(-1);
  }
  fclose(outFilePtr);
}
</code></pre>

<p>If there is a problem opening the file (permissions, etc), perror will show it.  For example, using an empty string for the filename gave me this in a window$ machine:</p>

<pre><code>Couldn't open it: Invalid argument
errno:  22
</code></pre>

<p>If I close outFilePtr before the fprintf, this error gets displayed:</p>

<pre><code>Couldn't write to it: Bad file descriptor
errno:  9
</code></pre>
