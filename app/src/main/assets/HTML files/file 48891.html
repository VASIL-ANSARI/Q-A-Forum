<pre><code>$fp = fopen('php://memory', 'w+');

// replace $rows with your iterator
foreach ($rows as $row) {
    fputcsv($fp, $row);
}

fseek($fp, 0);

$csv = '';

while (!feof($fp)) {
    $csv .= fread($fp, 1024 * 8);
}

echo $csv;
</code></pre>
