<p>this can be solved with the Impersonator class:</p>

<p><a href="http://www.codeproject.com/KB/cs/zetaimpersonator.aspx" rel="nofollow">http://www.codeproject.com/KB/cs/zetaimpersonator.aspx</a></p>

<p>or this ImpersonateUser function:</p>

<p><a href="http://www.codeproject.com/KB/cs/cpimpersonation1.aspx" rel="nofollow">http://www.codeproject.com/KB/cs/cpimpersonation1.aspx</a></p>

<p>some other options are to execute <code>RunAs /user:administrator "program"</code></p>

<p>or add this to your original app's .manifest file (so privs are requested once at the start)</p>

<pre><code>&lt;requestedPrivileges&gt;
  &lt;requestedExecutionLevel level="requireAdministrator" /&gt;
&lt;/requestedPrivileges&gt;
</code></pre>
