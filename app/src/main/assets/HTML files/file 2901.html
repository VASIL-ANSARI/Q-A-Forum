<p>This isn't originally my code, however, it's worth posting. The original can be found here: <a href="http://code.activestate.com/recipes/117119/" rel="nofollow">http://code.activestate.com/recipes/117119/</a></p>

<pre><code>def gen_primes():
  D = {}
  q = 2  # first integer to test for primality.

  while True:
    if q not in D:
      # not marked composite, must be prime  
      yield q 

      #first multiple of q not already marked
      D[q * q] = [q] 
    else:
      for p in D[q]:
        D.setdefault(p + q, []).append(p)
      # no longer need D[q], free memory
      del D[q]

    q += 1
</code></pre>

<p>It's a generator, so use it like any other.</p>

<pre><code>primes = gen_primes()
for p in primes:
  print p
</code></pre>

<p>It takes 1.62s to generate and put into a set, 1 million primes, on my desktop.</p>
