<p>Hat Tip to Mark Peters for pointing in the correct direction.</p>

<p>DbParameterList exists to pass list to SQL (e.g. try to find people with last names "Smith", "Doe", or "Jones" in a single statement).  This avoids ugly constructs with interpolated IN (...) lists in the SQL.  To do this, the class implements the IEnumerable interface.  I made the assumption that Microsoft would use their own interfaces correctly.  In this case, I assumed that before enumerating across the IEnumerable, they would call the Reset() method on the IEnumerable. However, they do not. </p>

<p>The first time the DbParameterList was called the enumerator was at the beginning and everything worked correctly.  The second call would crash the connection (yes, if the IEnumerable used in an SqlParameter is empty the connection crashes) because the enumerator was never reset.</p>

<p>So, adding a Reset() call to the enumerator at the time it is attached to the SqlCommand corrects the problem.</p>
