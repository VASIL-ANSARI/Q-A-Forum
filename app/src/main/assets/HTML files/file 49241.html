<p>You may want to compute all the pairs separately and then collect the pairs you want.</p>

<pre><code>def get_pairs(l, difference):
    pairs = []
    # first compute all pairs: n choose 2 which is O(n^2)
    for i in xrange(len(l)):
        for j in xrange(i+1, len(l)):
            pairs.append((l[i], l[j]))

    # collect pairs you want: O(n^2)
    res = []
    for pair in pairs:
        if abs(pair[0] - pair[1]) &lt;= difference:
            res.append(pair)
    return res

&gt;&gt;&gt; get_pairs([1,2,3,4,2], 0)
&gt;&gt;&gt; [(2, 2)]
&gt;&gt;&gt; get_pairs([1,2,3,4,2], 1)
&gt;&gt;&gt; [(1, 2), (1, 2), (2, 3), (2, 2), (3, 4), (3, 2)]
</code></pre>

<p>If you want to remove duplicates from you result, you can convert the <code>res</code> list to a set before you return it with <code>set(res)</code>.</p>
