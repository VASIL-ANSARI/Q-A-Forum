<p>I'm still learning LINQ but this seems to work</p>

<pre><code>var result = from t1 in table1
             from t2 in table2
             where t1.key == t2.key &amp;&amp; DateTime.Parse("2010-02-01") &lt;= t1.trndate &amp;&amp; t1.trndate &lt;= DateTime.Parse("2010-02-28")
             group new {t1,t2} by t1.vat into g
             select new { vat = g.Key, sum = g.Sum(p =&gt; p.t1.QTY*p.t2.FLG01 + p.t1.QTY*p.t2.FLG04)};
</code></pre>

<p>I hope in translates well to LINQ to SQL because I only tried it on objects.</p>
