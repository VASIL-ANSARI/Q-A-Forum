<p>You don't need Python for this.  This is a task for SQL.</p>

<p><a href="http://sqlitebrowser.org/" rel="nofollow">SQLite Browser</a> supports CSV Import.  Take the below steps to get the desired output:</p>

<ul>
<li>Download and install SQLite Browser</li>
<li>Create a new Database</li>
<li>Import both CSV's as tables (let's say the table names are file1 and file2, respectively)</li>
</ul>

<p>Now, you can decide how you want to match the data sets.  If you only want to match the files on ID, then you can do something like:</p>

<pre><code>select *
from file1 f1
  inner join file2 f2
    on f1.id = f2.id
</code></pre>

<p>If you want to match on every column, you can do something like:</p>

<pre><code>select *
from file1 f1
  inner join file2 f2
    on f1.id = f2.id and f1.name = f2.name and f1.gender = f2.gender
</code></pre>

<p>Finally, simply export the query results back to a CSV.</p>

<p>I spent a lot of time myself trying to perform tasks like this with scripting languages.  The benefit of using SQL is that you simply tell what you want to match on, and then let the database do the optimization for you.  Generally, it ends up doing the matching faster than any code I could write.</p>

<p>In case you're interested, python also has a sqlite module that comes out-of-the-box.  I've gravitated towards using this as my source for data in python scripts for the above reason, and I simply import the CSV's required in SQLite browser before running the python script.</p>
