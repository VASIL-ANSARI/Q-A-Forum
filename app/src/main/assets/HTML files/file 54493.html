<p>Problem:</p>

<pre><code>p-&gt;type = (char*)malloc(sizeof(type));   // That's just the size of a pointer
p-&gt;address = (char*)malloc(sizeof(address)); // Same problem.
</code></pre>

<p>After that, the lines:</p>

<pre><code>strcpy(p-&gt;type, type);
strcpy(p-&gt;address, address);
</code></pre>

<p>end up writing over memory they are not supposed to. That leads to undefined behavior.</p>

<p>You need:</p>

<pre><code>p-&gt;type = malloc(strlen(type)+1);
p-&gt;address = malloc(strlen(address)+1);
</code></pre>

<p>See <a href="http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc">Do I cast the result of malloc?</a></p>

<p>You can also use <code>strdup</code> if it is supported by your compiler. If so, your code can be simplified to:</p>

<pre><code>p-&gt;type = strdup(type);
p-&gt;address = strdup(address);
</code></pre>
