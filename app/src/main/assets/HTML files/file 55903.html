<p><a href="http://en.cppreference.com/w/cpp/numeric/valarray" rel="nofollow"><code>std::valarray</code></a> overloads a subset of mathematical operations so that they are applied to each element independently. <a href="http://en.cppreference.com/w/cpp/numeric/complex/conj" rel="nofollow"><code>std::conj</code></a> is not one of them. For those that are not overloaded for <code>std::valarray</code>, one can use the <a href="http://en.cppreference.com/w/cpp/numeric/valarray/apply" rel="nofollow"><code>std::valarray&lt;T&gt;::apply(F)</code></a> member function:</p>

<pre><code>auto op = [](CArray::value_type v) { return std::conj(v); };

auto nf1 = ((x * x.apply(op)) * (x2 * x2.apply(op)));
//                 ~~~~~~~~^             ~~~~~~~~^
</code></pre>
