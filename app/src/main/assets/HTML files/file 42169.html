<p>You would want to check the currently logged in user against a list of users who were authorized to use the requested resource. You would want to run this check right after returning data from the database, but before outputting it to the user.</p>

<pre><code>$user = isset($_SESSION['user_id']) ? $_SESSION['user_id'] : '';    
if(!in_array($user, $authorized_users)){
    header('HTTP/1.1 403 Forbidden');
    die("&lt;h1&gt;Sorry $user! You are not approved for accessing this resource.&lt;/h1&gt;
    &lt;br&gt;Please contact the webmaster if this is in error&lt;br&gt;");
}
</code></pre>

<p>I'm not sure how your included code above fits into actually displaying content to the user, but you would use this code snippet to exit the PHP script if the user requesting the resource wasn't in the list of users that were authorized to view it.</p>
