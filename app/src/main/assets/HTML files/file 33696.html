<p>Firstly, you can execute a block on the main thread using <code>dispatch_sync</code>. But that's not really the problem here. You're trying to do too much in one block of code. </p>

<p>Your flow needs to look something like this:</p>

<ol>
<li>Have you recorded a username/password?</li>
<li>If not, ask for one</li>
<li>Run your network request</li>
<li>Error handling would include looking for invalid credentials, in which case the request would be cancelled and your code would jump to step 2. </li>
</ol>
