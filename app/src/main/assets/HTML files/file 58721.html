<p>Just use conditional aggregation:</p>

<pre><code>SELECT contact_email, SUM(rent_end IS NULL) as not_returned_devices,
       SUM(rent_end IS NOT NULL) as returned_devices
FROM device_rent
GROUP BY contact_email;
</code></pre>

<p>Note that this uses a MySQL short-cut, where boolean expressions are treated as "1" for true and "0" for false.  This is a convenience, and save you from writing a <code>case</code> statement.  That would look like:</p>

<pre><code>SELECT contact_email,
       SUM(CASE WHEN rent_end IS NULL THEN 1 ELSE 0
           END) as not_returned_devices,
       COUNT(rent_end) as returned_devices
FROM device_rent
GROUP BY contact_email;
</code></pre>
