<p>The problem is this line:</p>

<pre><code>fd = tarfile.open('file.tar.gz', 'r|gz')
</code></pre>

<p>You don't want <code>'r|gz'</code>, you want <code>'r:gz'</code>.</p>

<p>If I run your code on a trivial tarball, I can even print out the <code>member</code> and see <code>test/foo</code>, and then I get the same error on <code>read</code> that you get.</p>

<p>If I fix it to use <code>'r:gz'</code>, it works.</p>

<p>From <a href="http://docs.python.org/2/library/tarfile.html#tarfile.open">the docs</a>:</p>

<blockquote>
  <p>mode has to be a string of the form 'filemode[:compression]'</p>
  
  <p>...</p>
  
  <p>For special purposes, there is a second format for mode: 'filemode|[compression]'. tarfile.open() will return a TarFile object that processes its data as a stream of blocks. No random seeking will be done on the fileâ¦Â Use this variant in combination with e.g. sys.stdin, a socket file object or a tape device. However, such a TarFile object is limited in that it does not allow to be accessed randomly, see Examples.</p>
</blockquote>

<p><code>'r|gz'</code> is meant for when you have a non-seekable stream, and it only provides a subset of the operations. Unfortunately, it doesn't seem to document exactly which operations are allowedâand the link to Examples doesn't help, because none of the examples use this feature. So, you have to either read <a href="http://hg.python.org/cpython/file/2.7/Lib/tarfile.py#l387">the source</a>, or figure it out through trial and error.</p>

<p>But, since you have a normal, seekable file, you don't have to worry about that; just use <code>'r:gz'</code>.</p>
