<p>A few notes for you to keep in mind.</p>

<ul>
<li>Never during unit testing call methods which return random data. Because this way it might happen that tests pass once, and fail another time.</li>
<li>Do not generate urls, but rather hard code them in your tests. I know it feels wrong at the start, but it is actually something you want to do. If you have a public api for example and you "accidently" change the url, the tests would still work, but applications relying on the api would stop working. Test will warn you about the change and then you can see if that is really what you wanted.</li>
</ul>

<p>The tests look to complicated to me in general. I would split it in 2 or 3 tests. You can check if the page loaded ok in another test. Also, I would suggest you to make some kind of implicit login method, if you need token, user or whatever for your authentication.</p>

<p>Data providers look like this:</p>

<pre><code>    /**
     * Test description
     * @dataProvider getSomeData
     * @param array $data
     */
    public function testSomething($data)
    {
        $test = $data['test'];
        ...
    }

    static function getSomeData()
    {
        return array(
            array('test' =&gt; 'a'),
            array('test' =&gt; 'b'),
            array('test' =&gt; 'c'),
        );
    }
</code></pre>

<p>If you do functional test with phpunit, its fine, but really consider using behat. It is so much easier, once you get used to it. </p>
