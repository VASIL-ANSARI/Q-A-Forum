<p>One problem is that <code>DirectionRenderer</code> for route is created</p>

<pre><code>directionsDisplay = new google.maps.DirectionsRenderer();
</code></pre>

<p>but map is not specified on which directions will be rendered:</p>

<pre><code>directionsDisplay = new google.maps.DirectionsRenderer();
directionsDisplay.setMap(map);
</code></pre>

<p>In <code>createRoute()</code> start and end points are created:</p>

<pre><code>    var start = document.getElementById('start').value;
    var waypts = [];
    var end = document.getElementById('end').value;
</code></pre>

<p>and then used as array and filled up as waypoints in a loop:</p>

<pre><code>    for (var i = 0; i &lt; ListBox2.length; i++) {
        start.push({
            location: ListBox2[0].value,
            stopover: true
        });
        waypts.push({
            location: ListBox2[i].value,
            stopover: true
        });

        end.push({
            location: ListBox2[ListBox2.length-1].value,
            stopover: true
        });
    }
</code></pre>

<p>If ListBox2 has 10 elements, <code>start</code> and <code>end</code> will have 10 elements at the end. So, it is not clear what is the source for those two points. </p>

<p>See <a href="http://jsbin.com/repiw/1/edit" rel="nofollow">example at jsbin</a>. <code>start</code> and <code>end</code> are hardcoded, waypoints are filled up from faked ListBox2 (0 and last index are skipped).</p>
