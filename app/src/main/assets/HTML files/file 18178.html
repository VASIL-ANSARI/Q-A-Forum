<p>The problem is at the line:</p>

<pre><code>shared_array&lt;wchar_t&gt; param(argv[1]);
</code></pre>

<p>shared_array requires to be initialized with a pointer to an array allocated with new[] but argv[1] is just an c-string, so when it goes out of scope (the variable param that is) the shared_array's destructor calls delete[] on argv[1] which is not allowed.</p>
