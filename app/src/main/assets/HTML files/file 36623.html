<p>The fact that you are using the class constant from Author means that you are dependent on having that class available in your code and thus also in your test.  So in order to test <code>Book_PhoneBook</code> you need to have an <code>Author</code> class with the constant.  If the class constant is going to be a series of flags that you will need to pass to your class, you will need to have the class available and in your test make sure that the original class is loaded.  You are dependent on that class for <code>Book_PhoneBook::getCover()</code>.</p>

<p>You can also just use the string value of the class constant in your <code>Book_PhoneBook</code> though that sort of defeats the purpose of making it a constant so that you are able to change the value in one place.  </p>

<p>With your example, it is a little tricky to get an idea of what you are trying to achieve but since you want to remove the dependency on <code>Author</code> in <code>Book_PhoneBook</code>, I would change it to something like this:</p>

<pre><code>&lt;?php

class Book_PhoneBook extends Book {

    private $author;

    public function __construct(Author $author) {
        $this-&gt;author = $author;
    }

    public function getCover() {
        return $this-&gt;author-&gt;getTitle() . ' - YELLOW PAGES';
    }
}


class Author {
    const NAME_UNKNOWN = 'anonymous';

    public function __construct($nameStyle) {
       $this-&gt;nameStyle = $nameStyle;
    }

    public function getTitle() {
        //do complicated calculation of author name
        if ($this-&gt;nameStyle == $this::NAME_UNKNOWN) {
            $name = "Anonymous";
        }

        //do further complicated calculations, modifying $name

        return $name;
    }
}
</code></pre>

<p>This solution does have the problem that adding other options is difficult for <code>getTitle</code>.  And without having a better idea of what you are trying to achieve with <code>getTitle</code>, I am not able to offer a better solution.</p>
