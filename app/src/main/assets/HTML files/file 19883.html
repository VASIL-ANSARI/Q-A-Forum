<p>Well, I'm not sure about your last requirement, but <a href="http://www.stack.nl/~dimitri/doxygen/" rel="nofollow">doxygen</a> does meet the first three ones.</p>
