<p>You need to get the next value, which you can do with <code>outer apply</code>:</p>

<pre><code>select s.date, sum(datediff(seconds, s.date, snext.date) / 60.0) as runtime_minutes
from scada s outer apply
     (select top 1 date
      from scada s2
      where s2.date &gt; s.date and s2.status = 'Stopped'
      order by s2.date desc
     ) snext
where s.status = 'Running'
group by s.date;
</code></pre>
