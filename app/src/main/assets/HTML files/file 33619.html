<p>Your loops in <code>not_in_sq</code> are wrong:</p>

<pre><code>for(k =  i - (i % 3) ; i &lt; s ; i++)
    for(t = j - (j % 3) ; j &lt; v ; j++)
</code></pre>

<p>Look closely at <code>i &lt; s</code>, <code>i++</code>, <code>j &lt; v</code>, and <code>j++</code>. They are obviously incorrect. Here they are fixed:</p>

<pre><code>for(k =  i - (i % 3) ; k &lt; s ; k++)
    for(t = j - (j % 3) ; t &lt; v ; t++)
</code></pre>
