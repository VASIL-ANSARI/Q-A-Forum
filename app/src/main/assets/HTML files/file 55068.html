<p>I believe <code>belongs_to :link</code> is causing the issue. I think you need to get rid of it and add link reference to your table again and try.</p>

<pre><code>rails g migration RemoveLinkIdFromComments link_id:integer
rails g migration AddLinkRefToComments link:references
#Do check your newly created migration files it everything is correct.
</code></pre>

<p>Run rake db:migrate and try again. Let me know if that solves your issue.</p>

<pre><code>ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "users" violates foreign key constraint "fk_rails_03de2dc08c" on table "comments"
DETAIL:  Key (id)=(6) is still referenced from table "comments".
</code></pre>

<p>If we look at the errors, we can see we have a wrong association.
Can you delete everything from your development database(all the data) and try again.</p>
