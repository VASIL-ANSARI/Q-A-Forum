<p>I understood nothing from a description, but suppose, you want this that way:</p>

<pre><code>:student_number =&gt;
  sitenum = self.site_id
  count = Student.count_by_sql("SELECT MAX(student_number) FROM students WHERE site_id = #{sitenum}")
  if count &gt;= 2001
    Student(:condition =&gt; { :site_id =&gt; sitenum }, 
      :order =&gt; "student_number DESC").student_number + 1
  else
    2001
  end
</code></pre>
