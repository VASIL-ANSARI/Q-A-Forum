<p>Here's an answer for getting nodes in a range that will work for all major browsers except IE &lt; 9, although you'll need to get the selected range yourself: </p>

<p><a href="http://stackoverflow.com/a/7931003">http://stackoverflow.com/a/7931003</a></p>

<p>For a cross-browser solution, you could use my <a href="http://code.google.com/p/rangy/" rel="nofollow">Rangy</a> library as follows, assuming you have a reference to your iframe in a variable called <code>iframe</code>:</p>

<pre><code>var sel = rangy.getIframeSelection(iframe);
if (sel.rangeCount &gt; 0) {
    var range = sel.getRangeAt(0);
    var spans = range.getNodes([1], function(element) {
        return element.tagName.toLowerCase() == "span";
    });
    // spans is now an array of selected or partially selected &lt;span&gt;
    // elements. Spans inside other spans are not included.
}
</code></pre>
