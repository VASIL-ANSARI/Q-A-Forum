<p>The problem may be in <code>valid()</code>.</p>

<pre><code>int valid(int k,int ii,int jj)
{
    int i,j;
    for(i=1;i&lt;=9;i++)
        for(j=1;j&lt;=9;j++)
        {
            if((i!=ii || j!=jj) &amp;&amp; v[i][j]==k)
                return 0;
        }
    return 1;
} 
</code></pre>

<p>According to your implementation, if <code>v[1][1] == 1</code>, then <code>v[9][9]</code> cannot be 1. This does not make sense at all.</p>

<p>What you want should be:</p>

<pre><code>int valid(int k, int ii, int jj)
{
    int i;
    for(i = 1; i &lt;= 9; ++i) {
        if (i != ii &amp;&amp; v[i][jj] == k)
            return 0;
        if (i != jj &amp;&amp; v[ii][i] == k)
            return 0;
    }
    return 1;
}
</code></pre>

<p>Also note that you still need to take care of 3x3 blocks.</p>
