<p>Your problem is that you never call <code>pthread_cond_init()</code> on the <code>cb.can_produce</code> and <code>cb.can_consume</code> condition variables that are members of the <code>struct circular_buffer</code>.</p>

<p>You need to change the <code>cb_init()</code> function so that it initialises the new <code>circular_buffer</code>'s <code>mutex</code>, <code>can_produce</code> and <code>can_consume</code> members with <code>pthread_mutex_init()</code> and <code>pthread_cond_init()</code>.</p>

<p>You are also using the pointer variable <code>cb</code> uninitialised in the <code>produce_numbers()</code> function - it's declared as <code>struct circular_buffer *cb;</code> but never assigned to.  You need to make <code>cb</code> a member of <code>struct thread_arg</code> instead, and set it in <code>main()</code> so that <code>produce_numbers()</code> has a reference to the same <code>struct circular_buffer</code> object as the other threads.</p>
