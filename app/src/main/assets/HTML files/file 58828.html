<p><code>LEFT JOIN companies co 
ON co.company_id=IFNULL(i.invoice_company_as_id, i.invoice_company_id)</code></p>

<p>And if you have more specific test cases:</p>

<p><code>LEFT JOIN companies co 
ON co.company_id=IF(i.invoice_company_as_id IS NULL OR i.invoice_company_as_id = 0, i.invoice_company_as_id, i.invoice_company_id)</code></p>

<p>Same for your 2nd case. Performances may go away for heavy tables...</p>
