<p>Use a user defined variable to produce the rank when selecting from an aggregated aliased query that calculates the maximum for each user:</p>

<pre><code>select
    (@rank := ifnull(@rank, 0) + 1) as rank,
    user_id,
    points
from (select
    user_id,
    max(points) as points
    from results
    group by 1
    order by 2 desc) x
</code></pre>

<p>FYI, a UDV starts out life as null, hence the <code>ifnull()</code> call.</p>
