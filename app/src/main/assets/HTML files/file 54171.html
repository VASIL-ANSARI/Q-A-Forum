<p>This reduction code, like any other "tree-like" reduction operation, requires that the number of threads that participate in the shared memory reduction be equal to a power of 2 to work correctly. </p>

<p>Note that means you <em>could</em> design a reduction kernel which would run correctly for any <em>multiple</em> of 2 threads per block by having the nearest smaller power of 2 threads perform the actual reduction. The code you have posted cannot, however, work like that.</p>
