<p>As I understand the question, you're trying to insert a new <code>li</code> only when the new <code>characterID</code> is not within the data of another <code>li</code> in the list. If so, then you could write a function like this:</p>

<pre><code>function isDupe(which) {
  var result = false;
  $('ul#the_list li').each( function(i,e) { // look at all list elements
    if ( $(e).data('characterid') == which ) { // compare to argument
      result = true; // matched!
      return false; // break out of .each()
    }
  });
  return result;
}
</code></pre>

<p>Then you could wrap your <code>li</code> creation code like this:</p>

<pre><code>if( !isDupe(characterid) ){
  // do your checks
  // make your li
  // append to your list
}
</code></pre>

<p>Here's a reduced example: <a href="http://jsfiddle.net/redler/B7myn/" rel="nofollow">http://jsfiddle.net/redler/B7myn/</a></p>
