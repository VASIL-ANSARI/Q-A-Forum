<p>Here is an example of how to store files to the logged in users My Documents folder on windows.</p>

<p>You can modify the AppendUserFile function to support other file modes.  This version will open the file for Appending if it exists, or create it if it doesn't exist.</p>

<pre><code>using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication4
{
    class Program
    {
        static void Main(string[] args)
        {
            AppendUserFile("example.txt", tw =&gt;
            {
                tw.WriteLine("I am some new text!");
            });

            Console.ReadKey(true);
        }

        private static bool AppendUserFile(string fileName, Action&lt;TextWriter&gt; writer)
        {
            string path = System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
            if (!Directory.Exists(path))
                Directory.CreateDirectory(path);
            string filePath = Path.Combine(path, fileName);
            FileStream fs = null;
            if (File.Exists(filePath))
                fs = new FileStream(filePath, FileMode.Append, FileAccess.Write, FileShare.Read);
            else
                fs = new FileStream(filePath, FileMode.Create, FileAccess.Write, FileShare.Read);
            using (fs)
            {
                try
                {
                    TextWriter tw = (TextWriter)new StreamWriter(fs);
                    writer(tw);
                    tw.Flush();
                    return true;
                }
                catch
                {
                    return false;
                }
            }
        }
    }
}
</code></pre>
