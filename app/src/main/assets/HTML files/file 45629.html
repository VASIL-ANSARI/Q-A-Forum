<p>This line:</p>

<pre><code>equation=eqn
</code></pre>

<p>doesn't do what you think it does. Try this instead:</p>

<pre><code>import copy
equation=copy.deepcopy(eqn)
</code></pre>

<p>Python assignment isn't a copy operation, but rather a binding operation. The line you have means "<em>bind the name <code>equation</code> to the same object to which <code>eqn</code> is currently bound.</em>"</p>

<p>Your algorithm requires that <code>equation</code> and <code>eqn</code> are distinct objects.</p>
