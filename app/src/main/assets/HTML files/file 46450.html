<p>It fails because it's scoped unique over both <code>:port_target</code> <em>and</em> <code>:port_source</code>. You can pass multiple scopes to <code>scoped_to</code>:</p>

<pre><code>it 'should validate uniqueness of ecr_id scoped to port_target &amp; port_source' do
  should validate_uniqueness_of(:ecr_id).scoped_to(:port_target, :port_source)
end
</code></pre>
