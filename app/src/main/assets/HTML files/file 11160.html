<pre><code>    CComPtr&lt;IHTMLDocument2&gt; htmlDocument;
    CComPtr&lt;IHTMLElementCollection&gt; elementCollection;

    htmlDocument-&gt;get_all(&amp;elementCollection);
    for (long i=0;i&lt;numberOfElements;i++)
    {
        _variant_t index = i;
        CComPtr&lt;IHTMLElement&gt; htmlElem;
        CComPtr&lt;IDispatch&gt; htmlElemDisp;
        hResult = elementCollection-&gt;item( index,index ,(IDispatch **) &amp;htmlElemDisp );
        if (FAILED(hResult) || (!(htmlElemDisp)))
        {
            continue;
        }
        hResult = htmlElemDisp-&gt;QueryInterface( IID_IHTMLElement ,(void **) &amp;htmlElem);
        if (FAILED(hResult) || (!(htmlElem)))
        {
            continue;
        }
        hResult = htmlElem-&gt;get_tagName(&amp;buffer);

        if (FAILED(hResult) || (!(buffer)))
        {
            continue;
        }
        if (_wcsicmp(buffer,L"HEAD")==0) 
        { 
         // your code here
        }
}
</code></pre>

<p>Also, you can use <code>IHTMLDocument2* htmlDocument</code> instead of <code>CComPtr&lt;IHTMLDocument2&gt; htmlDocument</code>.
The main idea is to obtain all elements within your document, iterate them and find the one that has the tagName HEAD.
Hope this helps.</p>
