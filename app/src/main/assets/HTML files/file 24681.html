<p>You are re-using the same <code>line</code> variable with each iteration of your <code>for</code> loop.</p>

<p>Try re-initializing <code>line</code> at the top of your <code>for</code> loop like this:</p>

<pre><code>...
StringBuilder line;
for (Product p: getAllProducts()) {
  line = new StringBuilder();
  line.append(p.getId() &lt;=0 ? "" : p.getId());
  ...
</code></pre>
