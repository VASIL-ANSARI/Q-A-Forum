<pre><code>IF OBJECT_ID('dbo.departments', 'U') IS NOT NULL
    DROP TABLE dbo.departments
GO
IF OBJECT_ID('dbo.attendance', 'U') IS NOT NULL
    DROP TABLE dbo.attendance
GO
CREATE TABLE dbo.departments (EmpId INT PRIMARY KEY, DepId VARCHAR(10))
GO
INSERT INTO dbo.departments
VALUES (1, 'IT'), (2, 'admin'), (3, 'IT'), (4, 'IT '), (5, 'admin')
GO
CREATE TABLE dbo.attendance (EmpId INT PRIMARY KEY, [Status] CHAR(1))
GO
INSERT INTO dbo.attendance
VALUES (1, 'P'), (2, 'P'), (3, 'P'), (4, 'A'), (5, 'P')
GO
CREATE NONCLUSTERED INDEX ix ON dbo.departments (DepId)
GO

SELECT
     DepId
   , COUNT_BIG(1) AS total
   , COUNT_BIG(att.EmpId) AS presetCount
FROM departments dep
LEFT JOIN attendance att ON att.empid = dep.EmpId AND att.[status] = 'P'
GROUP BY DepId
</code></pre>

<p>My execution plan:</p>

<p><a href="http://i.stack.imgur.com/7zUMG.png" rel="nofollow"><img src="http://i.stack.imgur.com/7zUMG.png" alt="enter image description here"></a></p>

<p>Your execution plan:</p>

<p><a href="http://i.stack.imgur.com/6D8lW.png" rel="nofollow"><img src="http://i.stack.imgur.com/6D8lW.png" alt="enter image description here"></a></p>

<p>Output -</p>

<pre><code>DepId      total                presetCount
---------- -------------------- -------------
admin      2                    2
IT         3                    2
</code></pre>
