<p>Your syntax is right, but the back ticks are wrong and each <code>SELECT</code> only has one <code>WHERE</code>:</p>

<pre><code>UPDATE referrals r JOIN
       users u
       ON r.user_id = u.id
   SET r.points_earn = :points_earn
   WHERE r.new_id = :uid AND u.points = u.points + :points_refer AND
         u.id = :user_id;
</code></pre>

<p>The problem with backticks is that the following are quite different:</p>

<pre><code>`r.points_earn`
`r`.`points_earn`
</code></pre>

<p>The first refers to a column called "r.points_earn".  The second refers to the "points_earn" column in "r".  The backticks aren't necessary so you can just remove them.</p>
