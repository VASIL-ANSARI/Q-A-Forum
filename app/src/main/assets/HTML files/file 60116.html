<p>I have not tested the following solution, but it should produce the desired effect:</p>

<pre><code>require($CFG-&gt;libdir . '/coursecatlib.php');
require($CFG-&gt;libdir . '/enrollib.php');

$categoryid = 0;    // Replace with the desired category ID.
$category = coursecat::get($categoryid);
foreach ($category-&gt;get_courses() as $course) {
    // Simulates the deletion of the course, a better solution is to copy
    // the logic from `enrol_course_delete` here directly.
    enrol_course_delete($course);
}
</code></pre>

<p>The above script can take a while so you should probably execute this from the command line.</p>

<p>You can loop over the sub-categories using:</p>

<pre><code>$categories = $category-&gt;get_children();
foreach ($categories as $category) {
}
</code></pre>

<p>To obtain the ID of a category by shortname, use the following:</p>

<pre><code>$name = "My category";
$categoryid = $DB-&gt;get_field('course_categories', 'id', array('name' =&gt; $name), MUST_EXIST);
</code></pre>

<p>Note that categories can have identical names, you should use the category <code>idnumber</code> instead.</p>
