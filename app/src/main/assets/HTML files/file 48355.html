<p>Your query is a little off, because it is missing the transaction id.  But, your real issue is that you want to sum the amount from <code>t2</code> and not <code>t1</code>:</p>

<pre><code>SELECT t1.card_id, t1.merchant_id, t1.tran_dt,
       count(distinct t2.id) + 1 as Count, sum(t2.amount) as SumAmount
FROM tran t1 INNER JOIN
     tran t2
     on t2.card_id = t1.card_id and
        t2.merchant_id = t1.merchant_id and
        t2.tran_dt &gt;= t1.tran_dt and
        t2.tran_dt &lt;= DATE_ADD(t1.tran_dt, INTERVAL 15 MINUTE) 
GROUP BY t1.id, t1.card_id, t1.merchant_id, t1.tran_dt
HAVING Count &gt; 2;
</code></pre>

<p>Note:  I changed the <code>join</code> condition from <code>&gt;</code> to <code>&gt;=</code> to include the first transaction.  Also, I added the <code>&gt;=</code> on the date, and changed the count in <code>SELECT</code> to be for the second table, not the first.</p>
