<p>As everyone has already stated in comments, this is totally undefined behavior and should never really expect to work. However, I played with your code some with the debugger and realized the reason it's not working (at least in Cygwin gcc compiler) is you're creating <code>f2</code> incorrectly to point to the the address of the pointer storing the allocated memory, namely <code>buf</code>. You want to point to the memory that <code>buf</code> points to. Therefore, your assignment should be</p>

<pre><code>int(*f2)() = (int(*)())buf;
</code></pre>

<p>With that change, your code executes for me. But even if it works, it might break again as soon as you make any additional changes to the program.</p>
