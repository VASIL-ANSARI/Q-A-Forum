<p>Simply use <a href="http://www.php.net/manual/en/function.str-replace.php">str_replace</a>:</p>

<pre><code>$text = str_replace(' ', '_', $text);
</code></pre>

<p>You would do this after your previous <code>substr</code> and <code>strtolower</code> calls, like so:</p>

<pre><code>$text = substr($text,0,10);
$text = strtolower($text);
$text = str_replace(' ', '_', $text);
</code></pre>

<p>If you want to get fancy, though, you can do it in one line:</p>

<pre><code>$text = strtolower(str_replace(' ', '_', substr($text, 0, 10)));
</code></pre>
