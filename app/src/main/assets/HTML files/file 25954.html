<p>You don't want to loop over one result set and then makes queries for each row.  It is inefficient and the database can do it for you.</p>

<p>Try a join query:</p>

<pre><code>SELECT u.id, u.username, IF(f.follower_id IS NULL, 0, 1) as following
FROM users u
LEFT JOIN following f
  ON u.id = f.user_id
  AND f.follower_id = $loggedinuser
</code></pre>

<p>The LEFT JOIN gives you every row from the users table then any rows in following that match the criteria in the "ON" clause.  If there is no match, those columns are set to NULL in the result.</p>
