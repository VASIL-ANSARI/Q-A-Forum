<p>You're calling toggleClass but not removing the class first. So in some cases it's going to remove the class when it should add the class. Toggle is going to add the class when it doesn't have it, and remove it when it does. By making sure the class is removed first it's going to add it as expected. At this point, though, toggleClass should probably be replaced with addClass so it's more readable. </p>

<p>Here's a working example</p>

<p><a href="http://jsfiddle.net/L63e3mjL/9/" rel="nofollow">http://jsfiddle.net/L63e3mjL/9/</a></p>

<pre><code>function clearAll() {
    $('#controller .button').removeClass('theSelected');
    $('.theHighlighted').removeClass('theHighlighted');
}
</code></pre>

<p>Edit with new requirements: <a href="http://jsfiddle.net/L63e3mjL/19/" rel="nofollow">http://jsfiddle.net/L63e3mjL/19/</a></p>

<p>I'm going to find a more elequint way to do this, but for now I've added a variable to keep track of which button is clicked. Using that we can clear when we're coming from a different button, but if we're clicking the same button we dont clear and allow toggleClass to toggle the divs.</p>

<p>Edit2: Just for fun I cleaned it up into one function. <a href="http://jsfiddle.net/L63e3mjL/21/" rel="nofollow">http://jsfiddle.net/L63e3mjL/21/</a></p>

<pre><code>var current;
var buttons = $('.button');

buttons.click(function(e){
    var button =  $(this);
    var index = button.index();
    var divs;

    if(current != index) clearAll();
    current = index;

    if(index == 0) divs = $('.littleDiv*');
    else if(index == 1) divs = $('.littleDiv:eq(1)');
    else if(index == 2) divs = $('.littleDiv:even');

    divs.toggleClass('theHighlighted'); 
    button.addClass('theSelected');
});
</code></pre>
