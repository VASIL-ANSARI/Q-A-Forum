<p>The error message says it all:</p>

<blockquote>
  <p>cannot cast 'asp_table' to its protected base class 'table'</p>
</blockquote>

<p><code>protected</code> inheritance means only <code>asp_table</code> and its derived classes know of the inheritance. Therefore <code>tp = new asp_table</code> is not possible outside the class or its derived classes.</p>
