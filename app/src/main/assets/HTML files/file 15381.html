<p>For one, hashing like that is insecure. sha256 can be broken easily, at least for short passwords. You must use some <a href="http://en.wikipedia.org/wiki/Key_stretching" rel="nofollow">hash stretching</a>. See if you can find some <a href="http://en.wikipedia.org/wiki/PBKDF2" rel="nofollow">PBKDF2</a> implementations or use the wikipedia's suggestion for a "for loop" with sha256.
Moreover I don't get what you achieve with having more session variables. I don't understand what validateuser() does, it still relies on session id, or am I missing something.</p>
