<h2><code>save</code> doesnt run until windows is closed</h2>

<p><code>ShowDialog</code> does not return until the window you are showing is closed. That explains why it does not run until the windows closes.</p>

<h2>Progress bar doesn't update</h2>

<p>Try this.</p>

<pre><code>pbStatus.MaxValue = components.Count; //make sure you set the max value

foreach (Component c in components)
{
    pbStatus.Value+= 1; //increment by one item as you have processed on item.
}
</code></pre>
