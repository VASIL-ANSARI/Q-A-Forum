<p>You should print out the values of <code>srgb</code>.  Probably it's not a range error, it's that the negative coefficients here</p>

<pre><code>srgb[0] = 3.241*xyz[0] - 1.5374*xyz[1] - 0.4986*xyz[2]
srgb[1] = -0.9692*xyz[0] + 1.876*xyz[1] + 0.0416*xyz[2]
srgb[2] = 0.0556*xyz[0] - 0.204*xyz[1] + 1.057*xyz[2]
</code></pre>

<p>make it entirely possible that elements of <code>srgb</code> can be negative, and unless you're already working in complex numbers, you'll raise a warning when you take the power:</p>

<pre><code>&gt;&gt;&gt; import numpy
&gt;&gt;&gt; numpy.array([-2.0])
array([-2.])
&gt;&gt;&gt; numpy.array([-2.0])**(1/2.4)
__main__:1: RuntimeWarning: invalid value encountered in power
array([ nan])
&gt;&gt;&gt; numpy.array([-2.0+0j])**(1/2.4)
array([ 0.34548198+1.28935629j])
</code></pre>

<p>The arguments to <code>where</code> will be evaluated before they're passed, so the powers will be taken before the branch on the <code>srgb &lt;= 0.0031308</code> condition divides up the values, and the warning is triggered.  </p>
