<p>You don't have to use AJAX in this case.  Just have your button submit the form to your Struts action, and have the action use the <a href="http://struts.apache.org/2.1.8.1/docs/stream-result.html">stream result</a> type.</p>

<p>Example:</p>

<p>In your Struts XML:</p>

<pre><code>&lt;result name="download" type="stream"&gt;
    &lt;param name="contentDisposition"&gt;attachment;filename=report.xls&lt;/param&gt;
    &lt;param name="contentType"&gt;application/vnd.ms-excel&lt;/param&gt;
    &lt;param name="inputName"&gt;inputStream&lt;/param&gt;
    &lt;param name="bufferSize"&gt;1024&lt;/param&gt;
&lt;/result&gt;
</code></pre>

<p>Your action will then provide a <code>public InputStream getInputStream()</code> to pass along the data.</p>

<p>I presume that whatever library you're using to generate the Excel files (<a href="http://poi.apache.org/">POI</a>?) can write the output to an arbitrary <code>OutputStream</code>.</p>

<p>A quick-and-dirty way to convert that to an <code>InputStream</code>:</p>

<pre><code>// Using Workbook from Apache POI for example...
Workbook wb;
// ...
ByteArrayOutputStream bos = new ByteArrayOutputStream();
wb.write(bos);
InputStream bis = new ByteArrayInputStream(bos.toByteArray());
</code></pre>
