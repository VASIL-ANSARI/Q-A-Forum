<p>There is no race condition, you just need to do:</p>

<pre><code>os.mkdir('foo')
open('foo/bar.txt', 'w')
</code></pre>

<p>because default is read mode (and there is no file)</p>
