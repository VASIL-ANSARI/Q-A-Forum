<p>You could use an <a href="http://weblogs.asp.net/scottgu/archive/2006/05/07/ASP.NET-2.0-Membership-and-Roles-Tutorial-Series.aspx" rel="nofollow">ASP.NET membership provider</a>, if you're using SQL-Server you can inherit from <code>SqlMembershipProvider</code>. </p>

<p>Then you could override <code>ValidateUser</code> and log if it returns <code>false</code>(or always).</p>

<pre><code>bool isValid = base.ValidateUser(username, password);
</code></pre>

<p>You can get the ip in the following way:</p>

<pre><code>public static void logWrongPasswordAttempt(string userName, string passWord)
{
    // Look for a proxy address first
    var IP = HttpContext.Current.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];
    //Trim and lowercase IP if not null
    if ((IP != null))
    {
        IP = IP.ToLower().Trim();
    }
    if (IP == null || IP.Equals("unknown"))
    {
        //If IP is null use different detection method else pull the correct IP from list.
        IP = HttpContext.Current.Request.ServerVariables["REMOTE_ADDR"].ToLower().Trim();
    }

    List&lt;string&gt; IPs = null;
    if (IP.IndexOf(",") &gt; -1)
    {
        IPs = IP.Split(new[]{','}, StringSplitOptions.None).ToList();
    }
    else
    {
        IPs = new List&lt;String&gt;() { IP };
    }

    foreach (string ip in IPs)
    {
        // insert your record into database
    }
}
</code></pre>
