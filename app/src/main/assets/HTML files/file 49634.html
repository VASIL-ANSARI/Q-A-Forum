<p>You are giving an unintialized pointer to <a href="http://www.unix.com/man-page/minix/2/stat/" rel="nofollow">stat</a>.</p>

<pre><code>struct stat *s
....
stat(e-&gt;d_name, s);
</code></pre>

<p>What you should do instead is:</p>

<pre><code>struct stat s
....
stat(e-&gt;d_name, &amp;s);
</code></pre>

<p>Another problem (among other things) is this part:</p>

<pre><code>strcpy(res, find_file(name, dr));
if (res != "") {
</code></pre>

<p>You can not compare string like this in C, you have to use <code>strcmp(res, "") == 0</code>, because you are comparing pointers here. It may even work in this case (if static strings are reused by your compiler), but in the general case it will not.</p>
