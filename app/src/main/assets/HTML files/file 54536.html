<p>You tried to use <code>this</code> inside the function</p>

<pre><code>function(transaction, results) {
    if (results.rows.length &gt; 0) {
        my_this.updateData(results.rows[0].id, lastseen);
    } else {
        my_this.saveData(username, lastseen);
    }
}
</code></pre>

<p>But the function is not a member of <code>Database</code>. In the function scope <code>this</code> is related to the object where the function is defined. I think the object is <code>window</code>. The approach you used in the edited version is correct.</p>
