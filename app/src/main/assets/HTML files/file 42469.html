<p>How about this.You have to find  a way to remove the groups when there is nothing in the right side</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code> $(document).ready(function () {    
$('#btnRight').click(function (e) {
                var selectedOpts = $('#AvailableFields option:selected');
                if (selectedOpts.length == 0) {
                    alert("Nothing to move.");
                    e.preventDefault();
                }

    if(selectedOpts.parent().attr('label') == "Group A"){
        $('#FieldstoBeMatchedOn').append($('&lt;optgroup label="Group A"&gt;')).append($(selectedOpts).clone());
                $(selectedOpts).remove();
                defaultSelect();
                e.preventDefault();
    }
    else{
        $('#FieldstoBeMatchedOn').append($('&lt;optgroup label="Group B"&gt;')).append($(selectedOpts).clone());
                $(selectedOpts).remove();
                defaultSelect();
                e.preventDefault();
    }
            });

            $('#btnLeft').click(function (e) {
                var selectedOpts = $('#FieldstoBeMatchedOn option:selected');
                if (selectedOpts.length == 0) {
                    alert("Nothing to move.");
                    e.preventDefault();
                }

                $('#AvailableFields').append($(selectedOpts).clone());
                $(selectedOpts).remove();
                defaultSelect();
                e.preventDefault();
            });
    defaultSelect = function () {
                $("#FieldstoBeMatchedOn option").each(function () {
                    $(this).prop("selected", true);
                });
            }
        });</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"&gt;&lt;/script&gt;
&lt;select name="AvailableFields" id="AvailableFields" multiple="multiple" size="10"&gt;
    &lt;option value=""&gt;Please select&lt;/option&gt;
    &lt;optgroup label="Group A"&gt;
    &lt;option value="1"&gt;1&lt;/option&gt;
    &lt;option value="2"&gt;2&lt;/option&gt;
    &lt;option value="3"&gt;3&lt;/option&gt;
    &lt;option value="4"&gt;4&lt;/option&gt;
    &lt;/optgroup&gt;
    &lt;optgroup label="Group B"&gt;
    &lt;option value="a"&gt;A&lt;/option&gt;
    &lt;option value="b"&gt;B&lt;/option&gt;
    &lt;option value="c"&gt;C&lt;/option&gt;
    &lt;/optgroup&gt;
    &lt;/select&gt;

    &lt;button type="button" title="Forward" id="btnRight"&gt;Move Right&lt;/button&gt;
    &lt;button type="button" title="Backward" id="btnLeft"&gt;Move Left&lt;/button&gt;

    &lt;select name="FieldstoBeMatchedOn" id="FieldstoBeMatchedOn" multiple="multiple" size="10"&gt;
    &lt;/select&gt;</code></pre>
</div>
</div>
</p>
