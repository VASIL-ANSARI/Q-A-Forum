<p>You asked why it is creating "wrong" SQL. Let's go step by step.</p>

<p>LINQ is very powerful but sometimes can mislead developers.</p>

<p><code>.Where(a =&gt; a.CountryId.Equals(country.Id))</code> is valid and working syntax to filter airports by country (can I suggest to rewrite <code>a.CountryId == country.id</code>? Better readability).</p>

<p>Now you can't see what happens in the backstage of LINQ, because it all depends on the actual object you are calling <code>Where</code> on. As pointed out by others, call to <code>AsQueryable</code> in your <code>GetAll()</code> is the cause.</p>

<p><code>GetAll()</code> executes the SQL query, without filtering, so that it will return all <code>Airport</code>s, and then the result set is filtered in memory.</p>

<p>Worse, your <code>SQLManager</code> seems to be a rough implementation of an ORM. You must discuss with your software architect about implementing <code>Entity Framework</code> or <code>NHibernate</code> (but I wouldn't recommend the second anymore) that are proper ORMs supporting LINQ. With them, you will find that the queries will be filtered correctly.</p>
