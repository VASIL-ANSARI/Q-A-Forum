<p>Two things to keep in mind:</p>

<p>(1) You need to check for caps that indicates support for the 24-bpp format. Not every Direct3D 9 device supports it.</p>

<p>(2) You have to respect the pitch returned by LockRect, so you need to do the copy scan-line by scan-line, so you can't do the whole thing in just one memcpy. Something like:</p>

<pre><code>BYTE* sptr = in-&gt;imageData;
BYTE* dptr = lockRect.pBits;
for( int y = 0; y &lt; in-&gt;height; ++y )
{
    memcpy( dptr, sptr, in-&gt;widthStep );
    sptr += in-&gt;widthStep;
    dptr += lockRect.Pitch;
}
</code></pre>

<p>This assumes <code>in-&gt;widthStep</code> is the pitch of the source image in bytes, that <code>in-&gt;widthStep</code> is &lt;= <code>lockRect.Pitch</code>, and that the format of the source image is identical to the format of the Direct3D resource.</p>
