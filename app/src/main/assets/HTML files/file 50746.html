<p>This is happening because you are instantiating the ImageList each time in the foreach loop. When you assign the imagelist finally to listView1.LargeImageList, it is only the final imagelist instance that gets attached.</p>

<p>You will need to move the instantiation out of the foreach loop</p>

<pre><code>ImageList imagelist = new ImageList();

foreach (string ufolder in groups_needed)
{
    ...
}
</code></pre>

<p>You may also need to change the logic for your ImageIndex to get this working, now that the ImageList is out of the loop.</p>
