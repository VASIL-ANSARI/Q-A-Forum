<p>You can use a <a href="http://bost.ocks.org/mike/nest/" rel="nofollow">nested selection</a> and <a href="https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_range" rel="nofollow"><code>d3.range()</code></a> for this:</p>

<pre><code>d3.select("body")
  .selectAll("p")
  .data([5,3,10])
  .enter()
  .append("p")
  .selectAll("p")
  .data(function(d) { return d3.range(d); })
  .enter()
  .append("p")
  .html(String);
</code></pre>

<p>Demo <a href="http://jsfiddle.net/5uLrj/" rel="nofollow">here</a>.</p>

<p>You can use your <code>.do()</code> as well, except that it's called <a href="https://github.com/mbostock/d3/wiki/Selections#wiki-each" rel="nofollow"><code>.each()</code></a>. <code>CreateRectangle()</code> would look something like this.</p>

<pre><code>function CreateRectangle(d) {
  d3.select(this).selectAll("p").data(d3.range(d)).enter().append("p").html(String);
}
</code></pre>

<p>It works similarly with SVG and <code>rect</code> elements.</p>
