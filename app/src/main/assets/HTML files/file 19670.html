<pre><code>$agentList-&gt;addAgent($agent);
</code></pre>

<p>is not enough. Since it's bidirectional you have to add/set both agent to list and list to agent.</p>

<p>This could work:</p>

<pre><code>foreach ($agentLists as $list) {
     $alist = $em-&gt;getRepository('YourBundle:AgentList')
                   -&gt;findOneById($list-&gt;getId());

     $agent-&gt;addAgentList($aList);
     $em-&gt;persist($agent);
     $em-&gt;flush();

     $aList-&gt;addAgent($agent);
     $em-&gt;persist($aList);
     $em-&gt;flush();
}
</code></pre>

<p>Remember you have to first persist one entity before you can persist and flush the other related entity.</p>
