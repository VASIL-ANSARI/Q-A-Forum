<p>try something like this </p>

<pre><code>declare @table as table (
    GL_Group_Code   varchar(8),
    GL_Branch_Code  varchar(8),
    Account_Number  varchar(4),
    GL_Centre_Number    varchar(6)
)

insert into @table
select  '0100', '0110', '1200', 'S10118' union
select  '0100', '0110', '1580', 'S16053' union
select  '0200', '0210', '2050', '200049' union
select  '0200', '0210', '2050', '782844'

declare @table_hier as table (
    Parent_ID   varchar(8),
    Item_ID     varchar(8)
)

DECLARE @RelatonShip VARCHAR(4)

SET @RelatonShip = '134'

IF @RelatonShip = '1234'
BEGIN
    INSERT INTO @table_hier ( Parent_ID, Item_ID )
    SELECT GL_Group_Code, GL_Branch_Code FROM @table 
    UNION ALL SELECT GL_Branch_Code, Account_Number FROM @Table
    UNION ALL SELECT Account_Number, GL_Centre_Number FROM @table
END
IF @RelatonShip = '1243'
BEGIN
    INSERT INTO @table_hier ( Parent_ID, Item_ID )
    SELECT GL_Group_Code, GL_Branch_Code FROM @table 
    UNION ALL SELECT GL_Branch_Code, GL_Centre_Number FROM @Table
    UNION ALL SELECT GL_Centre_Number, Account_Number FROM @table
END
IF @RelatonShip = '34'
BEGIN
    INSERT INTO @table_hier ( Parent_ID, Item_ID )
    SELECT Account_Number, GL_Centre_Number FROM @table
END
IF @RelatonShip = '134'
BEGIN
    INSERT INTO @table_hier ( Parent_ID, Item_ID )
    SELECT GL_Group_Code, Account_Number FROM @table 
    UNION ALL SELECT Account_Number, GL_Centre_Number FROM @table
END

SELECT * FROM @table_hier
</code></pre>
