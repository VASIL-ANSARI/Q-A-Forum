<p>First things first: the <code>static_cast</code>s you are doing are unnecessary. In C++, literals of the form <code>1.0</code> are considered <code>double</code>s by default. Even if you used the float suffix, i.e. <code>1.0f</code>, the compiler will still do the right thing.</p>

<p>Second, while I'm not familiar with the algorithm you are implementing, I would bet the issue is here: <code>denominator + static_cast&lt;double&gt;(2);</code>. This statement has no effect on the value of <code>denominator</code>.</p>

<p>You probably need to do this:</p>

<pre><code>denominator = denominator + 2;
</code></pre>

<p>Or,</p>

<pre><code>denominator += 2;
</code></pre>

<p>The intended effect is to modify the value of <code>denominator</code> for the next iteration of the loop, so you must assign the new value to <code>denominator</code>.</p>

<p>Also, there doesn't appear to any different between:</p>

<pre><code>for (int i = 2; i &lt; input + 2; ++i) {
    ...
}
</code></pre>

<p>and</p>

<pre><code>for (int i = 0; i &lt; input; ++i) {
    ...
}
</code></pre>

<p>So I would recommend start your index variable at 0 for readability's sake.</p>
