<p>Your token request is failing because of the query parameter at the end of your redirect uri.  OAuth redirect URI's should not have any query parameters or fragments.  You can use the state parameter instead.  </p>

<p>I don't think that the authorize call should have succeeded either, but clearly it did.  I am checking to see if that is a bug.</p>

<p>See this link for some more information on how to use the OAuth state parameter:</p>

<p><a href="http://www.thread-safe.com/2014/05/the-correct-use-of-state-parameter-in.html" rel="nofollow">http://www.thread-safe.com/2014/05/the-correct-use-of-state-parameter-in.html</a></p>
