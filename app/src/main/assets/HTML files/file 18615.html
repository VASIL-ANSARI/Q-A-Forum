<p>In a migration, <code>references</code> expects the field name without the <code>_id</code>, and it then appends <code>_id</code> to it. Right now, you're creating two columns: <code>user_id_id</code> and <code>location_id_id</code>.</p>

<p>Instead of these lines...</p>

<pre><code>t.references :user_id
t.references :location_id
</code></pre>

<p>... you need these lines:</p>

<pre><code>t.references :user
t.references :location
</code></pre>

<p>And once you've fixed your column names...</p>

<p>You don't have to manually create records in then "through" table. If you have a user, and you have a location, and your associations are setup correctly (<code>has_many follows; has_many :locations, through: :follows</code>), you can simply use</p>

<pre><code>user.locations &lt;&lt; location
</code></pre>

<p>This will automatically create the joining record.</p>
