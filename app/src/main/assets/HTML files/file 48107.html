<p>You're specifying a callback for <code>socket.on()</code>, you can't do that.
Callbacks are possible with <code>emit()</code> or <code>send()</code> as per the <a href="http://socket.io/docs/#sending-and-getting-data-(acknowledgements)" rel="nofollow">Socket.io docs</a>, since you want to basically send a message and then retrieve the result without writing a different <code>socket.on()</code>.</p>

<p>Change your code to use <code>emit()</code></p>

<p><strong>Client code</strong></p>

<pre><code>socket.emit('userCapture', data, function(response){
    if(response){
        //do stuff
    } else {
        alert('Username in use.');
    }
});
</code></pre>

<p><strong>Server code</strong></p>

<pre><code>socket.on('userCapture', function(data, callback){
    username = data.username;
    question = data.question;
    socket.username = username;
    socket.room = username;

    function isInArray(arr,obj) {
        return (arr.indexOf(obj) != -1);
    }

    // you can just send the result back
    callback(isInArray(usernames, username));
});
</code></pre>
