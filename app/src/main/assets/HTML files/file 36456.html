<p>A level of abstraction would make this much simpler. Create</p>

<p>RowEntry and Row</p>

<p>classes that encapsulate data format knowledge and simple ask each entry for it's display format. I don't really see any MetaProgramming required. </p>

<p>This line </p>

<pre><code>sheet.add_row row, :style =&gt; [date_format, time_format, time_format, nil, nil, nil, nil, nil, nil, nil, nil, money_format, money_format, nil]
</code></pre>

<p>Becomes</p>

<pre><code>sheet.add_row row.entries, row.style
</code></pre>

<p>More details: </p>

<p>RowEntry is essentially a struct that records both the value and the display style. </p>

<p>Row is an Array of RowEntry objects that knows how to extract both a plain Array of values and a plain Array of styles from the RowEntry Objects. </p>
