<p>The problem is with the reversal of byte order and left shifts. The sign of the result of the shift operation is the same as the sign of the value being shifted. So shifting a signed <code>char</code> would behave differently from what you expect.</p>

<p>To fix, change the type of the <code>length</code> array to <code>unsigned char</code>.</p>
