<p>There are no checks to make sure that <code>i + offset</code> is less than <code>4096</code>. That could be the source of the problem.</p>
