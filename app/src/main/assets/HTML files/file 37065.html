<p>1) Customers who ordered all the products of a specific country:</p>

<pre><code>DECLARE @Country AS VARCHAR(100)
SET @Country = 'XY'
;WITH OrdersCTE AS
(
    SELECT *
    FROM   Orders
    WHERE  Prod_Id IN (SELECT Id FROM Product WHERE Country = @Country)
)
SELECT * 
FROM   Customers
WHERE  Id IN 
(
    SELECT Cust_Id 
    FROM   OrdersCTE
    GROUP BY Cust_Id 
    HAVING COUNT(DISTINCT Prod_Id) = (SELECT COUNT(*) FROM Product WHERE Country = @Country)
)
</code></pre>

<p>2) Customers who bought only products of a specific country:</p>

<pre><code>DECLARE @Country AS VARCHAR(100)
SET @Country = 'XY'
SELECT   C.Id,
         C.Name,
         C.City
FROM     Customers C
         Left JOIN Orders O
             ON C.Id = O.Cust_Id
         LEFT JOIN Product P
             ON P.Id = O.Prod_Id
GROUP BY C.Id,
         C.Name,
         C.City
HAVING   COUNT(DISTINCT Country) = 1
</code></pre>
