<p>You are responsible to make sure that CS is not in use any longer before destroying it. Let us say that no other thread is currently trying to enter, but there is a chance that it is going to attempt very soon. Now you destroy the CS, what this concurrent thread is going to do? At its full pace it hits deleted critical section causing memory access violation? </p>

<p>The actual solution depends on your current app design, but if you are destroying threads, then you will perhaps want to flag your request to stop those threads, and then wait on theit handles to wait for their destruction. And then complete with deleting critical section when you are sure that threads are done.</p>

<p>Note that it is unsafe to rely on CS member values such as <code>.LockCount</code>, and having done things right way you will prehaps not even need thing like <code>IsWindowsXPOrBelow</code>. Critical section API suggest that you use <code>CRITICAL_SECTION</code> structure as "black box" leaving the internals to be implementation specific.</p>
