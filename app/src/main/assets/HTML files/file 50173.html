<p>You should be checking what the <code>username</code> returns prior to the changes being made to <code>self.email</code></p>
