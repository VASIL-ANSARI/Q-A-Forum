<p>Set a boolean flag at the beginning of your test depending on if you want to run it on 43 or 47. Check the flag in the code where you're creating your driver, for example like this:</p>

<pre><code>boolean useMarionette = true //false

URL server = new URL("http://localhost:4444/wd/hub")
DesiredCapabilities capabilities = DesiredCapabilities.firefox();
capabilities.setCapability("marionette", useMarionette);
WebDriver webDriver = new RemoteWebDriver(server, capabilities);
webDriver.get("https://www.google.co.in");
</code></pre>

<p>Now if you have useMarionette set to true, it will run with marionette, if set to false, it will not.</p>

<p>If you really want to parse the windows registry for the available firefox version, here is a partial example for you:</p>

<p><a href="http://stackoverflow.com/questions/2439984/how-to-check-if-a-program-is-installed-on-windows-system">How to check if a program is installed on Windows system</a></p>

<p>Use as follows:</p>

<pre><code>public class Test {

    public static void main(String... args) throws Exception {

        RegistryKey firefoxKey;
        RegistryKey.initialize(Test.class.getResource("jRegistryKey.dll").getFile());
        RegistryKey key = new RegistryKey(RootKey.HKCU, "SOFTWARE\\Mozilla\\Mozilla Firefox");
        for (Iterator&lt;RegistryKey&gt; subkeys = key.subkeys(); subkeys.hasNext();) {
            firefoxKey = subkeys.next();

            if(firefoxKey.getName().contains("47") {
                 //marionette
            }
            //start browser with or without     marionette
        }
    } 
}
</code></pre>
