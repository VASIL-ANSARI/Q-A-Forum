<p>As noted in @BradLarson's comment, the <code>lowp</code> qualifier on <code>materialShininess</code> turned out to be the problem; with that set to <code>mediump</code> instead, it renders correctly (right-hand image) on all devices and OS versions I have on hand, regardless of whether the branch or no-branch (with <code>step</code>) version of the shader is used. </p>

<p>(Using <code>lowp</code> versus <code>mediump</code> for the inputs <code>R</code> and <code>V</code> from which <code>cos_alpha</code> is calculated doesn't make any visible difference, which makes sense: those are normalized vectors, so their components have magnitudes in the range 0.0 to 1.0. That's the same range as color components, for which <code>lowp</code> seems to be intended.)</p>
