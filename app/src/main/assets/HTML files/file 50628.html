<p>So you already know you'll be dealing with 2 specific UserIds?</p>

<p>If yes, you could put those results you posted into a temp table and then join it to itself.....
So #TMP would contain..</p>

<pre><code>case        trace       amount  edge        userId                  cnt
110000061   40902752    357.00  21182786    HB                      2
110000061   40863651    161.00  21182786    R5                      2 
</code></pre>

<p>Then get what you want via this....</p>

<pre><code>SELECT * FROM #TMP T1
INNER JOIN #TEMP T2 ON T2.case = T1.case
WHERE
ABS(ABS(T1.amount) - ABS(T2.AMOUNT)) &gt;= 10   --A difference of 10 or more
</code></pre>
