<p>I was going to write this as a comment but it's too long.</p>

<p>I'll bring up the elephant in the room: why don't you just test for failure in the traditional way (by returning null or throwing an exception)?</p>

<p>Nevermind the fact that IsBadWritePtr is so frowned upon (even its documentation says that it's obsolete and you shouldn't use it), but your use case doesn't even seem appropriate. From the MSDN documentation:</p>

<blockquote>
  <p>This function is typically used when working with pointers returned from third-party libraries, where you cannot determine the memory management behavior in the third-party DLL.</p>
</blockquote>

<p>But you are not using it to test anything passed/returned from a DLL, you just seem to be using it to test for allocation success, which is not only unnecessary (because you already know that from the return value of HeapAlloc, GlobalAlloc, etc.), but it's not what IsBadWritePtr is intended for.</p>

<p>Also, testing for allocation success is not something you should only do in debug mode, or with asserts, as it's obviously out of your control and you can't try to "fix" it by debugging.</p>
