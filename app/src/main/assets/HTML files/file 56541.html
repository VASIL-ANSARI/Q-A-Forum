<p><code>join</code> the result to the original table to get the lifespan of those users who have more than 100 entries per day atleast once.</p>

<pre><code>select d.user_id 
,max(d.record_date::date) - min(d.record_date::date) as user_lifespan_in_days
from data d
join (SELECT COUNT(*) count, userid, recorddate::date 
      FROM data 
      WHERE datatype = 0 
      GROUP BY userid, recorddate::date 
      HAVING COUNT(*) &gt; 100) t
on t.user_id = d.user_id
group by d.user_id
</code></pre>
