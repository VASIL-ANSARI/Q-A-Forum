<p>Instead of passing the connection object itself, pass the db_config and then establish a new connection in your gem:</p>

<p>In your main code:</p>

<pre><code>MyGem::RoboCopy.run_and_parse_robocopy option, db_config
</code></pre>

<p>In your gem:</p>

<pre><code>module MyGem
  class RoboCopy
    def self.run_and_parse_robocopy(options, db_config)
      ActiveRecord::Base.establish_connection db_config
      # ...
    end
  end
end
</code></pre>
