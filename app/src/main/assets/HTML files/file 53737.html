<pre><code>select Distinct  a.word,    a.pageno,   a.position 
from t as a
join t as b
  ON abs((a.PageNo * 100) + a.Position - (b.PageNo * 100) + b.Position) &lt; 10
 AND (   (a.Word = 'A' and b.Word = 'B')
      OR (a.Word = 'B' and b.Word = 'A')
     )
</code></pre>

<p>maybe you can use this for last condition</p>

<pre><code>AND ( a.Word + b.Word IN ( 'AB', 'BA' ))
</code></pre>
