<p>It appears that your problem is in your transcoding function you need to av_rescale_q between your input format PTS/DTS and output format PTS/DTS.</p>

<p>Don't trust putting arbitrary numbers in either, continue doing what you're doing by getting it from the context and codec.</p>

<p>I wrote a <a href="http://stackoverflow.com/questions/20909252/calculate-pts-before-frame-encoding-in-ffmpeg/23068635#23068635">bit about PTS/DTS here</a> and it may be useful for you. In your case though you have a "correct" PTS/DTS already that you need to transform into your output PTS/DTS.</p>
