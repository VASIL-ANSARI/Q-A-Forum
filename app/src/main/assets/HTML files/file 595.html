<p>I would say: create a stored procedure, probably has the best performance.
Or if you have a maximum number of levels, you could create subqueries, but they will have a very poort performance.</p>

<p>(Or you could get MS SQL Server 2008 and get the new hierarchy functions... ;) )</p>
