<p>MDN's definition is wrong <strong>[UDPATE: I have corrected MDN now]</strong>. <code>anchorOffset</code> and <code>anchorNode</code> (and <code>focusNode</code> and <code>focusOffset</code>) work just like a <a href="https://developer.mozilla.org/en-US/docs/DOM/range" rel="nofollow">Range</a> boundary: the offset is a number of characters within a texty node (text, character data and comment nodes) or the number of child nodes of <code>anchorNode</code> preceding the selection anchor in all other node types. In practice, selection boundaries are not always within text nodes, as you've observed. An obvious example is when the caret is between two adjacent images (caret represented by a pipe character):</p>

<pre><code>&lt;div contenteditable="true"&gt;&lt;img src="1.png"&gt;|&lt;img src="2.png"&gt;&lt;/div&gt;
</code></pre>

<p>Also, Firefox often returns selection boundaries as offsets within elements, especially when a selection selects a whole block element (such as a <code>&lt;p&gt;</code>). Other browsers don't tend to do this and prefer to return offsets within text nodes.</p>

<p>As for <code>isText</code>, if I understand you correctly, a full implementation would be something like the following, which is taken from my own code:</p>

<pre><code>function isCharacterDataNode(node) {
    var t = node.nodeType;
    return t == 3 || t == 4 || t == 8 ; // Text, CDataSection or Comment
}
</code></pre>
