<p>Well, if you uncomment <code>total = .5;</code>, the compiler gets rid of all unused variables. In this case, it will discard all the computation you do, simply because it doesn't affect the output of the shader. GPU compilers are very effective in removing anything that doesn't affect the output of a shader and it can be a bit confusing while debugging.</p>

<p>Apart from that, your shader is too complicated, it should look sth like this:</p>



<pre><code>    void main() {
        lowp vec3 N = (texture2D(mTexture, bumpMapCoords).rgb - .5f) * -2.f;
        N = normalize(N);
        lowp vec3 L = normalize(mLightPos.xyz - wPos.xyz);
        lowp vec3 E = normalize(-wPos.xyz);
        lowp vec3 R = normalize(-reflect(L, N));

        lowp float d = max(dot(L, N), 1.f));
        lowp float spec = pow(max(dot(R,E), 1.f), 13.f);

        gl_FragColor = (d + spec) * vec4(vColor.rgb, .7f);
    }
</code></pre>
