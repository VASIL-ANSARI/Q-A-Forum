<p>To a apply rules to every child under a specific node, you use a so-called <em>$ variable</em>.</p>

<p>So in your case:</p>

<pre><code>{
    "rules": {
        "$messageid": {
            ".read": "data.child('timestamp').val() &gt; (now - 300000)",
            ".write": true
        }
    }
}
</code></pre>

<p>So the rules under <code>$messageid</code> above apply to every message.</p>

<p>For more information, see the <a href="https://www.firebase.com/docs/security/guide/securing-data.html#section-dollar-variables" rel="nofollow">Firebase documentation on using $ variables</a>.</p>
