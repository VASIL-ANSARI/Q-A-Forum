<p><strong>Edit:</strong> The assumption below is not correct, I had a chance to fire up my IDE later and tested with and without Write and both populated the MemoryStream correctly.</p>

<p>I think you need to write to your MemeoryStream first.</p>

<p>As if my memory (no pun intended) serves me correctly this:</p>

<pre><code>MemoryStream ms = new MemoryStream(byteArrayIn);
</code></pre>

<p>Creates a memory stream of that size.</p>

<p>You then need to write your byte array contents to the memory stream:</p>

<pre><code>ms.Write(byteArrayIn, 0, byteArrayIn.Length);
</code></pre>

<p>See if that fixes it.</p>
