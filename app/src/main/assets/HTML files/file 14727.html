<p>The problem is that the anonymous class defined for the key does not evaluate equality in the way you like. Instead, you can use a Tuple for the key:</p>

<pre><code>From C In Credentials
... 
Group C.CredentialID, NE.ClientID, C.Version By key = 
       New Tuple(Of Integer, Integer)(NE.ClientID, C.CredentialID) 
       Into CGroup = Group 
Select New With {
       .ClientID = key.Item1, 
       .CredentialID = key.Item2, 
       .MaxVersion = CGroup.Max(Function(p) p.Version)
}
</code></pre>
