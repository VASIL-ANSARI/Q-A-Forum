<p>The realloc will only allocate space for 2 new elements but you assume it allocates space for 3 new elements.</p>

<p>Suggested change (in expandMem):</p>

<pre><code>unsigned long* newPtr=(unsigned long*)realloc(primePtr, (count+1+unit)*sizeof(unsigned    long));
</code></pre>
