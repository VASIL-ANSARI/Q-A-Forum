<p>Linq isn't designed for recursion and doesn't handle it well.  There are ways to shoehorn it but a standard recursive function would be much cleaner and easier to debug:</p>

<pre><code>Public Function IsInTree(Thing theThing, IEnumerable(Of Thing) tree) As Boolean
    If tree.Any(Function(t) t.Id = theThing.Id) Then 
        IsInTree = True
    ElseIf Children Is Not Nothing Then
        IsInTree = tree.Any(Function(t) IsInTree(theThing, t.Children))
    Else
        IsInTree = False
    End If
End Function
</code></pre>
