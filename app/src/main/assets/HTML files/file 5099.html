<p>I'm looking at the <a href="http://xmlsoft.org/html/libxml-xpath.html#xmlXPathEval" rel="nofollow">docs for xmlXPathEval()</a> and I can't see a reason why the first two code blocks above should do the same thing: In other words, why should the XPath processor's context in evaluating the second XPath be affected by the evaluation of the first? The doc doesn't say that xmlXPathEval() will change the passed-in context... Does xmlXPathEval() do that?</p>

<p>Seems to me what you would need to do, in order to get your second code example to work, is to pass in a ctx that is based on obj1 (the result of the first xmlXPathEval()) as the second argument to the second xmlXPathEval(). However I can't see how to derive an xmlXPathContextPtr from an xmlXPathObjectPtr.</p>

<p>The reason your 3rd code example "works" is that the result of the first XPath evaluation is ignored; the XPath expression <code>.//h3/img[@alt]</code> will select the specified <code>&lt;img&gt;</code> elements when the context is simply the root node (<code>/</code>). But it will match <strong>all</strong> img elements that are children of h3 elements and that have an alt attribute, <strong>not only</strong> those that are descendants of <code>div[@id='gall_list']</code>.</p>
