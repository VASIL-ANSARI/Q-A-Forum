<p>SQL Server does not recompile a query every time it is executed. It does this once, and it optimized for the exact values it sees the first time. I guess you have an unfortunate plan cached.</p>

<p>Try adding <code>OPTION (RECOMPILE)</code> at the end.</p>
