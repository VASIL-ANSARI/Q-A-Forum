<p>Is the first argument of the Package constructor by any chance the parent? If so, you are always passing null there which could be your issue.</p>

<p>Btw, I think you may be able to simplify your algorithm. </p>

<p>Can't something like this work:</p>

<pre><code>String[] hierarchical = Name.Split('.');
foreach (String node in hierarchical){
 if(!manager.Contains(node)){
      manager.AddToEnd(node); //adds node who's parent is the last node added

  }

}
</code></pre>

<p>Since each line is guaranteed to be "sorted" you know if you get a package that hasn't been added yet, its parent is the last node already added.</p>
