<p>You have not provided any space for the name of the value. You are passing an uninitialised pointer <code>valueName</code> to <code>RegEnumValue()</code>, which it rejects (apparently, by way of crashing your app). Try the following instead:</p>

<pre><code>char valueName[100];
DWORD valueSize = sizeof(valueName);
</code></pre>

<p>This reserves 100 characters for the returned value name.</p>

<p>You will also want to use <code>strcmp()</code> instead of <code>==</code> for testing string values:</p>

<pre><code>if (strcmp(valueName, subkey) == 0) ...
</code></pre>
