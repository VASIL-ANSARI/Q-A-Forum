<p>Maybe I missed something, but your javascript (at least what you put in the question), isn't updating anything on the page.  You said you have 0 in the progress bar all the time, which could be because you commented out the line that changes the display.</p>

<p><code>//document.getElementById("divProgress").innerHTML = result + "%";</code></p>

<p>Is the <code>alert</code> showing the correct value?  Also, have you confirmed that <code>UpdateSession()</code> is running correctly and actually setting a value in the session?</p>
