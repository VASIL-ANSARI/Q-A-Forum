<p>In mySql, assuming the table name 'products', the following query gives the result.</p>

<pre><code>select a.* from products a ,  products b where a.product_id &gt;= b.product_id and a.brand = b.brand group by a.product_id order by count(b.product_id) , a.product_id;
</code></pre>

<p>The result is</p>

<pre><code>+------------+---------+------+-------+
| product_id | name    | etc  | brand |
+------------+---------+------+-------+
|          1 | sample1 | etc  |     1 |
|          4 | sample4 | etc  |     2 |
|          2 | sample2 | etc  |     1 |
|          5 | sample5 | etc  |     2 |
|          3 | sample3 | etc  |     1 |
|          6 | sample6 | etc  |     2 |
+------------+---------+------+-------+
</code></pre>
