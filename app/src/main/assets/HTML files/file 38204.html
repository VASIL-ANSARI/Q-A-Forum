<p>What you need to do is make your ajax function recursive,  eg on completion, it calls its self, rather than using a loop.</p>

<p>Here is a full example, contained in a single php file, called ajax-example.php:</p>

<pre><code>&lt;?php
if($_SERVER['REQUEST_METHOD']=='POST'){
    sleep(1);
    echo $_POST['name'];
    die();
}
?&gt;
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
&lt;div id="load"&gt;doin nothin&lt;/div&gt;

&lt;textarea name="n" id="comment" cols="30" rows="10"&gt;&lt;/textarea&gt;
&lt;br/&gt;
&lt;button onclick="send()"&gt;send&lt;/button&gt;
&lt;div id="result"&gt;&lt;/div&gt;



&lt;script type="application/javascript"&gt;
    function send (){
        var url = document.getElementById('comment').value.split('\n'); //split input from textarea in array
        var current = 0;
        var total = url.length;
        document.getElementById("load").innerHTML='loading';//'&lt;img src="ajax-loader.gif" /&gt;';
        //call ajax for 1st time
        ajax();

        function ajax(){
            //if there are urls left to process
            if(current &lt; total){
                var http = new XMLHttpRequest();
                http.open("POST", "/ajax-example.php", true);
                http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
                http.send("name=" + url[current]);
                //increment current marker
                current++;
                http.onreadystatechange=function() {
                    if (http.readyState == 4) {
                        var res = document.getElementById("result");
                        res.innerHTML=res.innerHTML + http.responseText +"&lt;/br&gt;";
                        //recursive call
                        ajax();
                    }
                }
            }else{
                //we are done, remove the loading img
                document.getElementById("load").innerHTML='finished';
            }
        }
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Just to add, dont discount jQuery just because you dont like the syntax, it can make your life a lot easier for non trivial dom manipulation</p>
