<p>I'm willing to bet that the server changing the location is causing the browser to not send the "Referer" header.</p>

<p>Try <code>header('Referer: /cart');</code> in the <code>/checkout</code>.</p>

<p>Since the user is not clicking on anything in between precheckout and checkout, you need to manually set it. If the user isn't always going to be clicking that link to get to the checkout page (i.e. bookmarking it), it may be better to set a session variable to determine if they just came from the cart and if they did use the header code above.</p>
