<p>You could use this update to that code:</p>

<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>// Pass the item list and the desired category as arguments:
var findItem = function(items, category, desiredItem) {
    // apply filter to items, so only those of the given category remain:
    items = items.filter( item =&gt; item.category == category );
    // rest of code remains the same:
    var possible = items.some( ({item, probability}) =&gt; 
          item === desiredItem &amp;&amp; probability &gt; 0 );
    if (!possible) {
        console.log('There is no chance you\'ll ever find a ' + desiredItem);
        return;
    }
    var sum = items.reduce( (sum, {item, probability}) =&gt; sum+probability, 0 );
    var t = 10;
    while (true) {
        var value = Math.random() * sum;
        var lootedItem = items.find( 
                ({item, probability}) =&gt; (value -= probability) &lt;= 0 ).item;
        if (lootedItem === desiredItem) break; // fixed this condition!
        console.log("Dang! A " + lootedItem + " was found...");
        t--; if (t &lt;= 0) throw "loop";
    }
    console.log("Lucky! A " + desiredItem + " was found!");
}

// Define items here with their category
var items = [
    { item: "rusty nail", probability: 0.25, category:  2 },
    { item: "stone",      probability: 0.23, category:  2 },
    { item: "banana",     probability: 0.20, category:  2 },
    { item: "leaf",       probability: 0.17, category:  5 },
    { item: "mushroom",   probability: 0.10, category:  5 },
    { item: "diamond",    probability: 0.05, category: 10 }
];

// Call function with extra arguments:
findItem(items, 5, 'mushroom');

console.log('second run:');
// This will obviously give a hit immediately, as there is only one possible item:
findItem(items, 10, 'diamond');</code></pre>
</div>
</div>
</p>

<p>The changes are:</p>

<ul>
<li>Pass more arguments to your function: the items list and the desired category</li>
<li>Apply a filter on the items list as first action in the function</li>
<li>Fix an issue concerning the <code>lootedItem</code> test -- it had "diamond" hard-coded.</li>
<li>Define the items list outside of the function and add category values to each element.</li>
<li>Adapt the call of the function to pass the extra arguments.</li>
</ul>
