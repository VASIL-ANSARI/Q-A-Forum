<p>I finally found a solution to my issue. However I still don't know if it's a Doctrine2 defect or if it works as designed.</p>

<p>I need to persist my user and flush before adding friends.</p>

<p>So my working code is:</p>

<pre><code>$em-&gt;persist($user);
$em-flush();

$user-&gt;addFriendList($friend);
$em-&gt;persist($user);
$em-&gt;flush();
</code></pre>
