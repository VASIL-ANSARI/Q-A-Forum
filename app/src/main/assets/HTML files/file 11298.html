<p>To calculate the Euler angle you need to compute the angle between the reference vector and the current gravity vector.  </p>

<p><a href="http://chemistry.about.com/od/workedchemistryproblems/a/scalar-product-vectors-problem.htm" rel="nofollow">http://chemistry.about.com/od/workedchemistryproblems/a/scalar-product-vectors-problem.htm</a></p>

<p>The rotation matrix is pretty easy after that.
<a href="http://en.wikipedia.org/wiki/Rotation_matrix" rel="nofollow">http://en.wikipedia.org/wiki/Rotation_matrix</a></p>

<p>Note I am sure there are plenty of easy ways to do this within ios and android without having to make these calculations manually.   This answer is just how the geometry works out.</p>
