<p>I did something similar with raw sockets. I held user objects which contained the connected socket, the name, and whether they are chatting.  If a user is not in chat he can type a command <code>/list users</code> which gives the list of users currently connected. When he has found someone to chat with he enters the command <code>/chat bob</code>. If the user <code>bob</code> is already chatting he will receive a message from the server saying that <code>bob is in a chat already</code>. Otherwise a chat session will be established between the two users. They now will be in chat until one of them enters <code>/endchat</code>. Then they will be able to find new people to chat with.</p>

<p>The trick is implementing the server so it can track a list of users and their chatting status and who they are in chat with so when ever they type <code>/endchat</code> the other user can be notified.</p>
