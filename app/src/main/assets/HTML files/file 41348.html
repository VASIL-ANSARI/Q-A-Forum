<p>You are getting a cartesian product between the two.  Instead, just use conditional aggregation:</p>

<pre><code>SELECT sd.SurveyYear, sd.BookId, 
       sum(case when sd.Grade = '3' then 1 else 0 end) as Grade3,
       sum(case when sd.Grade = '4' then 1 else 0 end) as Grade4
FROM SurveyDatas sd
GROUP BY sd.SurveyYear, sd.BookId;
</code></pre>

<p>The self-join is not necessary.</p>
