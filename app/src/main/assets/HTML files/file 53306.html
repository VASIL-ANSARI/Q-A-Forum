<p>You can use <code>over(partition by...)</code> along with your <code>Avg</code>.</p>

<pre><code>SELECT A.ID
    , A.CODE
    , AVG(B.VALUE) OVER(PARTITION BY A.ID)
FROM TableA A
LEFT JOIN TableB B
on a.code = b.code
</code></pre>
