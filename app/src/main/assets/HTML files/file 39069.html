<p>I'm not sure what you're trying to accomplish but let's break down the syntax and see what is matching. Maybe this will help you develop a better regex!</p>

<p>To eliminate confusion, your linked example had the regex without the <code>[^A]</code> near the end:</p>

<pre><code>(.*?(?:[AWMS]{2}|\d{1,2})\s*[A-Z]{2}\s*(?:[A-Z3]{1,3}|\d{1,2}))
</code></pre>

<p>The first <code>.*?</code> at the very beginning matches <code>"v "</code>.</p>

<p>Then <code>[AWMS]{2}</code> matches <code>"MS"</code>. The first <code>\s*</code> afterwards matches nothing--a star can match 0.</p>

<p>Then <code>[A-Z]{2}</code> matches <code>"WO"</code>, so far so good...</p>

<p>The next <code>\s*</code> matches one space.</p>

<p>Then in the next group, <code>[A-Z3]{1,3}</code> doesn't match <code>"2"</code>, so the pipe <code>|</code> kicks in and allows <code>\d{1,2}</code> to be evaluated, which happily matches <code>"2"</code>.</p>

<p>Annnd we're done!</p>

<p>I'm not 100% on what you're trying to do but it appears you want that string without the A...in which case you want to match the whole string, but do away with certain parts of it.
So I would take out the outer capturing group and use capturing groups in small parts.</p>

<pre><code>(.*?)([AWMS]{2}|\d{1,2})(\s*[A-Z]{2}\s*)([A-Z3]{1,3}|\d{1,2})(?:A?)(\d{1,2})?
</code></pre>

<p>Now a replacement string of <code>$1$2$3$4$5</code> will turn <code>"v MSWO 2A4"</code> into <code>"v MSWO 24"</code>.</p>

<p>Note I added the very last <code>?</code> because I saw without it, the matching changed on the last line of your samples...I thought the part the extra question mark qualifies an omission on your part (my best guess) that you need to match the last <code>4</code>, but perhaps it's not necessarily there.</p>
