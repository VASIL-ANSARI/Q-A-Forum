<p>I didn't closely analyse your code, but I did notice this:</p>

<pre><code>$("&lt;div&gt;&lt;/div&gt;").attr('id',id).append('&lt;div class="popup-box chat-popup cy'+id+'" id="'+ id +'"&gt;&lt;div class="popup-messages"&gt;&lt;div id="iFrame1" name="CmainFrame" width="100%" height="249" style="overflow:hidden" class="if'+ cmd +'"&gt;&lt;object type="text/html" data="../Cchat.php?u='+ cmd +'"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;');
</code></pre>

<p>I don't know what you <em>think</em> that is going to do, but what it does do is create a div, assign it an id, give some children, and then throw the whole thing away.  Did you want to insert it somewhere?</p>

<p><strong>Edit:</strong></p>

<p>For example, you could write:</p>

<pre><code>$("body").append('&lt;div class="popup-box chat-popup cy'+id+'"...
</code></pre>

<p>(Find the body and insert in the new div at its bottom.)</p>

<p>or </p>

<pre><code>$("#" + id).append('&lt;div class="popup-box chat-popup cy'+id+'"...
</code></pre>

<p>(Find the existing div with the given ID append the new div to it.)</p>
