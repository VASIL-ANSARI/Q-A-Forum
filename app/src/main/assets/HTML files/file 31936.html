<p>in controller you define:</p>

<p><code>@closepost</code></p>

<p>while in view you are calling:</p>

<p><code>@closeposts</code></p>

<p>and you call <code>.each</code> on a variable that is not defined.</p>

<p><strong>update</strong></p>

<pre><code>irb&gt; a=Geokit::Geocoders::GoogleGeocoder.geocode '140 Market St, San Francisco, CA' 
irb&gt; a.ll 
=&gt; 37.79363,-122.396116

@closeposts = Post.within(5, :origin =&gt; @city.ll).order('distance DESC')Â 
</code></pre>

<p><strong>with geocode</strong></p>

<pre><code>@closeposts = Post.near('dublin', 50, :order =&gt; :distance)
</code></pre>

<p>You missed the distance parameter</p>
