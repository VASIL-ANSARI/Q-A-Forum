<p>It sounds like your field type is not actually a <code>double</code> but an <code>int</code>.  Your query tries to (implicitly) unbox an <code>int</code> as a <code>double</code> causing the cast error.  Change the query so the field is read as an <code>int</code>.</p>

<pre><code>from t in dt.AsEnumerable()
where t.Field&lt;int&gt;("T_TEMPLATE_ID") == iTemplateId
select t;
</code></pre>
