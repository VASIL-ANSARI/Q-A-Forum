<p>The following line tells iOS that you have ASCII data:</p>

<pre><code>NSString *stringa= [NSString stringWithCString:strRet encoding:NSASCIIStringEncoding];
</code></pre>

<p>However, the â¬ symbol or accented letters aren't part of ASCII. So you obviously have a different.</p>

<p>Figure out what encoding it is (e.g. UTF-8, Windows ANSI, ISO-8859-1) and update the line accordingly, e.g.:</p>

<pre><code>NSString *stringa= [NSString stringWithCString:strRet encoding: NSWindowsCP1251StringEncoding];
</code></pre>

<p><strong>Update</strong></p>

<p>Figuring out what encoding is being used can be tricky.</p>

<p>From my experience, VB6 and SQL Server are a good pair as they usually don't mess up the encoding. The weak part is the text file, which depends on the encoding but doesn't contain any explicit information about what encoding was used. VB6 probably uses the Windows default setting, which depends on your language setting. Unfortunately, I don't know where you can see the default encoding in Windows.</p>

<p>In Western countries, the encoding is usually set to Windows ANSI aka Code Page 1251 (that's where the constant <code>NSWindowsCP1251StringEncoding</code> comes from).</p>

<p>You can more or less verify it. If you open a text files that contains the Euro symbol (â¬), it must use the value 80 (hex) if it's encoded in CP 1251. In Latin-1 (aka ISO-8859-1) you cannot represent the euro symbol. In Latin-9 (aka ISO-8859-15), it would use A4 (hex). And in UTF-8, three bytes would be required: E2 82 AC.</p>

<p>So check it yourself. If you're unsure, add a hex dump of a relevant piece of your text file.</p>
