<p>Problem solved, found the leak. Just want to answer myself to close this question.</p>

<p>I delete a child through</p>

<pre><code>    //garbage collection
    if (state.children.isEmpty()) {//if this is a leaf node (no children)
        state.parent.children.remove(state);
    }
</code></pre>

<p>And the leak happens at every</p>

<pre><code>    if (some_condition) {
        child.visited = true;
    }
</code></pre>

<p>If a node is prematurely set to be visited, I will not be able traverse to that node and check if the node's children is empty or not. Resulting in the node not being recycled.</p>

<p>Viola.</p>
