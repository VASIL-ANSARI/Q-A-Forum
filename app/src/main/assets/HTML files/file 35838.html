<p>Found a solution.</p>

<p>The top command must have the number in brackets ie TOP (10) and the HasRows command is not supported apparently so removing that line also enables the query to function.</p>
