<p>I apologize that this doesn't directly answer your question, but it does provide a solution:</p>

<p>There's no technical reason any of this needs to be in the <code>&lt;head&gt;</code>, and I'm unsure of a good way to bring that dynamically generated JS into the head.</p>

<p>The requirement I do see is that MasterTmsUdo needs to be set before your CJ affiliate javascript. So you may be better off just including the CJ affiliate javascript at the very end of the page (so it will be loaded <em>after</em> your <code>success.phtml</code>), just above the <code>&lt;/body&gt;</code>, which you can do like this:</p>

<pre><code>&lt;default&gt;
    &lt;reference name="before_body_end"&gt;
        &lt;action method="addJs"&gt;&lt;script&gt;commissionjunction/cj.js&lt;/script&gt;&lt;/action&gt;
    &lt;/reference&gt;
&lt;/default&gt;
</code></pre>

<p>where <code>siteroot/js/commissionjunction/cj.js</code> contains</p>

<pre><code>/*DO NOT ALTER *** tt*/(function(e){var t="1340",n=document,r,i,s={http:"http://cdn.mplxtms.com/s/MasterTMS.min.js",https:"https://secure-cdn.mplxtms.com/s/MasterTMS.min.js"},o=s[/\w+/.exec(window.location.protocol)[0]];i=n.createElement("script"),i.type="text/javascript",i.async=!0,i.src=o+"#"+t,r=n.getElementsByTagName("script")[0],r.parentNode.insertBefore(i,r),i.readyState?i.onreadystatechange=function(){if(i.readyState==="loaded"||i.readyState==="complete")i.onreadystatechange=null}:i.onload=function(){try{e()}catch(t){}}})(function(){});
</code></pre>
