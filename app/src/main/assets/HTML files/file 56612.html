<p>You can use this:</p>

<pre><code>def prox(series):
    groupby_idx = series.notnull().cumsum()
    groupby = series.groupby(groupby_idx)
    return groupby.apply(lambda x: pd.Series(range(len(x)))).values

prox(df1.A)

array([0, 0, 1, 2], dtype=int64)
</code></pre>

<p>then assign to df1:</p>

<pre><code>df1['Proximity'] = prox(df1.A)

print df1.ffill()

     A    B    C  Proximity
0  0.0  0.0  0.0          0
1  1.0  2.0  3.0          0
2  1.0  2.0  3.0          1
3  1.0  2.0  3.0          2
</code></pre>
