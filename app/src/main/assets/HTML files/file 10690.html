<p>Using System.Diagnostics, I tried this:</p>

<pre><code>foreach(Process theprocess in Process.GetProcesses())
{
            Console.WriteLine("Process: {0} ID: {1}", theprocess.ProcessName, theprocess.Id);
}
</code></pre>

<p>And got this result:</p>

<p>Process: AgentMon ID: 2948 <br>
Process: OUTLOOK ID: 3144 <br>
Process: ctfmon ID: 3136 <br>
...</p>

<p>Now, I am an admin on a Win XP machine...  YMMV, as it were.</p>

<p>I know you had stated to use PSAPI, but is there some reason you have to use that and not just regular managed C#?</p>
