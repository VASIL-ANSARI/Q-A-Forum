<p>Your statements are not equivalent. <code>CREATE ... SELECT</code> creates the columns you mention in the <code>CREATE</code> part of the statement (that is, entity_id and numrels), and in addition creates columns for each column of the <code>SELECT</code> part of the statement. You end up with four columns in your new table. The results of <code>SELECT</code> are inserted into the last two columns. The other columns are filled with their default values, which results in violating the uniqueness of your primary key.</p>

<p>See also <a href="http://dev.mysql.com/doc/refman/5.0/en/create-table-select.html" rel="nofollow">http://dev.mysql.com/doc/refman/5.0/en/create-table-select.html</a></p>
