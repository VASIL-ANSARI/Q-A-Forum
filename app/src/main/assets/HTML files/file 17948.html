<p>Vertica doesn't have stored procedures. You'll need to do it programmatically in some fashion outside of Vertica.</p>

<p>The psuedo logic you have is good; just implement it in something (JAVA, C++, ect). You won't need to execute a 'rollback'. When loading the data (with <code>NO COMMIT</code>), it's not going to be committed until you execute a <code>COMMIT</code> statement. </p>
