<p><code>$this</code> only exists inside methods that are part of classes. <code>$this</code> does not exist in functions or anywhere else that is not part of a class. Take a look at the PHP manual page about <a href="http://www.php.net/manual/en/language.oop5.basic.php" rel="nofollow">basic OOP</a> for more about this.</p>

<p>If you want to refer to the global variable <code>$connection</code> instead, you can do that by changing the beginning of the function to:</p>

<pre><code>function Message_Parse($id)
{
    global $connection;
    if (is_resource($connection))
    {
</code></pre>

<p>Do note though that using global variables is bad programming practice in any language.</p>
