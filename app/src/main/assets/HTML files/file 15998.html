<p>You will need to use the same lock to protect the <code>_randIdx</code> global variable in both the encryption and the decryption.  <code>_randData</code> is not modified, so no need to protect it specifically.  As all methods of the class are <code>static</code>, you don't have any other members to protect from simulateous access/modification</p>
