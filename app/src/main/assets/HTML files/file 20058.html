<p>You're trying to do a lot all at once.</p>

<p>This code is simpler and shows how to write a test for a module:</p>

<pre><code>#foo/lib/hi.rb
module Hi

  def hi
    puts "hello"
  end

end

#foo/test/hello_test.rb
class HelloTest &lt; ActiveSupport::TestCase

  class X
    include Hi
  end

  test "says hello" do
    assert_equal X.new.hi, "hello"
  end

end
</code></pre>

<p>To run the test using just plain ruby:</p>

<pre><code>ruby -Ilib -Itest test/*.rb
</code></pre>

<p>Are you able to run this successfully?</p>
