<p>Here is a total shot in the dark for converting this to an iTVF. </p>

<pre><code>CREATE FUNCTION TimeModifier 
    (
        -- Add the parameters for the function here
       @InputDate datetime
       , @shopperid int
    )
    RETURNS TABLE WITH SCHEMABINDING
AS RETURN

    select DATEADD(Hour, case when t.TimeOfYear = 0 then z.winter else z.summer end, @InputDate) as MyResult
    from d.dbo.shopper s
    join [MMD_Feed].[dbo].[ZipCodeZones] z on s.zip = z.zip
    cross apply 
    (
        SELECT count(*) as TimeOfYear
        FROM [d].[dbo].[DST-Dates] 
        where @inputdate &gt;= startdate 
            and @inputdate &lt;= enddate 
    ) t
    where s.shopperid = @shopperid
</code></pre>
