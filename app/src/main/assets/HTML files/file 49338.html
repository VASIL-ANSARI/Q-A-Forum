<pre><code>DROP PROCEDURE IF EXISTS FindNumberOfCopies;
DELIMITER $$
CREATE PROCEDURE FindNumberOfCopies
( 
 IN itemTitle varchar(150)
)
BEGIN
    SELECT copies FROM item WHERE title = itemTitle;

    UPDATE item SET copies = newCopies where title = itemTitle;
END
$$
DELIMITER ;
</code></pre>

<p>There is no point in your <code>select</code>. There is no point in your transaction. You did a rollback of a transaction that did not even occur.</p>

<p>Each sql call regardless is a transaction. You are wrapping a trans with a trans. Along the way of this edit I somehow removed the 1064</p>
