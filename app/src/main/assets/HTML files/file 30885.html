<p>The following nested <code>for</code> loop </p>

<pre><code> #pragma omp for
 for(j=1; j &lt;= i; j++) 
</code></pre>

<p>will be executed in parallel, each thread with a different value of <code>j</code> in no specific order.
As nothing is specified in the <code>omp for</code> section, <code>k</code> will be shared by default between all threads. So depending on the order of the threads, <code>k</code> will be decremented at an unknown time (even with the <code>omp atomic</code>). So for a fixed <code>j</code>, the value of <code>k</code> might change during the execution of the body of the for loop (between the <code>if</code> clauses, ...).</p>
