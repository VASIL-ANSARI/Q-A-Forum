<p>Unless I'm mistaken, your proposed field-list is pretty close to what you'd actually need in a query. I haven't tested this, but give this one a shot (it uses MySQL's <code>GROUP BY</code> to do the <code>DISTINCT</code>/grouping you require):</p>

<pre><code>SELECT
    B,
    COUNT(*),
    SUM((CASE WHEN E != 0 THEN C ELSE 0 END)),
    SUM(D),
    SUM(E)

FROM
    your_table

GROUP BY B
</code></pre>
