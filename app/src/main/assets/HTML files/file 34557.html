<p>What you're doing simply must be damn slow. If you don't have the memory for all the JSON object, then try to store the data as normal Java objects as this way you surely need much less.</p>

<p>And there's a simple way needing even much less memory and only <code>n</code> passes, where <code>n</code> is the ratio of required memory to available memory.</p>

<p>On the <code>i</code>th pass consider only objects with <code>id % n == i</code> and ignore all the others. This way the memory consumption reduces by nearly factor <code>n</code>, assuming the <code>id</code>s are nicely distributed modulo <code>n</code>.</p>

<p>If this assumption doesn't hold, use <code>f(id) % n</code> instead, where <code>f</code> is some hash function (feel free to ask if you need it).</p>
