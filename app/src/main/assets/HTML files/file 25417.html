<p>Here is the code I use:</p>

<pre><code>int64_t __pow10_arr[18] = { 1l, 10l, 100l, 1000l, 10000l, 100000l,
                            1000000l, 10000000, 100000000l, 1000000000l, 10000000000l, 100000000000l,
                            1000000000000l, 10000000000000l, 100000000000000l, 1000000000000000l, 10000000000000000l, 100000000000000000l };

double roundToNfractions ( double val, int n )
{
  if (n&lt;0 || n &gt;= ( sizeof (__pow10_arr)/ sizeof (int64_t) ) ) {
    // log error however you wish to
    return val;
  }
  val *= __pow10_arr[n];
  val += 0.5;
  val = (uint64_t) val;
  val /= __pow10_arr[n];
  return val;
}
</code></pre>
