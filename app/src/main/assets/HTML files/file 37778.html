<p>I think you want <code>row_number()</code>:</p>

<pre><code>select t.*
from (select t.*,
             row_number() over (partition by region, market order by gaps desc) as seqnum
      from tablename t
     ) t
where seqnum &lt;= 10;
</code></pre>

<p>I am not sure if you want <code>name</code> in the <code>partition by</code> clause.  If you have more than one name within a market, that may be what you are looking for.  (Hint: Sample data and desired results can really help clarify a question.)</p>
