<p>you need to request a token from google.. here's the class to get a token from google</p>

<pre><code>public class GoogleJsonWebToken
{
    public const string SCOPE_DRIVE_READONLY = "https://www.googleapis.com/auth/drive.readonly";
    public const string SCOPE_DRIVE = "https://www.googleapis.com/auth/drive";

    public static dynamic GetAccessToken(string clientIdEMail, string keyFilePath, string scope)
    {
        // certificate
        var certificate = new X509Certificate2(keyFilePath, "notasecret");

        // header
        var header = new { typ = "JWT", alg = "RS256" };

        // claimset
        var times = GetExpiryAndIssueDate();
        var claimset = new
        {
            iss = clientIdEMail,
            scope = scope,
            aud = "https://accounts.google.com/o/oauth2/token",
            iat = times[0],
            exp = times[1],
        };

        JavaScriptSerializer ser = new JavaScriptSerializer();

        // encoded header
        var headerSerialized = ser.Serialize(header);
        var headerBytes = Encoding.UTF8.GetBytes(headerSerialized);
        var headerEncoded = Convert.ToBase64String(headerBytes);

        // encoded claimset
        var claimsetSerialized = ser.Serialize(claimset);
        var claimsetBytes = Encoding.UTF8.GetBytes(claimsetSerialized);
        var claimsetEncoded = Convert.ToBase64String(claimsetBytes);

        // input
        var input = headerEncoded + "." + claimsetEncoded;
        var inputBytes = Encoding.UTF8.GetBytes(input);

        // signiture
        var rsa = certificate.PrivateKey as RSACryptoServiceProvider;
        var cspParam = new CspParameters
        {
            KeyContainerName = rsa.CspKeyContainerInfo.KeyContainerName,
            KeyNumber = rsa.CspKeyContainerInfo.KeyNumber == KeyNumber.Exchange ? 1 : 2
        };
        var aescsp = new RSACryptoServiceProvider(cspParam) { PersistKeyInCsp = false };
        var signatureBytes = aescsp.SignData(inputBytes, "SHA256");
        var signatureEncoded = Convert.ToBase64String(signatureBytes);

        // jwt
        var jwt = headerEncoded + "." + claimsetEncoded + "." + signatureEncoded;

        var client = new WebClient();
        client.Encoding = Encoding.UTF8;
        var uri = "https://accounts.google.com/o/oauth2/token";
        var content = new NameValueCollection();

        content["assertion"] = jwt;
        content["grant_type"] = "urn:ietf:params:oauth:grant-type:jwt-bearer";

        string response = Encoding.UTF8.GetString(client.UploadValues(uri, "POST", content));

        var result = ser.Deserialize&lt;dynamic&gt;(response);

        return result;
    }

    private static int[] GetExpiryAndIssueDate()
    {
        var utc0 = new DateTime(1970, 1, 1, 0, 0, 0, 0, DateTimeKind.Utc);
        var issueTime = DateTime.UtcNow;

        var iat = (int)issueTime.Subtract(utc0).TotalSeconds;
        var exp = (int)issueTime.AddMinutes(55).Subtract(utc0).TotalSeconds;

        return new[] { iat, exp };
    }

}
</code></pre>

<p>and for the download itself i'm using this</p>

<pre><code>            public static byte[] GetFile(string fileID, out string contenttype, out string filename)
    {
        DALParameter dalp = new DALParameter();
        var gdEmail = dalp.GetParameter(INMDTO.Parameters.GoogleDriveLogin, INMDTO.ParametersLevel.General, 0);
        var credential = GetCertificate();
        var service = new DriveService(new BaseClientService.Initializer()
        {
            HttpClientInitializer = credential,
            ApplicationName = "tttt",
        });
        string path = AppDomain.CurrentDomain.BaseDirectory + "App_Data\\";
        string certFile = "gd.p12";
        string fullcertpath = Path.Combine(path, certFile);
        var email = gdEmail;
        var auth = GoogleJsonWebToken.GetAccessToken(email, fullcertpath, GoogleJsonWebToken.SCOPE_DRIVE_READONLY);

        var f = service.Files.Get(fileID).Execute();
        contenttype = f.MimeType;
        filename = f.OriginalFilename;
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(new Uri(f.DownloadUrl));
        req.Headers.Add("Authorization", auth["token_type"] + " " + auth["access_token"]);
        HttpWebResponse response = (HttpWebResponse)req.GetResponse();
        if (response.StatusCode == HttpStatusCode.OK)
        {
            Stream sourceStream = response.GetResponseStream(); // the ConnectStream
            byte[] array;
            using (var ms = new MemoryStream())
            {
                sourceStream.CopyTo(ms);
                array = ms.ToArray();
            }
            return array;
        }
        return null;
    }
</code></pre>

<p>it might not be the best solution but it works and i didn't really find another way to do it.
hope this helps you a little. </p>
