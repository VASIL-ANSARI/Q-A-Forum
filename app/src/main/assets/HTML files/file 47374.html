<p>Tricky but try this:</p>

<pre><code>    with myCte
as
(
select Signature_Usr,
Case
 when CONVERT(Time,TimeofTransaction) &lt; CONVERT(TIME,'1900-01-01 9:00:00.000') then Before9
 when CONVERT(Time,TimeofTransaction) &lt; CONVERT(TIME,'1900-01-01 10:00:00.000') and 
  CONVERT(Time,TimeofTransaction) &gt;= CONVERT(TIME,'1900-01-01 9:00:00.000') then After9Before10
 /* And So On */
 End as TimePeriord
 from myTable

)

select Signature_USR,COUNT(Signature_USR) as CountOfTrans,TimePeriod
 from myCte
 Group by Rollup(Signature_USR,TimePeriod)
</code></pre>
