<p>It's not entirely clear what you're trying to achieve, but in R, you use <code>crossprod</code> to form cross-products: given matrices <code>X</code> and <code>Y</code> with compatible dimensions, <code>crossprod(X, Y)</code> returns X<sup>T</sup>Y. Similarly, matrix multiplication is achieved with the <code>%*%</code> operator: <code>X %*% Y</code> returns the product XY. So you can get X<sup>T</sup>AY as <code>crossprod(X, A %*% Y)</code> without having to worry about the mechanics of matrix multiplication, loops, or whatever.</p>

<p>If your matrices have a particular structure that allows optimising the computations (symmetric, triangular, sparse, banded, ...), you could look at the <code>Matrix</code> package, which has some support for this.</p>

<p>I haven't used Matlab, but I'm sure it would have similar functions for these operations.</p>
