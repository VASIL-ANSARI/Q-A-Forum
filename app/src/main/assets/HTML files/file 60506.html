<p>Okay, so I figured out that the fragment thing is not required. The header has the following numbers:</p>

<ul>
<li>1 and 3: The length of the header itself (zero-padding is necessary to achieve predictable results, otherwise the header length changes after putting in the numbers, making the numbers invalid)</li>
<li>2 and 4: The length of the header + the number of UTF-8 bytes of the entire HTML document</li>
</ul>

<p>This can be pasted into Word and Excel. No fragments or HTML comments required.</p>

<p>Sample C# code:</p>

<pre><code>int start = header.Length;
int end = header.Length + Encoding.UTF8.GetByteCount(html);
</code></pre>
