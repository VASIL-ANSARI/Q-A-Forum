<pre><code>select t1.from_user_id, t1.message
from t1
join (
select from_user_id, max([datetime]) as [datetime]
from t1
group by from_user_id
) t2 on t1.from_user_id = t2.from_user_id
and t1.[datetime] = t2.[datetime]
</code></pre>
