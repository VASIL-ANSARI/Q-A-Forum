<p>Add this above your other rules:</p>

<pre><code>RewriteCond %{HTTP_HOST} !^www\.
RewriteCond %{HTTP_HOST} ^([^.]+)\.example\.com$ [NC]
RewriteRule !^profile\.php$ /profile.php?subdomain=%1 [L,QSA]
</code></pre>
