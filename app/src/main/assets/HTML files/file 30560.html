<p>You're forgetting to reset <code>Duplicate</code> back to <code>false</code>. First time it is set to <code>true</code> it remains <code>true</code>, enabling an infinite <code>do...while</code> loop.</p>
