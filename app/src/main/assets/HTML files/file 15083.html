<p>Just before the second loop you try to split string "site_id=1," with a comma being a separator - the result will be an array of two strings with the second one being empty. Just change your inner foreach loop to the following:</p>

<pre><code>foreach (string col in result)
{
    if (string.IsNullOrEmpty(col))
        continue;

    string[] kv = col.Split('=');
    resultSet[count].Add(kv[0], kv[1]);
}
</code></pre>
