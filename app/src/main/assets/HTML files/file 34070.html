<p>Firstly, I'm not convinced by explanation for why you need to do this.  There is something wrong with your system design or implementation if it is necessary to know the file size before you start uploading.</p>

<p>Having said that, the solution is basically to create the ZIP file before you start uploading it:</p>

<ul>
<li><p>Write the ZIP file to a temporary file and upload from that.</p></li>
<li><p>Write the ZIP file to an buffer in memory and upload from that.</p></li>
<li><p>If you don't have either the file space or the memory space, then:</p>

<ul>
<li><p>Create "sink" outputStream that simply counts the bytes that are written to calculate the nominal file size.</p></li>
<li><p>Create / write the ZIP file to the sink, and capture the file size.</p></li>
<li><p>Open your connection for uploading.</p></li>
<li><p>Send the metadata including the file size. </p></li>
<li><p>Create / write the ZIP a second time, writing to the socket stream ... or whatever.</p></li>
</ul></li>
</ul>

<p>These 3 approaches will all allow you to create and send a compressed ZIP, if that is going to help.</p>

<hr>

<p>If you insist on trying to do this on-the-fly in one pass, then you are going to need to read the ZIP file spec in forensic detail ... and do some messy arithmetic.  Helping you is probably beyond the scope of a SO question.</p>
