<p>Try this rule which, instead of checking for <code>HTTPs == off</code>, checks <code>HTTPS != ON</code>.</p>

<pre><code>&lt;rule name="Redirect to https" stopProcessing="true"&gt;
  &lt;match url="(.*)" /&gt;
  &lt;conditions&gt;
    &lt;add input="{HTTPS}" pattern="^ON$" negate="true" /&gt;
  &lt;/conditions&gt;
  &lt;action type="Redirect" url="https://{HTTP_HOST}{REQUEST_URI}" redirectType="Permanent" appendQueryString="false" /&gt;
&lt;/rule&gt;
</code></pre>

<p>I can't explain why your rule wouldn't work, but this is the rule I've been using and I've had no problem. Worth noting: I have seen occasional issues with IIS rewrite rules when using the <code>HTTP_HOST</code> value, almost as if it has the wrong value, so it may be safe to say that IIS rewrite rules are not 100% reliable.</p>
