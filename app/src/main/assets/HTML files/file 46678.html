<p>Other questions indicate that Flex has the ability to manage <code>yylineno</code>  automatically via the <code>%option yylineno</code> directive.  That is, however, an extension in Flex compared with classic Lex.</p>

<p>Assuming that you cannot upgrade to Flex, 
you probably need to replace your rule</p>

<pre><code>\n { }
</code></pre>

<p>with</p>

<pre><code>\n { yylineno++; }
</code></pre>

<hr>

<p>As an aside, printing works best with newlines at the end of the format string. The buffered output is normally flushed when the newline is 'printed' â so the output won't necessarily appear until you print the newline after it.  Plan to write newlines at the end of the format string unless you have an incomplete line.  Newlines at the beginning are only needed when you need to double-space the output (or you are concerned that someone else has been sloppy about ending the output with a newline).</p>
