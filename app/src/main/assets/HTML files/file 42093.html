<p>A suspicious part of your code is:</p>

<pre><code>write(fd, out_w, sizeof(out_w))
</code></pre>

<p>Here, <code>out_w</code> is not an array, and the <code>sizeof</code> operator would yield the size of a <code>char *</code> pointer, not the length of the block.</p>

<p>You should pass the length of <code>out_store</code> to your <code>write_fifo</code> function.</p>

<p>Also, I'm not really sure what your intent is when using the <code>strtok</code> function.</p>
