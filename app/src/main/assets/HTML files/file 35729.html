<p>Well, as far as I am aware there is no in-built way in php to distinguish between malicious injected script tags and normal html tags.</p>

<p>This leads to problem where you want to block malicious script, but not valid html tags.</p>

<p>When I have to accept user input and display again which may contain html tags, instead of using <code>htmlentities</code> I use <a href="http://htmlpurifier.org/" rel="nofollow">htmlpurifier</a>. There is another one I am aware of is <a href="http://www.gwtproject.org/doc/latest/DevGuideSecuritySafeHtml.html" rel="nofollow">safeHtml</a>.</p>

<p>However, there might be better solutions then this and I am also interested in knowing as well. Unfortunately haven't came across one.</p>
