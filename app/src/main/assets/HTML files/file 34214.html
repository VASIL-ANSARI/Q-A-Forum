<pre><code>public function add($id = null) {

        if ($this-&gt;request-&gt;is('post')) {

            $user_id = $this-&gt;Auth-&gt;user('id');
            $guest_count = $this-&gt;Guest-&gt;find('count', array(
                                                            'conditions' =&gt; 
                                                                array('user_id' =&gt; )
                                                            )
                                                        );

            $guest_limit = $this-&gt;Auth-&gt;user('limit');
            if($guest_count &gt;= $guest_limit)
            {

                $this-&gt;Session-&gt;setFlash(__("error you can't add anymore"));
                return $this-&gt;redirect(array('controller' =&gt; 'Users', 'action' =&gt; 'view' , $id));

            } else {
                $this-&gt;Guest-&gt;create();
                if ($this-&gt;Guest-&gt;save($this-&gt;request-&gt;data)) {
                    $this-&gt;Session-&gt;setFlash(__('Guest added'));
                    return $this-&gt;redirect(array('controller' =&gt; 'Users', 'action' =&gt; 'view' , $id));
                } else {
                    $this-&gt;Session-&gt;setFlash(__('Invalid name entered'));
                    return $this-&gt;redirect(array('controller' =&gt; 'Users', 'action' =&gt; 'view' , $id));

                }
            }
        }
}
</code></pre>
