<p>Seems like you are receiving the following as output from your git commands -</p>

<pre><code>"'user@domain.com'\n"
</code></pre>

<p>You are directly passing this to smtpconnect, which is causing the issue, as this is not a valid email address. You probably need to get the actual string from it. One way to get it is to use <a href="https://docs.python.org/2/library/ast.html#ast.literal_eval" rel="nofollow"><code>ast.literal_eval()</code></a> function for that . Example -</p>

<pre><code>&gt;&gt;&gt; import ast
&gt;&gt;&gt; e = ast.literal_eval("'user@domain.com'\n")
&gt;&gt;&gt; print(e)
user@domain.com
</code></pre>

<p>You would need to do this when returning the email from the <code>get_user_email()</code> function . Most probably <code>committer_name</code> also has this issue, so you may want to do this for that as well.</p>

<hr>

<p>From documentation of <code>ast.literal_eval()</code> - </p>

<blockquote>
  <p><strong>ast.literal_eval(node_or_string)</strong></p>
  
  <p>Safely evaluate an expression node or a Unicode or Latin-1 encoded string containing a Python literal or container display. The string or node provided may only consist of the following Python literal structures: strings, numbers, tuples, lists, dicts, booleans, and None.</p>
</blockquote>
