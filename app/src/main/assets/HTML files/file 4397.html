<p>The problem here is you're confusing Code Access Security (CAS) with File System Permissions.  The former is a restriction which applies only to CLR processes while the latter is an operating system level restriction.  These two methods of security are independent of each other (although file system information can contribute to CAS policy).</p>

<p>In this case the <code>UnauthorizedAcessException</code> represents a lack of permissions in the file system but you're attempting to guard it with a CAS check which will not work.  </p>

<p>At the file system level (excluding CAS) the practice of attempting to verify an operation will or won't succeed before hand is really a futile one.  There is simply no way to do this properly because so many outside entities can change the file system between the check and attempt to access.  It's much more reliable to just try and access the file and catch the exception which results from the failed access.</p>

<p>Here's a link to a detailed blog post I wrote on this issue</p>

<ul>
<li><a href="http://blogs.msdn.com/b/jaredpar/archive/2009/12/10/the-file-system-is-unpredictable.aspx" rel="nofollow">http://blogs.msdn.com/b/jaredpar/archive/2009/12/10/the-file-system-is-unpredictable.aspx</a></li>
</ul>
