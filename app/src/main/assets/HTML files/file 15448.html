<p>You should replace this:</p>

<pre><code>if(round($value, 0) == $value)
</code></pre>

<p>By this:</p>

<pre><code>if(abs(round($value, 0) - $value) &lt; 0.005)
</code></pre>

<p>Because the tax and currency computations introduce some floating point imprecision.</p>
