<p>The <code>count</code> array in <code>radix_sort</code> is uninitialized and its values are used for creating values in <code>map</code>, which in the end (see <code>// Move</code>) is used to index <code>dst_p</code> and then it is BOOM.</p>

<p>After your fix to initialize them, you end up with <code>1954</code> in <code>map[1]</code>, which is too big for <code>dst_p</code>, so now you are looking at an algorithmic problem. Try to add some tracing print statements to tackle your problem. Or go into a debugger (<code>gdb</code> on Linux) and step through your program to verify that all steps are as expected.</p>
