<p>You need to create an <code>ItemsPanelTemplate</code> and set it's <code>VisualTree</code> to a <a href="http://msdn.microsoft.com/en-us/library/system.windows.frameworkelementfactory.aspx" rel="nofollow"><code>FrameworkElementFactory</code></a> (deprecated) which creates the <code>Grid</code>, or use the <a href="http://msdn.microsoft.com/en-us/library/system.windows.markup.xamlreader.aspx" rel="nofollow"><code>XamlReader</code></a> to <a href="http://msdn.microsoft.com/en-us/library/system.windows.markup.xamlreader.parse.aspx" rel="nofollow">parse</a> a XAML-string which specifies the template.</p>

<p><a href="http://stackoverflow.com/questions/5755455/how-to-set-control-template-in-code">This question</a> contains usage examples of both methods (albeit for a different template property).</p>

<p>An easier method to manipulate the panel at runtime is outlined in <a href="http://stackoverflow.com/questions/7319952/how-to-get-listbox-itemspanel-in-code-behind">this question</a>.</p>
