<p>Really well-written question.  Good bit of relevant code, and nice explanation of what you're stuck on.  Unfortunately, I don't see anything that stands out.</p>

<p>Your script looks mostly right.  You're close to being where you need to be.</p>

<p>Below is an answer that I just typed out, and then reread your question (and code), and thought a little better of.  You probably know this stuff already, but it's here for anyone else.  It's also relevant, because I don't see any errors in the relevant part of what you did, so you probably blew it somewhere else.  The questions are: where and how?</p>

<p>Hopefully someone less exhausted than i am will come along and find the obvious problem, in the meantime, here's my scrawl about how to debug in Ext and why:</p>

<hr>

<p>You've left something important out, or overlooked it.  That error message you mentioned: <code>Uncaught TypeError: Cannot read property 'data' of undefined</code> -- <strong>where</strong> is that happening?  It looks like it's not happening in the code you posted, it might very well be happening down in the bowels of ExtJS.</p>

<p>So, fire up FireBug, and turn on the "break on error" feature.  Make your error happen, and start looking at the "stack" pane over on the right (usually).  The stack will show you how you got to where you are. </p>

<p>Unless I'm missing something (and since I'm just running your code in my head, I very well may be), there's probably something misconfigured elsewhere that's causing your bug.  </p>

<p>But as with any program (and especially with ExtJS, in my experience), the debugger is your friend. </p>

<p>Do this:</p>

<ul>
<li>Use the <code>-debug</code> version of ext-base.js and ext-all.js (until it all works)</li>
<li>Use firebug, and "break on errors"</li>
<li>Learn to use the debugger to step through code, and to watch the data you're operating on.</li>
<li>Don't give up when you find yourself deep in the bowels of ExtJS.  If you try, you'll start to get a sense of WTF is going on, and even if you don't understand it all, it will start to give you hints about where you screwed up.</li>
</ul>
