<p>Try:</p>

<pre><code>ALTER PROCEDURE [dbo].[gspVEBUserLastLoginDetails_GetLastLogin]
(
    @userLastLoginUserId bigint = null
)
AS
BEGIN
    IF COALESCE(@userLastLoginUserId,0)&lt;&gt;0
    BEGIN
        SELECT MAX(VEB_UserLastLoginDetails.UserLastLogin_Date)
        FROM VEB_UserLastLoginDetails
        WHERE VEB_UserLastLoginDetails.UserLastLogin_UserID = @userLastLoginUserID;
    END
    ELSE
    BEGIN
        SELECT MAX(VEB_UserLastLoginDetails.UserLastLogin_Date)
        FROM VEB_UserLastLoginDetails;
    END
END
GO
</code></pre>

<p>I'm making some assumptions here.  The Table I used is:</p>

<pre><code>CREATE TABLE VEB_UserLastLoginDetails
(
    UserLastLogin_Date datetime
    , UserLastLogin_UserID INT
);
</code></pre>

<p>And I inserted several rows using:</p>

<pre><code>INSERT INTO VEB_UserLastLoginDetails VALUES (GETDATE(), 1);
    GO 3;
</code></pre>

<p>I then executed the stored procedure using:</p>

<pre><code>EXEC gspVEBUserLastLoginDetails_GetLastLogin 1;
</code></pre>

<p>which returns the maximum date which is the most recent login, naturally.</p>

<p>If you execte the stored procedure without passing a UserID, as in:</p>

<pre><code>EXEC gspVEBUserLastLoginDetails_GetLastLogin;
</code></pre>

<p>it returns the most recent login, regardless of which user actually logged in.</p>
