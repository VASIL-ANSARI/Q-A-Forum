<p><a href="http://en.wikipedia.org/wiki/Data_URI_scheme" rel="nofollow"><code>data:image</code></a> URLs actually contain the image inline as base 64. All you need to do is grab that data and <a href="http://www.ruby-doc.org/stdlib-2.1.1/libdoc/base64/rdoc/Base64.html#method-i-decode64" rel="nofollow">decode</a> it:</p>

<pre><code>require 'base64'

File.open(File.basename(uri),'wb'){ |f| f.write(Base64.decode64(url[/base64,(.*)/, 1])) }
</code></pre>
