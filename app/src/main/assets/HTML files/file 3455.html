<p>I think some of the other posts deal directly with the issue you are seeing, however, I do want to suggest that you look into using CURL (<a href="http://php.net/manual/en/book.curl.php" rel="nofollow">http://php.net/manual/en/book.curl.php</a>) for what you are trying to do instead of opening a socket connection manually.  Your payment provider might even have some code examples for that in PHP.  Typically this is a much better way of handling communication with gateways and has a lot more flexibility.</p>

<p>This will be especially handy if you integrate with multiple gateways since most have CURL code examples, and you will find other uses for it in the future.</p>

<p><strong>EDIT:</strong></p>

<p>Even better than the PHP manual--this site makes it much more clear how to use it including auth routines, passing post vars, etc with examples:</p>

<p><a href="http://devzone.zend.com/article/1081" rel="nofollow">http://devzone.zend.com/article/1081</a></p>
