<p>I realized how to do it, without using the HostType attribute. Hopefully the following code snippet can help out others as well:</p>

<pre><code>Type visualStudioType = Type.GetTypeFromProgID("VisualStudio.DTE.12.0", true);    
DTE env = Activator.CreateInstance(visualStudioType, true) as DTE;
</code></pre>

<p>This will get the type of the VS, with the specified version and will throw an exception on error. The DTE will be the interface of the EnvDTE, that one can use. </p>

<p>To get services, do the following, e.g. to get the UI Shell:</p>

<pre><code>ServiceProvider serviceProvider = new ServiceProvider(env as 
Microsoft.VisualStudio.OLE.Interop.IServiceProvider);
IVsUIShell uiShell = (IVsUIShell)serviceProvider.GetService(typeof(SVsUIShell));
</code></pre>

<p>One should keep track of the services, get the rcw handle and properly release the COM object afterwards the usage. </p>
