<p>The problem was with document.referrer picking up the wrong frame >_&lt;</p>

<p>Have had to, insteadm pass in a parameter through the top location and work this the other way round. Which in retrospect is much simpler >_&lt;</p>
