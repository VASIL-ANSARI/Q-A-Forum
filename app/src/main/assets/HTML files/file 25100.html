<p>I faced the problem and I implemented it using websocket/polling in the main application while a new window pops up for the payment. </p>

<p>After the payment is successful the main application will be notified. </p>

<p>That way each payment runs in it own sandbox totally unbound from the main application which makes maintenance quite easy. Note that our backend create a new session for each payment using the existing one.</p>

<p>I think it is not uncommon to open new windows for payment that's why I decided to go this.</p>
