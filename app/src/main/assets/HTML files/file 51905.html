<p>Try this is tested and works fine:</p>

<pre><code>       using System.IO;

        using (var sw = new StreamWriter(CSVpath))
        {
            sw.WriteLine(string.Join(",", sortedDT.Columns.Cast&lt;DataColumn&gt;().Select(column =&gt; column.ColumnName)));

            foreach (DataRow row in sortedDT.Rows)
            {
               sw.WriteLine(string.Join(",", row.ItemArray.Select(field =&gt; field.ToString())));

            }
        }
</code></pre>

<p>This code write <code>fields</code> line to file which name <code>CSVpath</code>. First columns name and then values</p>
