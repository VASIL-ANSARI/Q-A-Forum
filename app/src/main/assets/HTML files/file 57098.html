<p>This could be done with the help of ROW_NUMBER() and CTE:</p>

<pre><code>;WITH cte AS (
SELECT  [Profile Name], 
        T1,
        ROW_NUMBER() OVER (ORDER BY (SELECT 1)) as RN
FROM YourTable
)


SELECT  c1.[Profile Name],
        c1.T1,
        CASE WHEN c1.T1 &lt; 900 AND c1.[Profile Name] != c2.[Profile Name] THEN c1.T1 ELSE 0 END as T2,
        CASE WHEN c1.T1 &lt;= 900 AND c1.[Profile Name] = c2.[Profile Name] THEN c1.T1 ELSE 0 END as T3
FROM cte c1
LEFT JOIN cte c2
    ON c1.RN = c2.RN +1
</code></pre>

<p>Output:</p>

<pre><code>Profile Name    T1      T2  T3
IP Singles      0       0   0
IP Singles      90      0   90
IP Singles      100     0   100
Disputes        180     180 0
IP Multis       145     145 0
Performance     378     378 0
IP Color        420     420 0
Disputes        170     170 0
IP Multis       104     104 0
Insurance       340     340 0
Insurance       120     0   120
Insurance       1335    0   0
</code></pre>
