<p>After lots of fiddling, I think I have found the reason for this problem. The <code>AFUrlConnectionRequest</code> class implements the <code>connection:willSendRequestForAuthenticationChallenge:</code>delegate method when SSL pinning is enabled. The implementation simply returns if the authentication challenge is not related to SSL.</p>

<p>From the <a href="http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html" rel="nofollow">documentation of NSUrlConnectionDelegate</a>:</p>

<blockquote>
  <p>This method allows the delegate to make an informed decision about connection authentication at once. If the delegate implements this method, it has no need to implement </p>
  
  <ul>
  <li>connection:canAuthenticateAgainstProtectionSpace:,  </li>
  <li>connection:didReceiveAuthenticationChallenge:,  </li>
  <li>connectionShouldUseCredentialStorage:.  </li>
  </ul>
  
  <p>In fact, these other methods are not invoked.</p>
</blockquote>

<p>The methods will not be invoked, and thus RestKit never knows that the request resulted in HTTP error 401.</p>

<p>I solved the problem by removing this define, so the delegate method is not implemented:</p>

<pre><code>#define _AFNETWORKING_PIN_SSL_CERTIFICATES_
</code></pre>
