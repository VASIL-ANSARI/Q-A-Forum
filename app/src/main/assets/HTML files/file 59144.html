<p>Your problem is that you're not passing in the readonly flag, so Apache POI is defaulting to opening the file read/write.</p>

<p>You need to use the <a href="http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/WorkbookFactory.html#create(java.io.File,%20java.lang.String,%20boolean)" rel="nofollow">overloaded WorkbookFactory.create method which takes a readonly flag</a> + set that readonly flag to true</p>

<p>Change the line</p>

<pre><code>try (InputStream is = new FileInputStream(testFile); Workbook wb = WorkbookFactory.create(is)) {
</code></pre>

<p>to</p>

<pre><code>try (IWorkbook wb = WorkbookFactory.create(testFile,null,true)) {
</code></pre>

<p>and your file will be opened read-only with no changes</p>
