<p>It is hard to tell what part of this you are having trouble with. I'm supposing that you are having trouble getting your <code>displayAsTextGeometryVCF()</code> function to work. Here is a rewritten version. Please try it:</p>

<pre><code>function displayAsTextGeometryVCF(bcoResults) {
    var aResult = bcoResults[0];
    if (aResult.errorMessage != 'not an error') {
        handleError('queryError', [aResult.errorMessage]);
        return;
    }

    var fieldNames = aResult.fieldNames,
        records = aResult.data,
        container = document.getElementById('queryResults');
    container.innerHTML = '';

    var theField = 0;
    for (var i = 0, ii = fieldNames.length; i &lt; ii; i++) {
        if (fieldNames[i] == 'AsText(Geometry)') {
            theField = i;
            break;
        }
    }

    for (var i = 0, ii = records.length; i &lt; ii; i++) {
        var t = document.createElement('textarea');
        t.innerText = records[i][theField];
        container.appendChild(t);
    }

}
</code></pre>

<p>For this data:</p>

<pre><code>displayAsTextGeometryVCF([{
    errorMessage: 'not an error',
    fieldNames: ['dummy', 'AsText(Geometry)'],
    data: [
        ['one','yes'],
        ['no','yes']
    ]
}]);
</code></pre>

<p>The output is:</p>

<pre><code>&lt;div id="queryResults"&gt;&lt;textarea&gt;yes&lt;/textarea&gt;&lt;textarea&gt;yes&lt;/textarea&gt;&lt;/div&gt;
</code></pre>

<p>Is that what you wanted?</p>
