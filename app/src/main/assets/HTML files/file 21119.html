<p>I got it working finally ...
I changed the following line </p>

<pre><code> final Context ctx = new Context(locale);
</code></pre>

<p>with </p>

<pre><code>final WebContext ctx = new WebContext(request,request.getContext(),locale);
</code></pre>

<p>Now I am  able to send any template or attachment anything works great ..!!</p>
