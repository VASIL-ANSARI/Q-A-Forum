<p>It seems like you can't access <code>@access_list</code> in <code>method_added</code>. I would try</p>

<pre><code>class &lt;&lt; base
  attr_accessor :access_list 
  @access_list = {}
end
</code></pre>

<p>Might not solve your particular problem, but otherwise you won't be able to call <code>@access_list[method] = @roles</code> if your access_list attribute is read-only.</p>
