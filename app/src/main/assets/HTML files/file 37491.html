<p>This does not work for <code>dc=foo,dc=com</code> because that entry in the LDAP directory does not have the attribute <code>Email</code> and hence your filter does not match. The entry <code>'cn=x,ou=users,dc=foo,dc=com'</code> in LDAP directory probably has this attribute which is why it works.</p>
