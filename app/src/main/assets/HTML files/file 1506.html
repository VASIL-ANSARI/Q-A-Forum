<p>The PIVOT keyword might help, but even with that you still need to know what your columns are before running the query.  That usually means running two queries: one to get a list of columns names and then a second to actually get your results.</p>
