<p>Add this where clause to your temp table query.  Nearly all of these types of AB/BA problems can be solved by similar comparison.</p>

<pre><code>WHERE P2.ID IS NULL OR P1.ID &lt; P2.ID
</code></pre>
