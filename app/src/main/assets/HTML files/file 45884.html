<p>This is using T-SQL syntax, but the idea should get you started:</p>

<pre><code>Select ar.Stock_Ticker, 
       ar.Analyst_Name, 
       ar.Rating_Name,
       ar.Rating_Date 
From   Analyst_Ratings ar
    Inner Join (
        select  ar2.Stock_Ticker
            ,   ar2.Analyst_Name
            ,   Max(ar2.Rating_Date) as Last_Rating_Date
        from    Analyst_Ratings ar2
        where   ar2.Rating_Date &lt;= '2010-01-01')
        group by 
                ar2.STock_Ticker
            ,   ar2.Analyst_Name
   ) as Last_Ratings lr
   on ar.Stock_Ticker = lr.Stock_Ticker
   and ar.Analyst_Name = lr.Analyst_Name
   and ar.Rating_Date = lr.Last_Rating_Date
</code></pre>
