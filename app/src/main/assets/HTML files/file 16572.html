<p>If you can afford deplying a COM component with your Gadget the first approach would work. You wrap your logic in a facade of a CCW .NET class (using the .NET SP Client OM) and register it for COM by regasm. All pure .NET, your class would be declared (and written) COM-compatible.</p>

<p>You may find the second approach too limiting later; SP ClOM supports more functionality that SP WSs. Throwing the jQuery in doesn't change it much. (Unfortunately, SP JS ClOM can be used only on SP pages; not in a Gadget.)</p>

<p>If you go the way of pain (JS ;-) IWA should give you the (Windows) SSO authentication. If you call the SP ClOM from the DLL you can either reuse the Windows session token of the current user (SSO) or authenticate explicitly by a form of yours if the user wished it. (You can login to SP UI as a different user than you are in Windows too.) <a href="http://msdn.microsoft.com/en-us/library/ee535729.aspx" rel="nofollow">Both is supported</a>.</p>

<p>I'd first try the DLL approach.</p>

<p><strong>Update:</strong> Oops, you're on SP 2007, not on 2010 - no SP ClOM. I should've noticed earlier, sorry... Still, you could create a .NET DLL that would talk to SP via a WS. You can still set <a href="http://msdn.microsoft.com/en-us/library/system.net.credentialcache.defaultcredentials%28VS.80%29.aspx" rel="nofollow"><code>DefaultNetworkCredentials</code></a> to <a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.credentials.aspx" rel="nofollow"><code>HttpWebRequest.Credentials</code></a> (REST) or to <code>.Credentials</code> of your WS client class (SOAP) to get SSO authentication. Or create your own <a href="http://msdn.microsoft.com/en-us/library/71b57yke.aspx" rel="nofollow"><code>NetworkCredential</code></a> with name and password.</p>

<p>--- Ferda</p>
