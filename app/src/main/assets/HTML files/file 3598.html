<p>Well i dont know that this will sove your stated problems but there are a number of things that are going to help your code overall. For example my first impression was:</p>

<blockquote>
  <p>"Ok hes using jquery... wait i thought he was using jquery... WTF?".</p>
</blockquote>

<ol>
<li>Why use <code>getElementById</code>? use <code>$('#myid')</code>.</li>
<li>Why use <code>style.visibility</code>? use <code>$(selector).css('visibility', value);</code></li>
<li>Don use the element attributes to bind events... use jquery <code>$(selector).hover(openPopup, closePopup);</code></li>
</ol>

<p>Ok with that out of the way are you when the mouseleave fails to fire are you sure the mouse left the area? I mean are you sure the div's dimensions are a little larger than you think? If that isnt the case it could simple be the time it takes to execute the function or it could be that it isnt done animating (ie. <code>isDone = false</code>). In my opinion rather than trying to detect whether some thing is done animating i would jsut call <code>$(element).stop(true);</code> to stop the animation at its endpoint, and then continue on with your other animation. That should be pretty failsafe. Also i believe if you call it with <code>false</code> or omit the argument entirely it will stop it exactly where it is... allowing you to activate your out animation from the current place without having to calculate position.</p>

<p>Additionally i dont know what this actually looks like but it may be that you dont even need to use <code>animate</code> you may be able to use one of the built in effects like <code>slide</code> or something - you might wan tto look in to those as well.</p>
