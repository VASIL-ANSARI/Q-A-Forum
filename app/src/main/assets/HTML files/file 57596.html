<p>I tried your code with a simple test program:</p>

<pre><code>public static void main(String[] args) {
    System.out.println(eval("!5"));
}
</code></pre>

<p>And I got a StackOverflowError, because your code does not skip the <code>!</code></p>

<p>Changing</p>

<pre><code>    else if (ch == '!') { // functions
        int strLength = str.length();
        String func = str.substring(strLength - 1);
        x = parseFactor();
</code></pre>

<p>to </p>

<pre><code>    else if (ch == '!') { // functions
         while (ch == '!') nextChar();
         String func = str.substring(startPos, this.pos);
         x = parseFactor();
</code></pre>

<p>corrected the problem for me.</p>

<hr>

<p>If you do not want to loop over the exclamation mark, you will still need to skip it:</p>

<pre><code>    else if (ch == '!') { // functions
         eat('!');  // this is missing in your current implementation
         x = CombinatoricsUtils.factorial((int) parseFactor());
</code></pre>

<hr>

<p>Currently I have no explanation why the code for "fact" does not work - if I uncomment those lines they seem to work (at least for me).</p>
