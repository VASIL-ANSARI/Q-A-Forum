<p>You really don't want to do this using SQL.</p>

<p>Essentially what you're doing is calculating the <a href="https://en.wikipedia.org/wiki/Connected_component_(graph_theory)" rel="nofollow">connected components</a> of the graph defined by your database, where two rows have an edge connecting them if they are within the tolerance you've defined.</p>

<p>Assuming that your dataset is small enough to fit in memory, which is likely if it's results of sample tests conducted in your laboratory, then your best bet is to read it all in and then use a suitable library to calculate the connected components. For instance, in Java, you could use <a href="http://jgrapht.org/" rel="nofollow">JGraphT</a>; if you need to do it in PHP then I'm sure there will be graph libraries available for that too.</p>

<p>At the high end, with massive datasets, there are libraries to do it on a Spark cluster...</p>
