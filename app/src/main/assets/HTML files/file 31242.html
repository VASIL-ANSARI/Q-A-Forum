<p>Change:</p>

<pre><code>if(pid=fork() &lt; 0){   //fork a child process, if pid&lt;0, fork fails
</code></pre>

<p>to:</p>

<pre><code>if((pid=fork()) &lt; 0){   //fork a child process, if pid&lt;0, fork fails
</code></pre>

<p>You're setting <code>pid</code> to the result of <code>fork() &lt; 0</code>, not setting it to the PID of the child. So unless there's an error in <code>fork()</code>, this sets <code>pid</code> to <code>0</code> in both the parent and child, so they both think they're the child.</p>

<p>Regarding the return value of the <code>execute()</code> function: It will return in both the parent and child. In each process, it will return whatever was specified in the <code>return</code> statement in the corresponding branch of the <code>if</code> in <code>execute()</code>. Note that it <code>execve()</code> is successful, the child never returns, because it's no longer running this program, it's running the program that was exec'ed.</p>

<p>If the child wants to send success or failure information to the parent, it does this using its exit status, by calling <code>exit(0)</code> to indicate success, and <code>exit(some-nonzero-value)</code> to indicate failure. The parent can get the exit status using <code>waitpid</code>, and then return a success or failure indication from <code>execute()</code>.</p>
