<p>Adding below code will update quantity and everything works fine.</p>

<pre><code>//get total quantity
$totalqty = (int)Mage::getModel('cataloginventory/stock_item')
           -&gt;loadByProduct($productId)
           -&gt;getQty();
//calculate new quantity
$newqty = $totalqty-$product['qty'];

//update new quantity
Mage::getModel('cataloginventory/stock_item')
       -&gt;loadByProduct($productId)
       -&gt;setQty($newqty)
       -&gt;save();
</code></pre>
