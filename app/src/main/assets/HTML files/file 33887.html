<p>The Mac OS X ABI requires a 16-bytes stack alignment, before calling a function.</p>

<p>If your code is working, you're simply lucky, and this explains why you're getting e segmentation fault when modifying previous sections of the code.</p>

<p>So you need to ensure the stack is aligned on a 16-byte boundary.<br>
I already answered a similar question a few times ago:</p>

<p><a href="http://stackoverflow.com/questions/12678230/how-to-print-argv0-in-nasm">How to print argv[0] in NASM?</a></p>

<p>The interesting part is:</p>

<pre><code>; Align stack on a 16 bytes boundary
mov     ebp,                esp
and     esp,                0xFFFFFFF0
</code></pre>

<p>Be sure to read the full answer, though...</p>
