<p>You are chaining onto the query. That means you are running the .each loop on the mongo cursor.  What you want do is pass the query a callback.</p>

<pre><code>collection.find({},function(err,doc){
    //do stuff with doc and err
 })
</code></pre>
