<p>You're setting $p as the POST password (unhashed)</p>

<pre><code>$p = $_POST["p"];
</code></pre>

<p>Looks like it should then be:</p>

<pre><code> if($hash != $db_pass_str){         //and not $p != $dp_pass_str
  echo "login_failed";
</code></pre>

<p>i.e. compare the hashed password stored with the password entered and hashed (so to compare the two hashes)</p>
