<p>I didn't try using the remove-message cmdlet. Assume the command you provide could work as you expected. You should do following things,</p>

<p>1) Write a script to contain commands including connect to exchange, and remove message</p>

<pre><code>    if ((gcm Remove-Message -ErrorAction Ignore) -eq $null)
    {
      $session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri "http://$($env:COMPUTERNAME).$($env:USERDNSDOMAIN)/Powershell?serializationLevel=Full;ExchClientVer=14.2.247.5" -Authentication kerberos
      Import-Module (Import-PSSession $session) -global
    }
    Remove-Message -Server SERVERNAME -Filter {FromAddress -like '*MATCH*'} -WithNDR $false
</code></pre>

<p>Please make proper change to the <code>-ConnectionUri</code> as I just shows how to connect to local with fully qualified domain name.</p>

<p>2) invoking this script with following code, don't use <code>-NoExit</code>, unless you wan't to continue use that powershell console when the removing finished.</p>

<pre><code>powershell -command ". 'PS_FILE_PATH'"
</code></pre>

<p>3) if you need to pass parameters into the script, you could combine them into the  <code>-command ". 'script.ps1' arg1 arg2"</code>. and use them in the script with <code>$args[0]</code>, or declare param first with <code>param($match,$servername)</code> then use in the script.</p>

<p>I'm not so familiar with Python, so I can't provide more info about how to invoke with python.</p>
