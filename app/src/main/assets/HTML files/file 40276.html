<p>The code is defining two separate macros:</p>

<pre><code>#define ADDPOPUPMENU(hmenu, string) \
HMENU hSubMenu = CreatePopupMenu(); \
AppendMenu(hmenu, MF_STRING | MF_POPUP, (UINT)hSubMenu, string);
</code></pre>

<p></p>

<pre><code>// Add a menu item
#define ADDMENUITEM(hmenu, ID, string) \
AppendMenu(hSubMenu, MF_STRING, ID, string);
</code></pre>

<p>Preprocessor <code>#define</code> statements are simply defining text substitutions.  So code like this:</p>

<pre><code>ADDPOPUPMENU(MyMenu, "Name")
ADDMENUITEM(MyMenu, MyID, "Item")
</code></pre>

<p>Will be replaced with the following during the preprocessing stage before the compiling stage begins:</p>

<pre><code>HMENU hSubMenu = CreatePopupMenu();
AppendMenu(MyMenu, MF_STRING | MF_POPUP, (UINT)hSubMenu, "Name");
AppendMenu(hSubMenu, MF_STRING, MyID, "Item");
</code></pre>
