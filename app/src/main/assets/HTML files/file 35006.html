<p>I assume that Visits.TimeStamp is a date</p>

<pre><code>UPDATE Visits 
SET RepeatVisitor = 
(SELECT COUNT(*) FROM Visits as v2 WHERE v2.MAC = Visits.MAC and v2.TimeStamp!=Visits.TimeStamp AMD v2.TimeStamp&gt;'[40 days ago generated in PHP]') 
WHERE Visits.TimeStamp = '[Yesterday generated in PHP]'
</code></pre>
